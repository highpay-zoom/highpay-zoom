<!DOCTYPE html>
<!-- saved from url=(0044)https://my.oschina.net/huangyong/blog/361751 -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="Content-Language" content="zh-CN">
    <meta name="robots" content="index, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="黄勇,huangyong">
            <meta name="keywords" content="分布式,RPC,Netty,Protostuff,ZooKeeper">
                <meta name="description" itemprop="description" content="轻量级分布式 RPC 框架">
        <title>轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区</title>
    <link rel="shortcut icon" type="image/x-icon" href="https://my.oschina.net/img/favicon.ico?t=1451964198000">

                        <meta itemprop="name" content="轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区">
<meta itemprop="image" content="https://www.oschina.net/img/logo_s2.png">


            <link type="text/css" href="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/icon-svg.min.css" rel="stylesheet">
                    <link type="text/css" href="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/blog.min.css" rel="stylesheet">
            
            <script src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/push.js.下载"></script><script src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/share.js.下载"></script><script src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/share.js.下载"></script><link rel="stylesheet" href="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/share_style0_16.css"><link rel="stylesheet" type="text/css" href="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/zenburn.css"><link rel="stylesheet" type="text/css" href="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/zenburn.css"><link rel="stylesheet" type="text/css" href="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/jquery.atwho.css"><link rel="stylesheet" type="text/css" href="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/emoji.min.css"></head><body><val data-name="isMobileDevice" data-value="false"></val>
    
    <x-foo-define data-define="blog_detail"></x-foo-define>
    <val data-name="owner_id" data-value="223750"></val>
    <val data-name="owner_home_url" data-value="https://my.oschina.net/huangyong"></val>
    <val data-name="this_page" data-value="https%3A%2F%2Fmy.oschina.net%2Fhuangyong%2Fblog%2F361751"></val>

            <val data-name="g_user_login" data-value="false"></val>
        <val data-name="goto_this_page" data-value="https://www.oschina.net/home/login?goto_page=https%3A%2F%2Fmy.oschina.net%2Fhuangyong%2Fblog%2F361751"></val>
        <val data-name="is_owner" data-value="false"></val>
            <val data-name="blog_id" data-value="361751"></val>
                    

            <header class="header-navbar">
    <div class="layout-flex top-banner">
        <div class="flex-grow">
            <a href="https://www.oschina.net/" class="osc-logo"></a>
            <div class="menus sm-hide">
               <a class="menu-item" href="https://www.oschina.net/">首页</a>
               <div class="menu-item menu-drop">
                   <a href="https://www.oschina.net/project" class="project">
                       开源项目
                       <i class="icon-svg icon-arr-down-white"></i>
                   </a>
                   <div class="menu-drop-down">
                       <ul class="drop-list">
                           <li><a href="https://www.oschina.net/project/zh">国产开源项目</a></li>
                           <li><a href="https://www.oschina.net/project/tags">项目分类</a></li>
                           <li><a href="https://www.oschina.net/project/list?sort=time">最新收录项目</a></li>
                           <li class="split"></li>
                           <li><a href="https://www.oschina.net/project/lang/19/java">Java 开源软件</a></li>
                           <li><a href="https://www.oschina.net/project/lang/194/csharp">C# 开源软件</a></li>
                           <li><a href="https://www.oschina.net/project/lang/22/php">PHP 开源软件</a></li>
                           <li><a href="https://www.oschina.net/project/lang/21/c">C/C++ 开源软件</a></li>
                           <li><a href="https://www.oschina.net/project/lang/26/ruby">Ruby 开源软件</a></li>
                           <li><a href="https://www.oschina.net/project/lang/25/python">Python 开源软件</a></li>
                           <li><a href="https://www.oschina.net/project/lang/358/go">Go开源软件</a></li>
                           <li><a href="https://www.oschina.net/project/lang/28/javascript">JS开源软件</a></li>
                       </ul>
                   </div>
               </div>
               <div class="menu-item menu-drop">
                   <a href="https://www.oschina.net/question" class="question">
                       问答
                       <i class="icon-svg icon-arr-down-white"></i>
                   </a>
                   <div class="menu-drop-down">
                       <ul class="drop-list">
                           <li><a href="https://www.oschina.net/question?catalog=1"> 技术问答</a></li>
                           <li><a href="https://www.oschina.net/question?catalog=2"> 技术分享</a></li>
                           <li><a href="https://www.oschina.net/question?catalog=3"> IT大杂烩</a></li>
                           <li><a href="https://www.oschina.net/question?catalog=100"> 职业生涯</a></li>
                           <li><a href="https://www.oschina.net/question?catalog=4"> 站务/建议</a></li>
                           <li><a href="https://www.oschina.net/alipay"> 支付宝专区</a></li>
                           <li><a href="https://www.oschina.net/mopaas"> MoPaaS专区</a></li>
                           <li><a href="https://www.oschina.net/hardware"> 开源硬件专区</a></li>
                       </ul>
                   </div>
               </div>
               <a href="https://www.oschina.net/tweets" class="menu-item tweets">动弹</a>
               <a href="https://www.oschina.net/blog" class="menu-item blog">博客</a>
               <a href="https://www.oschina.net/translate" class="menu-item tran">翻译</a>
               <a href="https://www.oschina.net/news" class="menu-item news">资讯</a>
               <div class="menu-item menu-drop">
                   <a href="https://www.oschina.net/android" class="mobile">
                       专题
                       <i class="icon-svg icon-arr-down-white"></i>
                   </a>
                   <div class="menu-drop-down">
                       <ul class="drop-list drop-list-inline">
                           <li><a href="https://www.oschina.net/events" class="font-red">源创会</a> <a href="https://www.oschina.net/video">视频</a></li>
                           <li><a href="https://www.oschina.net/question/tag/%E9%AB%98%E6%89%8B%E9%97%AE%E7%AD%94">高手问答</a> <a href="https://www.oschina.net/question/tag/%E5%BC%80%E6%BA%90%E8%AE%BF%E8%B0%88">访谈</a></li>
                           <li><a href="https://www.oschina.net/question/tag/%E5%BC%80%E6%BA%90%E5%91%A8%E5%88%8A">周刊</a> <a href="https://my.oschina.net/xxiaobian/blog?catalog=547834">乱弹</a></li>
                           <li><a href="https://www.oschina.net/company">公司开源导航页</a></li>
                       </ul>
                       <div class="split"></div>
                       <ul class="drop-list mobile">
                           <li class="android"><a href="https://www.oschina.net/android">Android开发专区</a></li>
                           <li class="ios"><a href="https://www.oschina.net/ios/home">iOS开发专区</a></li>
                           <li class="ios"><a href="https://www.oschina.net/ios/codingList">iOS代码库</a></li>
                           <li class="wp7"><a href="https://www.oschina.net/wp">Windows Phone</a></li>
                       </ul>
                   </div>
               </div>
                               <div class="menu-item menu-drop">
                   <a id="MyCities" href="https://city.oschina.net/">
                       城市圈
                       <i class="icon-svg icon-arr-down-white"></i>
                   </a>
                   <div class="menu-drop-down">
                                               <ul class="drop-list city-all">
                           <li><a href="https://city.oschina.net/">全部城市圈</a></li>
                       </ul>
                   </div>
               </div>
           </div>

        </div>
        <div class="user-bar">
            <div class="user-info">
                                                    [ <a href="https://www.oschina.net/home/login?goto_page=https%3A%2F%2Fmy.oschina.net%2Fhuangyong%2Fblog%2F361751">登录</a> | <a href="https://www.oschina.net/home/reg">注册</a> ]
                            </div>
        </div>
    </div>
</header>    <div>
                        


<val data-name="is_login" data-value="false"></val>
<val data-name="hljs_js_url" data-value="/dist/www/vendor/highlight/9.5.0/highlight.js?t=1475077647000"></val>
<val data-name="hljs_css_url" data-value="/build/www/vendor/highlight/9.4.0/styles/zenburn.css?t=1474300001000"></val>

<val data-name="atwho_js_url" data-value="/dist/www/vendor/jquery.atwho/jquery.atwho.js?t=1475077647000"></val>
<val data-name="atwho_css_url" data-value="/dist/www/vendor/jquery.atwho/jquery.atwho.css?t=1471280768000"></val>
<val data-name="user_follow_url" data-value="/action/user/follow"></val>
<val data-name="user_unfollow_url" data-value="/action/user/unfollow"></val>

<!-- content     -->
<div class="blog blog-article">
    <div class="">
        <!-- 侧边栏-目录 -->
                                <div class="blog-wrapper">
                <div class="sidebar md-hide fixed" style="top: 241px; opacity: 1;">
                    <div class="catalogWrap" id="catalogWrap">
                        <span class="sidebar-scrollbar" style="top: 103px;"></span>
                        <ul class="anchor-content" id="catalogWrapMenu">
                                                    <li class="blog-catalogue-h1"><a href="https://my.oschina.net/huangyong/blog/361751#h1_0">第一步：编写服务接口</a></li><li class="blog-catalogue-h1"><a href="https://my.oschina.net/huangyong/blog/361751#h1_1">第二步：编写服务接口的实现类</a></li><li class="blog-catalogue-h1"><a href="https://my.oschina.net/huangyong/blog/361751#h1_2">第三步：配置服务端</a></li><li class="blog-catalogue-h1 active"><a href="https://my.oschina.net/huangyong/blog/361751#h1_3">第四步：启动服务器并发布服务</a></li><li class="blog-catalogue-h1"><a href="https://my.oschina.net/huangyong/blog/361751#h1_4">第五步：实现服务注册</a></li><li class="blog-catalogue-h1"><a href="https://my.oschina.net/huangyong/blog/361751#h1_5">第六步：实现 RPC 服务器</a></li><li class="blog-catalogue-h1"><a href="https://my.oschina.net/huangyong/blog/361751#h1_6">第七步：配置客户端</a></li><li class="blog-catalogue-h1"><a href="https://my.oschina.net/huangyong/blog/361751#h1_7">第八步：实现服务发现</a></li><li class="blog-catalogue-h1"><a href="https://my.oschina.net/huangyong/blog/361751#h1_8">第九步：实现 RPC 代理</a></li><li class="blog-catalogue-h1"><a href="https://my.oschina.net/huangyong/blog/361751#h1_9">第十步：发送 RPC 请求</a></li><li class="blog-catalogue-h1"><a href="https://my.oschina.net/huangyong/blog/361751#h1_10">总结</a></li><li class="blog-catalogue-h1"><a href="https://my.oschina.net/huangyong/blog/361751#h1_11">附录：Maven 依赖</a></li></ul>
                    </div>
                </div>
            </div>
                            <div class="blog-wrapper">
            <div class="back-list">
                <a href="https://www.oschina.net/blog" class="font-green">博客专区</a> &gt; <a href="https://my.oschina.net/huangyong/blog" class="font-green">黄勇的博客</a> &gt; 黄勇的博客详情
            </div>
        </div>

        <!-- 广告 -->
                <div class="blog-title-ad">
            <div class="blog-wrapper">
                
<!--<p style="margin:0 0 10px 0;"><a style="color:#A00;font-weight:bold;" href="http://www.oschina.net/events" target="_blank">盛夏7月，OSC源创会走进济南青岛~！ &gt;&gt;&gt;</a>&nbsp;&nbsp;<img src="http://my.oschina.net/img/hot3.png" align="absmiddle"></p>-->

<!--<a href="http://click.aliyun.com/m/6857/" target="_blank">
<img src="http://static.oschina.net/uploads/space/2016/1018/111014_CqGM_2702053.jpg" style="width:800px;"></a>-->

<div id="blog-title-ad" data-traceid="blog_ali" data-tracepid="blogup" style=""><a href="http://click.aliyun.com/m/7751/" target="_blank" style="max-width:780px;"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/TB1.M9zOpXXXXanXVXXXXXXXXXX-800-50.jpg"></a></div>
<script>
    function success_jsonpCallback(data) {
        var obj = eval(data);
        if( obj.success ){
            var contents = eval(obj.data[0].content);
            if(contents.length > 0){
                var content = contents[0];
                $('#blog-title-ad').prepend("<a  href='"+ content.url +"' target='_blank' style='max-width:780px;'><img src='"+content.img+"'/></a>");
                $('#blog-title-ad').show();
            }
            
        }else {
            $('#blog-title-ad').hide();
        }
    }
    window.addEventListener("load", function() {
         var url="https://promotion.aliyun.com/promotion/adv/getAliyunAdv.htm?cback=success_jsonpCallback&s=9cd174d9efd443e3982131f97b07e70f&p=page_1470989078421&pin=pos_1475239274174";
        $.ajax({
            type: 'POST',
            url: url,
            jsonp: "callback",
            dataType: 'jsonp',
            jsonpCallback: 'success_jsonpCallback',
            contentType: "application/json; charset=utf-8",
            success: function( response ) {
                // do in callback
            },
            error:function(){
                $('#blog-title-ad').hide();
            }
        });
    }, false);
</script>            </div>
        </div>
                <div class="float-heading">
            <div class="blog-wrapper">
                <div class="layout-flex">
                    <div class="flex-grow">
                        <div class="heading">轻量级分布式 RPC 框架</div>
                        <div class="data-info">
                            <a href="https://my.oschina.net/huangyong/home" class="link-blue" target="_blank">黄勇</a>
                            发表于2年前
                        </div>
                    </div>
                    <div class="">
                        <div class="opr-btn">
                            <div class="opr-btn-blog btn-reward-blog ">
                                <a href="javascript:void(0)" data-popupbox-model="reward">
                                    <i class="icon-svg icon-reward-blog"></i>
                                </a>
                            </div>
                            <!-- 点赞 -->
                            <div class="opr-btn-blog btn-like-blog ">
                                                                <a href="javascript:void(0);" class="" onclick="page.vote(361751);">
                                    <i class="icon-svg icon-thumbs-o-up-blog"></i>
                                </a>
                            </div>
                                                            <!-- 收藏 -->
                                <div class="opr-btn-blog btn-favor-blog  hover">
                                    <a href="javascript:void(0);" class=" " data-blogid="361751" data-blogtype="3" data-userid="" data-thispage="https://my.oschina.net/huangyong/blog/361751">
                                        <i class="icon-svg icon-star-blog"></i>
                                     
                                    </a>
                                                                    </div>

                                                        <!-- 分享 -->
                            <div class="opr-btn-blog btn-share-blog hover">
                                <a href="javascript:void(0);" class="">
                                    <i class="icon-svg icon-share-o-blog"></i>
                                </a>
                                <div class="operate-dropdown share-dropdown">
                                    <span class="share-title">分享到：</span>
                                    <div class="bdsharebuttonbox bdshare-button-style0-16" data-bd-bind="1479885438227">
                                        <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_mshare" data-cmd="mshare" title="分享到一键分享">一键分享</a>
                                        <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a>
                                        <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a>
                                        <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a>
                                        <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a>
                                        <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友">QQ好友</a>
                                        <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记">有道云笔记</a>
                                    </div>
                                    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","qzone","tsina","weixin","tqq","sqq"],"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/js/bdshare_api/share.js?t=1466497427000'];</script>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 文章内容 -->
        <div class="blog-content">
            <!-- 标题 -->
            <div class="blog-heading">
                <div class="title">
                    <span class="status-tag original" title="原创博客">原</span>                    <span class="status-tag recommend" title="首页推荐过的博客">荐</span>                                                            轻量级分布式 RPC 框架
                </div>
                <div class="info-opr layout">
                    <div class="layout-right">
                                                    
                                                                <!-- 收藏 -->
                                <div class="opr-btn-blog btn-favor-blog favor hover">
                                    <a href="javascript:void(0);" class="btn btn-black-blog " data-blogid="361751" data-blogtype="3" data-userid="" data-thispage="https://my.oschina.net/huangyong/blog/361751">
                                        <i class="icon-svg icon-star-blog"></i>
                                     <span id="" class="operate_title">
                                                                                    收藏
                                                                             </span>
                                    </a>
                                                                    </div>
                                                                        </div>
                    <div class="layout-column">
                        <div class="user-info">
                                                                                                                <div class="name">
                                <a href="https://my.oschina.net/huangyong/home" target="_blank">黄勇</a>
                            </div>
                        </div>
                        <div class="data-info text-gary">
                            <ul>
                                <li class="time">发表于 <span id="">2年前</span></li>
                                <li class="read">阅读 <span id="read">32216</span></li>
                                <li class="favor">收藏 <span id="">459</span></li>
                                <li class="vote">点赞 <span id="">99</span></li>
                                <li class="comment">
                                    <a href="https://my.oschina.net/huangyong/blog/361751#comment-list" data-href="#comment-list" class="link-blue">
                                        评论 <span id="comment">140</span>
                                    </a>
                                </li>
                                
                            </ul>
                        </div>
                    </div>
                        
                </div>
            </div>
            <!-- 摘要 -->
                        <!-- 正文 -->
            <div class="blog-body" id="blogBody">
                                    <val data-name="blog_content_type" data-value="markdown"></val>
                                        <div class="loading-gif" id="blogContentLoading" style="display: none;"></div>
                    <textarea style="display: none;" class="noshow_content">RPC，即 Remote Procedure Call（远程过程调用），说得通俗一点就是：调用远程计算机上的服务，就像调用本地服务一样。

RPC 可基于 HTTP 或 TCP 协议，Web Service 就是基于 HTTP 协议的 RPC，它具有良好的跨平台性，但其性能却不如基于 TCP 协议的 RPC。会两方面会直接影响 RPC 的性能，一是传输方式，二是序列化。

众所周知，TCP 是传输层协议，HTTP 是应用层协议，而传输层较应用层更加底层，在数据传输方面，越底层越快，因此，在一般情况下，TCP 一定比 HTTP 快。就序列化而言，Java 提供了默认的序列化方式，但在高并发的情况下，这种方式将会带来一些性能上的瓶颈，于是市面上出现了一系列优秀的序列化框架，比如：Protobuf、Kryo、Hessian、Jackson 等，它们可以取代 Java 默认的序列化，从而提供更高效的性能。

为了支持高并发，传统的阻塞式 IO 显然不太合适，因此我们需要异步的 IO，即 NIO。Java 提供了 NIO 的解决方案，Java 7 也提供了更优秀的 NIO.2 支持，用 Java 实现 NIO 并不是遥不可及的事情，只是需要我们熟悉 NIO 的技术细节。

我们需要将服务部署在分布式环境下的不同节点上，通过服务注册的方式，让客户端来自动发现当前可用的服务，并调用这些服务。这需要一种服务注册表（Service Registry）的组件，让它来注册分布式环境下所有的服务地址（包括：主机名与端口号）。

应用、服务、服务注册表之间的关系见下图：

![系统架构][1]

每台 Server 上可发布多个 Service，这些 Service 共用一个 host 与 port，在分布式环境下会提供 Server 共同对外提供 Service。此外，为防止 Service Registry 出现单点故障，因此需要将其搭建为集群环境。

本文将为您揭晓开发轻量级分布式 RPC 框架的具体过程，该框架基于 TCP 协议，提供了 NIO 特性，提供高效的序列化方式，同时也具备服务注册与发现的能力。

根据以上技术需求，我们可使用如下技术选型：

1. Spring：它是最强大的依赖注入框架，也是业界的权威标准。
2. Netty：它使 NIO 编程更加容易，屏蔽了 Java 底层的 NIO 细节。
3. Protostuff：它基于 Protobuf 序列化框架，面向 POJO，无需编写 .proto 文件。
4. ZooKeeper：提供服务注册与发现功能，开发分布式系统的必备选择，同时它也具备天生的集群能力。

相关 Maven 依赖请见附录。

# 第一步：编写服务接口

    &lt;!-- lang: java --&gt;
    public interface HelloService {
    
        String hello(String name);
    }

将该接口放在独立的客户端 jar 包中，以供应用使用。

# 第二步：编写服务接口的实现类

    &lt;!-- lang: java --&gt;
    @RpcService(HelloService.class) // 指定远程接口
    public class HelloServiceImpl implements HelloService {
    
        @Override
        public String hello(String name) {
            return "Hello! " + name;
        }
    }

使用`RpcService`注解定义在服务接口的实现类上，需要对该实现类指定远程接口，因为实现类可能会实现多个接口，一定要告诉框架哪个才是远程接口。

`RpcService`代码如下：

    &lt;!-- lang: java --&gt;
    @Target({ElementType.TYPE})
    @Retention(RetentionPolicy.RUNTIME)
    @Component // 表明可被 Spring 扫描
    public @interface RpcService {
    
        Class&lt;?&gt; value();
    }

该注解具备 Spring 的`Component`注解的特性，可被 Spring 扫描。

该实现类放在服务端 jar 包中，该 jar 包还提供了一些服务端的配置文件与启动服务的引导程序。

# 第三步：配置服务端

服务端 Spring 配置文件名为`spring.xml`，内容如下：
 
    &lt;!-- lang: xml --&gt;
    &lt;beans ...&gt;
        &lt;context:component-scan base-package="com.xxx.rpc.sample.server"/&gt;
    
        &lt;context:property-placeholder location="classpath:config.properties"/&gt;
    
        &lt;!-- 配置服务注册组件 --&gt;
        &lt;bean id="serviceRegistry" class="com.xxx.rpc.registry.ServiceRegistry"&gt;
            &lt;constructor-arg name="registryAddress" value="${registry.address}"/&gt;
        &lt;/bean&gt;
    
        &lt;!-- 配置 RPC 服务器 --&gt;
        &lt;bean id="rpcServer" class="com.xxx.rpc.server.RpcServer"&gt;
            &lt;constructor-arg name="serverAddress" value="${server.address}"/&gt;
            &lt;constructor-arg name="serviceRegistry" ref="serviceRegistry"/&gt;
        &lt;/bean&gt;
    &lt;/beans&gt;

具体的配置参数在`config.properties`文件中，内容如下：

    &lt;!-- lang: java --&gt;
    # ZooKeeper 服务器
    registry.address=127.0.0.1:2181
    
    # RPC 服务器
    server.address=127.0.0.1:8000

以上配置表明：连接本地的 ZooKeeper 服务器，并在 8000 端口上发布 RPC 服务。

# 第四步：启动服务器并发布服务

为了加载 Spring 配置文件来发布服务，只需编写一个引导程序即可：

    &lt;!-- lang: java --&gt;
    public class RpcBootstrap {
    
        public static void main(String[] args) {
            new ClassPathXmlApplicationContext("spring.xml");
        }
    }

运行`RpcBootstrap`类的`main`方法即可启动服务端，但还有两个重要的组件尚未实现，它们分别是：`ServiceRegistry`与`RpcServer`，下文会给出具体实现细节。

# 第五步：实现服务注册

使用 ZooKeeper 客户端可轻松实现服务注册功能，`ServiceRegistry`代码如下：

    &lt;!-- lang: java --&gt;
    public class ServiceRegistry {
    
        private static final Logger LOGGER = LoggerFactory.getLogger(ServiceRegistry.class);
    
        private CountDownLatch latch = new CountDownLatch(1);
    
        private String registryAddress;
    
        public ServiceRegistry(String registryAddress) {
            this.registryAddress = registryAddress;
        }
    
        public void register(String data) {
            if (data != null) {
                ZooKeeper zk = connectServer();
                if (zk != null) {
                    createNode(zk, data);
                }
            }
        }
    
        private ZooKeeper connectServer() {
            ZooKeeper zk = null;
            try {
                zk = new ZooKeeper(registryAddress, Constant.ZK_SESSION_TIMEOUT, new Watcher() {
                    @Override
                    public void process(WatchedEvent event) {
                        if (event.getState() == Event.KeeperState.SyncConnected) {
                            latch.countDown();
                        }
                    }
                });
                latch.await();
            } catch (IOException | InterruptedException e) {
                LOGGER.error("", e);
            }
            return zk;
        }
    
        private void createNode(ZooKeeper zk, String data) {
            try {
                byte[] bytes = data.getBytes();
                String path = zk.create(Constant.ZK_DATA_PATH, bytes, ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL_SEQUENTIAL);
                LOGGER.debug("create zookeeper node ({} =&gt; {})", path, data);
            } catch (KeeperException | InterruptedException e) {
                LOGGER.error("", e);
            }
        }
    }

其中，通过`Constant`配置了所有的常量：

    &lt;!-- lang: java --&gt;
    public interface Constant {
    
        int ZK_SESSION_TIMEOUT = 5000;
    
        String ZK_REGISTRY_PATH = "/registry";
        String ZK_DATA_PATH = ZK_REGISTRY_PATH + "/data";
    }

注意：首先需要使用 ZooKeeper 客户端命令行创建`/registry`永久节点，用于存放所有的服务临时节点。

# 第六步：实现 RPC 服务器

使用 Netty 可实现一个支持 NIO 的 RPC 服务器，需要使用`ServiceRegistry`注册服务地址，`RpcServer`代码如下：

    &lt;!-- lang: java --&gt;
    public class RpcServer implements ApplicationContextAware, InitializingBean {
    
        private static final Logger LOGGER = LoggerFactory.getLogger(RpcServer.class);
    
        private String serverAddress;
        private ServiceRegistry serviceRegistry;
    
        private Map&lt;String, Object&gt; handlerMap = new HashMap&lt;&gt;(); // 存放接口名与服务对象之间的映射关系
    
        public RpcServer(String serverAddress) {
            this.serverAddress = serverAddress;
        }
    
        public RpcServer(String serverAddress, ServiceRegistry serviceRegistry) {
            this.serverAddress = serverAddress;
            this.serviceRegistry = serviceRegistry;
        }
    
        @Override
        public void setApplicationContext(ApplicationContext ctx) throws BeansException {
            Map&lt;String, Object&gt; serviceBeanMap = ctx.getBeansWithAnnotation(RpcService.class); // 获取所有带有 RpcService 注解的 Spring Bean
            if (MapUtils.isNotEmpty(serviceBeanMap)) {
                for (Object serviceBean : serviceBeanMap.values()) {
                    String interfaceName = serviceBean.getClass().getAnnotation(RpcService.class).value().getName();
                    handlerMap.put(interfaceName, serviceBean);
                }
            }
        }
    
        @Override
        public void afterPropertiesSet() throws Exception {
            EventLoopGroup bossGroup = new NioEventLoopGroup();
            EventLoopGroup workerGroup = new NioEventLoopGroup();
            try {
                ServerBootstrap bootstrap = new ServerBootstrap();
                bootstrap.group(bossGroup, workerGroup).channel(NioServerSocketChannel.class)
                    .childHandler(new ChannelInitializer&lt;SocketChannel&gt;() {
                        @Override
                        public void initChannel(SocketChannel channel) throws Exception {
                            channel.pipeline()
                                .addLast(new RpcDecoder(RpcRequest.class)) // 将 RPC 请求进行解码（为了处理请求）
                                .addLast(new RpcEncoder(RpcResponse.class)) // 将 RPC 响应进行编码（为了返回响应）
                                .addLast(new RpcHandler(handlerMap)); // 处理 RPC 请求
                        }
                    })
                    .option(ChannelOption.SO_BACKLOG, 128)
                    .childOption(ChannelOption.SO_KEEPALIVE, true);
    
                String[] array = serverAddress.split(":");
                String host = array[0];
                int port = Integer.parseInt(array[1]);
    
                ChannelFuture future = bootstrap.bind(host, port).sync();
                LOGGER.debug("server started on port {}", port);
    
                if (serviceRegistry != null) {
                    serviceRegistry.register(serverAddress); // 注册服务地址
                }
    
                future.channel().closeFuture().sync();
            } finally {
                workerGroup.shutdownGracefully();
                bossGroup.shutdownGracefully();
            }
        }
    }

以上代码中，有两个重要的 POJO 需要描述一下，它们分别是`RpcRequest`与`RpcResponse`。

使用`RpcRequest`封装 RPC 请求，代码如下：

    &lt;!-- lang: java --&gt;
    public class RpcRequest {
    
        private String requestId;
        private String className;
        private String methodName;
        private Class&lt;?&gt;[] parameterTypes;
        private Object[] parameters;
    
        // getter/setter...
    }

使用`RpcResponse`封装 RPC 响应，代码如下：

    &lt;!-- lang: java --&gt;
    public class RpcResponse {
    
        private String requestId;
        private Throwable error;
        private Object result;
    
        // getter/setter...
    }

使用`RpcDecoder`提供 RPC 解码，只需扩展 Netty 的`ByteToMessageDecoder`抽象类的`decode`方法即可，代码如下：

    &lt;!-- lang: java --&gt;
    public class RpcDecoder extends ByteToMessageDecoder {
    
        private Class&lt;?&gt; genericClass;
    
        public RpcDecoder(Class&lt;?&gt; genericClass) {
            this.genericClass = genericClass;
        }
    
        @Override
        public void decode(ChannelHandlerContext ctx, ByteBuf in, List&lt;Object&gt; out) throws Exception {
            if (in.readableBytes() &lt; 4) {
                return;
            }
            in.markReaderIndex();
            int dataLength = in.readInt();
            if (dataLength &lt; 0) {
                ctx.close();
            }
            if (in.readableBytes() &lt; dataLength) {
                in.resetReaderIndex();
                return;
            }
            byte[] data = new byte[dataLength];
            in.readBytes(data);
    
            Object obj = SerializationUtil.deserialize(data, genericClass);
            out.add(obj);
        }
    }

使用`RpcEncoder`提供 RPC 编码，只需扩展 Netty 的`MessageToByteEncoder`抽象类的`encode`方法即可，代码如下：

    &lt;!-- lang: java --&gt;
    public class RpcEncoder extends MessageToByteEncoder {
    
        private Class&lt;?&gt; genericClass;
    
        public RpcEncoder(Class&lt;?&gt; genericClass) {
            this.genericClass = genericClass;
        }
    
        @Override
        public void encode(ChannelHandlerContext ctx, Object in, ByteBuf out) throws Exception {
            if (genericClass.isInstance(in)) {
                byte[] data = SerializationUtil.serialize(in);
                out.writeInt(data.length);
                out.writeBytes(data);
            }
        }
    }

编写一个`SerializationUtil`工具类，使用`Protostuff`实现序列化：

    &lt;!-- lang: java --&gt;
    public class SerializationUtil {
    
        private static Map&lt;Class&lt;?&gt;, Schema&lt;?&gt;&gt; cachedSchema = new ConcurrentHashMap&lt;&gt;();
    
        private static Objenesis objenesis = new ObjenesisStd(true);
    
        private SerializationUtil() {
        }
    
        @SuppressWarnings("unchecked")
        private static &lt;T&gt; Schema&lt;T&gt; getSchema(Class&lt;T&gt; cls) {
            Schema&lt;T&gt; schema = (Schema&lt;T&gt;) cachedSchema.get(cls);
            if (schema == null) {
                schema = RuntimeSchema.createFrom(cls);
                if (schema != null) {
                    cachedSchema.put(cls, schema);
                }
            }
            return schema;
        }
    
        @SuppressWarnings("unchecked")
        public static &lt;T&gt; byte[] serialize(T obj) {
            Class&lt;T&gt; cls = (Class&lt;T&gt;) obj.getClass();
            LinkedBuffer buffer = LinkedBuffer.allocate(LinkedBuffer.DEFAULT_BUFFER_SIZE);
            try {
                Schema&lt;T&gt; schema = getSchema(cls);
                return ProtostuffIOUtil.toByteArray(obj, schema, buffer);
            } catch (Exception e) {
                throw new IllegalStateException(e.getMessage(), e);
            } finally {
                buffer.clear();
            }
        }
    
        public static &lt;T&gt; T deserialize(byte[] data, Class&lt;T&gt; cls) {
            try {
                T message = (T) objenesis.newInstance(cls);
                Schema&lt;T&gt; schema = getSchema(cls);
                ProtostuffIOUtil.mergeFrom(data, message, schema);
                return message;
            } catch (Exception e) {
                throw new IllegalStateException(e.getMessage(), e);
            }
        }
    }

以上了使用 Objenesis 来实例化对象，它是比 Java 反射更加强大。

注意：如需要替换其它序列化框架，只需修改`SerializationUtil`即可。当然，更好的实现方式是提供配置项来决定使用哪种序列化方式。

使用`RpcHandler`中处理 RPC 请求，只需扩展 Netty 的`SimpleChannelInboundHandler`抽象类即可，代码如下：

    &lt;!-- lang: java --&gt;
    public class RpcHandler extends SimpleChannelInboundHandler&lt;RpcRequest&gt; {
    
        private static final Logger LOGGER = LoggerFactory.getLogger(RpcHandler.class);
    
        private final Map&lt;String, Object&gt; handlerMap;
    
        public RpcHandler(Map&lt;String, Object&gt; handlerMap) {
            this.handlerMap = handlerMap;
        }
    
        @Override
        public void channelRead0(final ChannelHandlerContext ctx, RpcRequest request) throws Exception {
            RpcResponse response = new RpcResponse();
            response.setRequestId(request.getRequestId());
            try {
                Object result = handle(request);
                response.setResult(result);
            } catch (Throwable t) {
                response.setError(t);
            }
            ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);
        }
    
        private Object handle(RpcRequest request) throws Throwable {
            String className = request.getClassName();
            Object serviceBean = handlerMap.get(className);
    
            Class&lt;?&gt; serviceClass = serviceBean.getClass();
            String methodName = request.getMethodName();
            Class&lt;?&gt;[] parameterTypes = request.getParameterTypes();
            Object[] parameters = request.getParameters();
    
            /*Method method = serviceClass.getMethod(methodName, parameterTypes);
            method.setAccessible(true);
            return method.invoke(serviceBean, parameters);*/
    
            FastClass serviceFastClass = FastClass.create(serviceClass);
            FastMethod serviceFastMethod = serviceFastClass.getMethod(methodName, parameterTypes);
            return serviceFastMethod.invoke(serviceBean, parameters);
        }
    
        @Override
        public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {
            LOGGER.error("server caught exception", cause);
            ctx.close();
        }
    }

为了避免使用 Java 反射带来的性能问题，我们可以使用 CGLib 提供的反射 API，如上面用到的`FastClass`与`FastMethod`。

# 第七步：配置客户端

同样使用 Spring 配置文件来配置 RPC 客户端，`spring.xml`代码如下：

    &lt;!-- lang: java --&gt;
    &lt;beans ...&gt;
        &lt;context:property-placeholder location="classpath:config.properties"/&gt;
    
        &lt;!-- 配置服务发现组件 --&gt;
        &lt;bean id="serviceDiscovery" class="com.xxx.rpc.registry.ServiceDiscovery"&gt;
            &lt;constructor-arg name="registryAddress" value="${registry.address}"/&gt;
        &lt;/bean&gt;
    
        &lt;!-- 配置 RPC 代理 --&gt;
        &lt;bean id="rpcProxy" class="com.xxx.rpc.client.RpcProxy"&gt;
            &lt;constructor-arg name="serviceDiscovery" ref="serviceDiscovery"/&gt;
        &lt;/bean&gt;
    &lt;/beans&gt;

其中`config.properties`提供了具体的配置：

    &lt;!-- lang: java --&gt;
    # ZooKeeper 服务器
    registry.address=127.0.0.1:2181

# 第八步：实现服务发现

同样使用 ZooKeeper 实现服务发现功能，见如下代码：

    &lt;!-- lang: java --&gt;
    public class ServiceDiscovery {
    
        private static final Logger LOGGER = LoggerFactory.getLogger(ServiceDiscovery.class);
    
        private CountDownLatch latch = new CountDownLatch(1);
    
        private volatile List&lt;String&gt; dataList = new ArrayList&lt;&gt;();
    
        private String registryAddress;
    
        public ServiceDiscovery(String registryAddress) {
            this.registryAddress = registryAddress;
    
            ZooKeeper zk = connectServer();
            if (zk != null) {
                watchNode(zk);
            }
        }
    
        public String discover() {
            String data = null;
            int size = dataList.size();
            if (size &gt; 0) {
                if (size == 1) {
                    data = dataList.get(0);
                    LOGGER.debug("using only data: {}", data);
                } else {
                    data = dataList.get(ThreadLocalRandom.current().nextInt(size));
                    LOGGER.debug("using random data: {}", data);
                }
            }
            return data;
        }
    
        private ZooKeeper connectServer() {
            ZooKeeper zk = null;
            try {
                zk = new ZooKeeper(registryAddress, Constant.ZK_SESSION_TIMEOUT, new Watcher() {
                    @Override
                    public void process(WatchedEvent event) {
                        if (event.getState() == Event.KeeperState.SyncConnected) {
                            latch.countDown();
                        }
                    }
                });
                latch.await();
            } catch (IOException | InterruptedException e) {
                LOGGER.error("", e);
            }
            return zk;
        }
    
        private void watchNode(final ZooKeeper zk) {
            try {
                List&lt;String&gt; nodeList = zk.getChildren(Constant.ZK_REGISTRY_PATH, new Watcher() {
                    @Override
                    public void process(WatchedEvent event) {
                        if (event.getType() == Event.EventType.NodeChildrenChanged) {
                            watchNode(zk);
                        }
                    }
                });
                List&lt;String&gt; dataList = new ArrayList&lt;&gt;();
                for (String node : nodeList) {
                    byte[] bytes = zk.getData(Constant.ZK_REGISTRY_PATH + "/" + node, false, null);
                    dataList.add(new String(bytes));
                }
                LOGGER.debug("node data: {}", dataList);
                this.dataList = dataList;
            } catch (KeeperException | InterruptedException e) {
                LOGGER.error("", e);
            }
        }
    }

# 第九步：实现 RPC 代理

这里使用 Java 提供的动态代理技术实现 RPC 代理（当然也可以使用 CGLib 来实现），具体代码如下：

    &lt;!-- lang: java --&gt;
    public class RpcProxy {
    
        private String serverAddress;
        private ServiceDiscovery serviceDiscovery;
    
        public RpcProxy(String serverAddress) {
            this.serverAddress = serverAddress;
        }
    
        public RpcProxy(ServiceDiscovery serviceDiscovery) {
            this.serviceDiscovery = serviceDiscovery;
        }
    
        @SuppressWarnings("unchecked")
        public &lt;T&gt; T create(Class&lt;?&gt; interfaceClass) {
            return (T) Proxy.newProxyInstance(
                interfaceClass.getClassLoader(),
                new Class&lt;?&gt;[]{interfaceClass},
                new InvocationHandler() {
                    @Override
                    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                        RpcRequest request = new RpcRequest(); // 创建并初始化 RPC 请求
                        request.setRequestId(UUID.randomUUID().toString());
                        request.setClassName(method.getDeclaringClass().getName());
                        request.setMethodName(method.getName());
                        request.setParameterTypes(method.getParameterTypes());
                        request.setParameters(args);
    
                        if (serviceDiscovery != null) {
                            serverAddress = serviceDiscovery.discover(); // 发现服务
                        }
    
                        String[] array = serverAddress.split(":");
                        String host = array[0];
                        int port = Integer.parseInt(array[1]);
    
                        RpcClient client = new RpcClient(host, port); // 初始化 RPC 客户端
                        RpcResponse response = client.send(request); // 通过 RPC 客户端发送 RPC 请求并获取 RPC 响应
    
                        if (response.isError()) {
                            throw response.getError();
                        } else {
                            return response.getResult();
                        }
                    }
                }
            );
        }
    }

使用`RpcClient`类实现 RPC 客户端，只需扩展 Netty 提供的`SimpleChannelInboundHandler`抽象类即可，代码如下：

    &lt;!-- lang: java --&gt;
    public class RpcClient extends SimpleChannelInboundHandler&lt;RpcResponse&gt; {
    
        private static final Logger LOGGER = LoggerFactory.getLogger(RpcClient.class);
    
        private String host;
        private int port;
    
        private RpcResponse response;
    
        private final Object obj = new Object();
    
        public RpcClient(String host, int port) {
            this.host = host;
            this.port = port;
        }
    
        @Override
        public void channelRead0(ChannelHandlerContext ctx, RpcResponse response) throws Exception {
            this.response = response;
    
            synchronized (obj) {
                obj.notifyAll(); // 收到响应，唤醒线程
            }
        }
    
        @Override
        public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {
            LOGGER.error("client caught exception", cause);
            ctx.close();
        }
    
        public RpcResponse send(RpcRequest request) throws Exception {
            EventLoopGroup group = new NioEventLoopGroup();
            try {
                Bootstrap bootstrap = new Bootstrap();
                bootstrap.group(group).channel(NioSocketChannel.class)
                    .handler(new ChannelInitializer&lt;SocketChannel&gt;() {
                        @Override
                        public void initChannel(SocketChannel channel) throws Exception {
                            channel.pipeline()
                                .addLast(new RpcEncoder(RpcRequest.class)) // 将 RPC 请求进行编码（为了发送请求）
                                .addLast(new RpcDecoder(RpcResponse.class)) // 将 RPC 响应进行解码（为了处理响应）
                                .addLast(RpcClient.this); // 使用 RpcClient 发送 RPC 请求
                        }
                    })
                    .option(ChannelOption.SO_KEEPALIVE, true);
    
                ChannelFuture future = bootstrap.connect(host, port).sync();
                future.channel().writeAndFlush(request).sync();
    
                synchronized (obj) {
                    obj.wait(); // 未收到响应，使线程等待
                }
    
                if (response != null) {
                    future.channel().closeFuture().sync();
                }
                return response;
            } finally {
                group.shutdownGracefully();
            }
        }
    }

# 第十步：发送 RPC 请求

使用 JUnit 结合 Spring 编写一个单元测试，代码如下：

    &lt;!-- lang: java --&gt;
    @RunWith(SpringJUnit4ClassRunner.class)
    @ContextConfiguration(locations = "classpath:spring.xml")
    public class HelloServiceTest {
    
        @Autowired
        private RpcProxy rpcProxy;
    
        @Test
        public void helloTest() {
            HelloService helloService = rpcProxy.create(HelloService.class);
            String result = helloService.hello("World");
            Assert.assertEquals("Hello! World", result);
        }
    }

运行以上单元测试，如果不出意外的话，您应该会看到绿条。

# 总结

本文通过 Spring + Netty + Protostuff + ZooKeeper 实现了一个轻量级 RPC 框架，使用 Spring 提供依赖注入与参数配置，使用 Netty 实现 NIO 方式的数据传输，使用 Protostuff 实现对象序列化，使用 ZooKeeper 实现服务注册与发现。使用该框架，可将服务部署到分布式环境中的任意节点上，客户端通过远程接口来调用服务端的具体实现，让服务端与客户端的开发完全分离，为实现大规模分布式应用提供了基础支持。

# 附录：Maven 依赖

    &lt;!-- lang: xml --&gt;
    &lt;!-- JUnit --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;junit&lt;/groupId&gt;
        &lt;artifactId&gt;junit&lt;/artifactId&gt;
        &lt;version&gt;4.11&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;

    &lt;!-- SLF4J --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
        &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
        &lt;version&gt;1.7.7&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;!-- Spring --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
        &lt;version&gt;3.2.12.RELEASE&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
        &lt;version&gt;3.2.12.RELEASE&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;

    &lt;!-- Netty --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.netty&lt;/groupId&gt;
        &lt;artifactId&gt;netty-all&lt;/artifactId&gt;
        &lt;version&gt;4.0.24.Final&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;!-- Protostuff --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.dyuproject.protostuff&lt;/groupId&gt;
        &lt;artifactId&gt;protostuff-core&lt;/artifactId&gt;
        &lt;version&gt;1.0.8&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.dyuproject.protostuff&lt;/groupId&gt;
        &lt;artifactId&gt;protostuff-runtime&lt;/artifactId&gt;
        &lt;version&gt;1.0.8&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;!-- ZooKeeper --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt;
        &lt;artifactId&gt;zookeeper&lt;/artifactId&gt;
        &lt;version&gt;3.4.6&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;!-- Apache Commons Collections --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
        &lt;artifactId&gt;commons-collections4&lt;/artifactId&gt;
        &lt;version&gt;4.0&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;!-- Objenesis --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.objenesis&lt;/groupId&gt;
        &lt;artifactId&gt;objenesis&lt;/artifactId&gt;
        &lt;version&gt;2.1&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;!-- CGLib --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;cglib&lt;/groupId&gt;
        &lt;artifactId&gt;cglib&lt;/artifactId&gt;
        &lt;version&gt;3.1&lt;/version&gt;
    &lt;/dependency&gt;

&gt; 源码地址：http://git.oschina.net/huangyong/rpc


  [1]: http://static.oschina.net/uploads/space/2014/1229/002234_ENsM_223750.png</textarea>
                    <div class="BlogContent"><p>RPC，即 Remote Procedure Call（远程过程调用），说得通俗一点就是：调用远程计算机上的服务，就像调用本地服务一样。</p>
<p>RPC 可基于 HTTP 或 TCP 协议，Web Service 就是基于 HTTP 协议的 RPC，它具有良好的跨平台性，但其性能却不如基于 TCP 协议的 RPC。会两方面会直接影响 RPC 的性能，一是传输方式，二是序列化。</p>
<p>众所周知，TCP 是传输层协议，HTTP 是应用层协议，而传输层较应用层更加底层，在数据传输方面，越底层越快，因此，在一般情况下，TCP 一定比 HTTP 快。就序列化而言，Java 提供了默认的序列化方式，但在高并发的情况下，这种方式将会带来一些性能上的瓶颈，于是市面上出现了一系列优秀的序列化框架，比如：Protobuf、Kryo、Hessian、Jackson 等，它们可以取代 Java 默认的序列化，从而提供更高效的性能。</p>
<p>为了支持高并发，传统的阻塞式 IO 显然不太合适，因此我们需要异步的 IO，即 NIO。Java 提供了 NIO 的解决方案，Java 7 也提供了更优秀的 NIO.2 支持，用 Java 实现 NIO 并不是遥不可及的事情，只是需要我们熟悉 NIO 的技术细节。</p>
<p>我们需要将服务部署在分布式环境下的不同节点上，通过服务注册的方式，让客户端来自动发现当前可用的服务，并调用这些服务。这需要一种服务注册表（Service Registry）的组件，让它来注册分布式环境下所有的服务地址（包括：主机名与端口号）。</p>
<p>应用、服务、服务注册表之间的关系见下图：</p>
<p><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/002234_ENsM_223750.png" alt="系统架构"></p>
<p>每台 Server 上可发布多个 Service，这些 Service 共用一个 host 与 port，在分布式环境下会提供 Server 共同对外提供 Service。此外，为防止 Service Registry 出现单点故障，因此需要将其搭建为集群环境。</p>
<p>本文将为您揭晓开发轻量级分布式 RPC 框架的具体过程，该框架基于 TCP 协议，提供了 NIO 特性，提供高效的序列化方式，同时也具备服务注册与发现的能力。</p>
<p>根据以上技术需求，我们可使用如下技术选型：</p>
<ol>
<li>Spring：它是最强大的依赖注入框架，也是业界的权威标准。</li>
<li>Netty：它使 NIO 编程更加容易，屏蔽了 Java 底层的 NIO 细节。</li>
<li>Protostuff：它基于 Protobuf 序列化框架，面向 POJO，无需编写 .proto 文件。</li>
<li>ZooKeeper：提供服务注册与发现功能，开发分布式系统的必备选择，同时它也具备天生的集群能力。</li>
</ol>
<p>相关 Maven 依赖请见附录。</p>
<h1 id="h1_0">第一步：编写服务接口</h1>
<pre class="hljs xml"><code class="hljs xml"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- lang: java --&gt;</span></span></span></span>
public interface HelloService {

    String hello(String name);
}
</code></pre><p>将该接口放在独立的客户端 jar 包中，以供应用使用。</p>
<h1 id="h1_1">第二步：编写服务接口的实现类</h1>
<pre class="hljs groovy"><code class="hljs groovy">&lt;!-- <span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">lang:</span></span></span></span> java --&gt;
<span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@RpcService</span></span></span></span>(HelloService.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span></span></span>) <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 指定远程接口</span></span></span></span>
<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelloServiceImpl</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelloService</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> {</span></span></span></span>

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> String hello(String name) {
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span></span></span> <span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"Hello! "</span></span></span></span> + name;
    }
}
</code></pre><p>使用<code>RpcService</code>注解定义在服务接口的实现类上，需要对该实现类指定远程接口，因为实现类可能会实现多个接口，一定要告诉框架哪个才是远程接口。</p>
<p><code>RpcService</code>代码如下：</p>
<pre class="hljs xml"><code class="hljs xml"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- lang: java --&gt;</span></span></span></span>
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Component // 表明可被 Spring 扫描
public @interface RpcService {

    Class<span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?</span></span></span></span></span></span></span><span class="php"><span class="php"><span class="php">&gt; value();
}
</span></span></span></span></code></pre><p>该注解具备 Spring 的<code>Component</code>注解的特性，可被 Spring 扫描。</p>
<p>该实现类放在服务端 jar 包中，该 jar 包还提供了一些服务端的配置文件与启动服务的引导程序。</p>
<h1 id="h1_2">第三步：配置服务端</h1>
<p>服务端 Spring 配置文件名为<code>spring.xml</code>，内容如下：</p>
<pre class="hljs dust"><code class="hljs dust"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- lang: xml --&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">beans</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">context:component-scan</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">base-package</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"com.xxx.rpc.sample.server"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">/&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">

    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">context:property-placeholder</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"classpath:config.properties"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">/&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">

    </span></span></span><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- 配置服务注册组件 --&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"serviceRegistry"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"com.xxx.rpc.registry.ServiceRegistry"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
        </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">constructor-arg</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"registryAddress"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"$</span></span></span></span></span></span></span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable"><span class="hljs-template-variable"><span class="hljs-template-variable">{registry.address}</span></span></span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">/&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">

    </span></span></span><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- 配置 RPC 服务器 --&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"rpcServer"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"com.xxx.rpc.server.RpcServer"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
        </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">constructor-arg</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"serverAddress"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"$</span></span></span></span></span></span></span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable"><span class="hljs-template-variable"><span class="hljs-template-variable">{server.address}</span></span></span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">/&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
        </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">constructor-arg</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"serviceRegistry"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"serviceRegistry"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">/&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">beans</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
</span></span></span></span></code></pre><p>具体的配置参数在<code>config.properties</code>文件中，内容如下：</p>
<pre class="hljs xml"><code class="hljs xml"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- lang: java --&gt;</span></span></span></span>
# ZooKeeper 服务器
registry.address=127.0.0.1:2181

# RPC 服务器
server.address=127.0.0.1:8000
</code></pre><p>以上配置表明：连接本地的 ZooKeeper 服务器，并在 8000 端口上发布 RPC 服务。</p>
<h1 id="h1_3">第四步：启动服务器并发布服务</h1>
<p>为了加载 Spring 配置文件来发布服务，只需编写一个引导程序即可：</p>
<pre class="hljs xml"><code class="hljs xml"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- lang: java --&gt;</span></span></span></span>
public class RpcBootstrap {

    public static void main(String[] args) {
        new ClassPathXmlApplicationContext("spring.xml");
    }
}
</code></pre><p>运行<code>RpcBootstrap</code>类的<code>main</code>方法即可启动服务端，但还有两个重要的组件尚未实现，它们分别是：<code>ServiceRegistry</code>与<code>RpcServer</code>，下文会给出具体实现细节。</p>
<h1 id="h1_4">第五步：实现服务注册</h1>
<p>使用 ZooKeeper 客户端可轻松实现服务注册功能，<code>ServiceRegistry</code>代码如下：</p>
<pre class="hljs java"><code class="hljs java">&lt;!-- lang: java --&gt;
<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ServiceRegistry</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span></span>{

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span></span></span> Logger LOGGER = LoggerFactory.getLogger(ServiceRegistry.class);

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> CountDownLatch latch = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> CountDownLatch(<span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">1</span></span></span></span>);

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> String registryAddress;

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ServiceRegistry</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String registryAddress)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.registryAddress = registryAddress;
    }

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">register</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String data)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (data != <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></span></span>) {
            ZooKeeper zk = connectServer();
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (zk != <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></span></span>) {
                createNode(zk, data);
            }
        }
    }

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> ZooKeeper </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connectServer</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span></span>{
        ZooKeeper zk = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></span></span>;
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span></span></span> {
            zk = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> ZooKeeper(registryAddress, Constant.ZK_SESSION_TIMEOUT, <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> Watcher() {
                <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
                <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WatchedEvent event)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span></span>{
                    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (event.getState() == Event.KeeperState.SyncConnected) {
                        latch.countDown();
                    }
                }
            });
            latch.await();
        } <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">catch</span></span></span></span> (IOException | InterruptedException e) {
            LOGGER.error(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">""</span></span></span></span>, e);
        }
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span></span></span> zk;
    }

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNode</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ZooKeeper zk, String data)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span></span></span> {
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span></span></span>[] bytes = data.getBytes();
            String path = zk.create(Constant.ZK_DATA_PATH, bytes, ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL_SEQUENTIAL);
            LOGGER.debug(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"create zookeeper node ({} =&gt; {})"</span></span></span></span>, path, data);
        } <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">catch</span></span></span></span> (KeeperException | InterruptedException e) {
            LOGGER.error(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">""</span></span></span></span>, e);
        }
    }
}
</code></pre><p>其中，通过<code>Constant</code>配置了所有的常量：</p>
<pre class="hljs xml"><code class="hljs xml"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- lang: java --&gt;</span></span></span></span>
public interface Constant {

    int ZK_SESSION_TIMEOUT = 5000;

    String ZK_REGISTRY_PATH = "/registry";
    String ZK_DATA_PATH = ZK_REGISTRY_PATH + "/data";
}
</code></pre><p>注意：首先需要使用 ZooKeeper 客户端命令行创建<code>/registry</code>永久节点，用于存放所有的服务临时节点。</p>
<h1 id="h1_5">第六步：实现 RPC 服务器</h1>
<p>使用 Netty 可实现一个支持 NIO 的 RPC 服务器，需要使用<code>ServiceRegistry</code>注册服务地址，<code>RpcServer</code>代码如下：</p>
<pre class="hljs groovy"><code class="hljs groovy">&lt;!-- <span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">lang:</span></span></span></span> java --&gt;
<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RpcServer</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApplicationContextAware</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class">, </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InitializingBean</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> {</span></span></span></span>

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span></span></span> Logger LOGGER = LoggerFactory.getLogger(RpcServer.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span></span></span>);

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> String serverAddress;
    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> ServiceRegistry serviceRegistry;

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> Map&lt;String, Object&gt; handlerMap = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> HashMap&lt;&gt;(); <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 存放接口名与服务对象之间的映射关系</span></span></span></span>

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> RpcServer(String serverAddress) {
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.serverAddress = serverAddress;
    }

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> RpcServer(String serverAddress, ServiceRegistry serviceRegistry) {
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.serverAddress = serverAddress;
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.serviceRegistry = serviceRegistry;
    }

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span></span></span> setApplicationContext(ApplicationContext ctx) <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">throws</span></span></span></span> BeansException {
        Map&lt;String, Object&gt; serviceBeanMap = ctx.getBeansWithAnnotation(RpcService.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span></span></span>); <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 获取所有带有 RpcService 注解的 Spring Bean</span></span></span></span>
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (MapUtils.isNotEmpty(serviceBeanMap)) {
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span></span></span> (Object <span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">serviceBean :</span></span></span></span> serviceBeanMap.values()) {
                String interfaceName = serviceBean.getClass().getAnnotation(RpcService.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span></span></span>).value().getName();
                handlerMap.put(interfaceName, serviceBean);
            }
        }
    }

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span></span></span> afterPropertiesSet() <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">throws</span></span></span></span> Exception {
        EventLoopGroup bossGroup = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> NioEventLoopGroup();
        EventLoopGroup workerGroup = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> NioEventLoopGroup();
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span></span></span> {
            ServerBootstrap bootstrap = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> ServerBootstrap();
            bootstrap.group(bossGroup, workerGroup).channel(NioServerSocketChannel.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span></span></span>)
                .childHandler(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> ChannelInitializer&lt;SocketChannel&gt;() {
                    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
                    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span></span></span> initChannel(SocketChannel channel) <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">throws</span></span></span></span> Exception {
                        channel.pipeline()
                            .addLast(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> RpcDecoder(RpcRequest.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span></span></span>)) <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 将 RPC 请求进行解码（为了处理请求）</span></span></span></span>
                            .addLast(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> RpcEncoder(RpcResponse.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span></span></span>)) <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 将 RPC 响应进行编码（为了返回响应）</span></span></span></span>
                            .addLast(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> RpcHandler(handlerMap)); <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 处理 RPC 请求</span></span></span></span>
                    }
                })
                .option(ChannelOption.SO_BACKLOG, <span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">128</span></span></span></span>)
                .childOption(ChannelOption.SO_KEEPALIVE, <span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal">true</span></span></span></span>);

            String[] array = serverAddress.split(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">":"</span></span></span></span>);
            String host = array[<span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">0</span></span></span></span>];
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span></span></span> port = Integer.parseInt(array[<span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">1</span></span></span></span>]);

            ChannelFuture future = bootstrap.bind(host, port).sync();
            LOGGER.debug(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"server started on port {}"</span></span></span></span>, port);

            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (serviceRegistry != <span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal">null</span></span></span></span>) {
                serviceRegistry.register(serverAddress); <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 注册服务地址</span></span></span></span>
            }

            future.channel().closeFuture().sync();
        } <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">finally</span></span></span></span> {
            workerGroup.shutdownGracefully();
            bossGroup.shutdownGracefully();
        }
    }
}
</code></pre><p>以上代码中，有两个重要的 POJO 需要描述一下，它们分别是<code>RpcRequest</code>与<code>RpcResponse</code>。</p>
<p>使用<code>RpcRequest</code>封装 RPC 请求，代码如下：</p>
<pre class="hljs xml"><code class="hljs xml"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- lang: java --&gt;</span></span></span></span>
public class RpcRequest {

    private String requestId;
    private String className;
    private String methodName;
    private Class<span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?</span></span></span></span></span></span></span><span class="php"><span class="php"><span class="php">&gt;[] parameterTypes;
    </span></span></span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword"><span class="php"><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">private</span></span></span></span></span></span></span><span class="php"><span class="php"><span class="php"> Object[] parameters;

    </span></span></span><span class="hljs-comment"><span class="php"><span class="hljs-comment"><span class="php"><span class="hljs-comment"><span class="php"><span class="hljs-comment">// getter/setter...</span></span></span></span></span></span></span><span class="php"><span class="php"><span class="php">
}
</span></span></span></span></code></pre><p>使用<code>RpcResponse</code>封装 RPC 响应，代码如下：</p>
<pre class="hljs xml"><code class="hljs xml"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- lang: java --&gt;</span></span></span></span>
public class RpcResponse {

    private String requestId;
    private Throwable error;
    private Object result;

    // getter/setter...
}
</code></pre><p>使用<code>RpcDecoder</code>提供 RPC 解码，只需扩展 Netty 的<code>ByteToMessageDecoder</code>抽象类的<code>decode</code>方法即可，代码如下：</p>
<pre class="hljs kotlin"><code class="hljs kotlin">&lt;!-- lang: java --&gt;
<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RpcDecoder</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extends</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ByteToMessageDecoder</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span></span>{

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> Class&lt;?&gt; genericClass;

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> RpcDecoder(Class&lt;?&gt; genericClass) {
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.genericClass = genericClass;
    }

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> void decode(ChannelHandlerContext ctx, ByteBuf <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">in</span></span></span></span>, List&lt;Object&gt; <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></span></span>) throws Exception {
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">in</span></span></span></span>.readableBytes() &lt; <span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">4</span></span></span></span>) {
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span></span></span>;
        }
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">in</span></span></span></span>.markReaderIndex();
        int dataLength = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">in</span></span></span></span>.readInt();
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (dataLength &lt; <span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">0</span></span></span></span>) {
            ctx.close();
        }
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">in</span></span></span></span>.readableBytes() &lt; dataLength) {
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">in</span></span></span></span>.resetReaderIndex();
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span></span></span>;
        }
        byte[] <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span></span></span> = new byte[dataLength];
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">in</span></span></span></span>.readBytes(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span></span></span>);

        Object obj = SerializationUtil.deserialize(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span></span></span>, genericClass);
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></span></span>.add(obj);
    }
}
</code></pre><p>使用<code>RpcEncoder</code>提供 RPC 编码，只需扩展 Netty 的<code>MessageToByteEncoder</code>抽象类的<code>encode</code>方法即可，代码如下：</p>
<pre class="hljs kotlin"><code class="hljs kotlin">&lt;!-- lang: java --&gt;
<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RpcEncoder</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extends</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MessageToByteEncoder</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span></span>{

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> Class&lt;?&gt; genericClass;

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> RpcEncoder(Class&lt;?&gt; genericClass) {
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.genericClass = genericClass;
    }

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> void encode(ChannelHandlerContext ctx, Object <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">in</span></span></span></span>, ByteBuf <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></span></span>) throws Exception {
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (genericClass.isInstance(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">in</span></span></span></span>)) {
            byte[] <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span></span></span> = SerializationUtil.serialize(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">in</span></span></span></span>);
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></span></span>.writeInt(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span></span></span>.length);
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">out</span></span></span></span>.writeBytes(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span></span></span>);
        }
    }
}
</code></pre><p>编写一个<code>SerializationUtil</code>工具类，使用<code>Protostuff</code>实现序列化：</p>
<pre class="hljs erb"><code class="hljs erb"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- lang: java --&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
public class SerializationUtil {

    private static Map</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Class</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;?&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">, Schema</span></span></span><span class="php"><span class="hljs-meta"><span class="xml"><span class="php"><span class="hljs-meta"><span class="xml"><span class="php"><span class="hljs-meta"><span class="xml"><span class="php"><span class="hljs-meta">&lt;?</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php">&gt;&gt; cachedSchema = </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">new</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> ConcurrentHashMap&lt;&gt;();

    </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">private</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">static</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> Objenesis objenesis = </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">new</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> ObjenesisStd(</span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">true</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php">);

    </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">private</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> SerializationUtil() {
    }

    @SuppressWarnings(</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="php"><span class="hljs-string"><span class="xml"><span class="php"><span class="hljs-string"><span class="xml"><span class="php"><span class="hljs-string">"unchecked"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php">)
    </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">private</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">static</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> &lt;T&gt; Schema&lt;T&gt; getSchema(</span></span></span></span></span></span><span class="hljs-class"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-keyword">Class</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">&lt;</span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">T</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">&gt; </span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">cls</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">) </span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php">{
        Schema&lt;T&gt; schema = (Schema&lt;T&gt;) cachedSchema.get(cls);
        </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">if</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> (schema == </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">null</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php">) {
            schema = RuntimeSchema.createFrom(cls);
            </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">if</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> (schema != </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">null</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php">) {
                cachedSchema.put(cls, schema);
            }
        }
        </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">return</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> schema;
    }

    @SuppressWarnings(</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="php"><span class="hljs-string"><span class="xml"><span class="php"><span class="hljs-string"><span class="xml"><span class="php"><span class="hljs-string">"unchecked"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php">)
    </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">public</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">static</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> &lt;T&gt; byte[] serialize(T obj) {
        </span></span></span></span></span></span><span class="hljs-class"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-keyword">Class</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">&lt;</span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">T</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">&gt; </span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">cls</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"> = (</span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">Class</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">&lt;</span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">T</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">&gt;) </span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">obj</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">.</span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">getClass</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">();
        </span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">LinkedBuffer</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"> </span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">buffer</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"> = </span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">LinkedBuffer</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">.</span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">allocate</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">(</span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">LinkedBuffer</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">.</span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">DEFAULT_BUFFER_SIZE</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">);
        </span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">try</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"> </span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php">{
            Schema&lt;T&gt; schema = getSchema(cls);
            </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">return</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> ProtostuffIOUtil.toByteArray(obj, schema, buffer);
        } </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">catch</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> (</span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">Exception</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> e) {
            </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">throw</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">new</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> IllegalStateException(e.getMessage(), e);
        } </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">finally</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> {
            buffer.clear();
        }
    }

    </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">public</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">static</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> &lt;T&gt; T deserialize(byte[] data, </span></span></span></span></span></span><span class="hljs-class"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-keyword">Class</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">&lt;</span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">T</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">&gt; </span></span></span></span></span></span></span></span></span><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title"><span class="xml"><span class="php"><span class="hljs-class"><span class="hljs-title">cls</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class"><span class="xml"><span class="php"><span class="hljs-class">) </span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php">{
        </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">try</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> {
            T message = (T) objenesis.newInstance(cls);
            Schema&lt;T&gt; schema = getSchema(cls);
            ProtostuffIOUtil.mergeFrom(data, message, schema);
            </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">return</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> message;
        } </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">catch</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> (</span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">Exception</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> e) {
            </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">throw</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> </span></span></span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword"><span class="xml"><span class="php"><span class="hljs-keyword">new</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="php"><span class="xml"><span class="php"><span class="xml"><span class="php"> IllegalStateException(e.getMessage(), e);
        }
    }
}
</span></span></span></span></span></span></span></span></code></pre><p>以上了使用 Objenesis 来实例化对象，它是比 Java 反射更加强大。</p>
<p>注意：如需要替换其它序列化框架，只需修改<code>SerializationUtil</code>即可。当然，更好的实现方式是提供配置项来决定使用哪种序列化方式。</p>
<p>使用<code>RpcHandler</code>中处理 RPC 请求，只需扩展 Netty 的<code>SimpleChannelInboundHandler</code>抽象类即可，代码如下：</p>
<pre class="hljs java"><code class="hljs java">&lt;!-- lang: java --&gt;
<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RpcHandler</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimpleChannelInboundHandler</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class">&lt;</span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RpcRequest</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class">&gt; </span></span></span></span>{

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span></span></span> Logger LOGGER = LoggerFactory.getLogger(RpcHandler.class);

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span></span></span> Map&lt;String, Object&gt; handlerMap;

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RpcHandler</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Map&lt;String, Object&gt; handlerMap)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.handlerMap = handlerMap;
    }

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">channelRead0</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span></span></span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> ChannelHandlerContext ctx, RpcRequest request)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> Exception </span></span></span></span>{
        RpcResponse response = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> RpcResponse();
        response.setRequestId(request.getRequestId());
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span></span></span> {
            Object result = handle(request);
            response.setResult(result);
        } <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">catch</span></span></span></span> (Throwable t) {
            response.setError(t);
        }
        ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);
    }

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> Object </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handle</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(RpcRequest request)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> Throwable </span></span></span></span>{
        String className = request.getClassName();
        Object serviceBean = handlerMap.get(className);

        Class&lt;?&gt; serviceClass = serviceBean.getClass();
        String methodName = request.getMethodName();
        Class&lt;?&gt;[] parameterTypes = request.getParameterTypes();
        Object[] parameters = request.getParameters();

        <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">/*Method method = serviceClass.getMethod(methodName, parameterTypes);
        method.setAccessible(true);
        return method.invoke(serviceBean, parameters);*/</span></span></span></span>

        FastClass serviceFastClass = FastClass.create(serviceClass);
        FastMethod serviceFastMethod = serviceFastClass.getMethod(methodName, parameterTypes);
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span></span></span> serviceFastMethod.invoke(serviceBean, parameters);
    }

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exceptionCaught</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ChannelHandlerContext ctx, Throwable cause)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span></span>{
        LOGGER.error(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"server caught exception"</span></span></span></span>, cause);
        ctx.close();
    }
}
</code></pre><p>为了避免使用 Java 反射带来的性能问题，我们可以使用 CGLib 提供的反射 API，如上面用到的<code>FastClass</code>与<code>FastMethod</code>。</p>
<h1 id="h1_6">第七步：配置客户端</h1>
<p>同样使用 Spring 配置文件来配置 RPC 客户端，<code>spring.xml</code>代码如下：</p>
<pre class="hljs dust"><code class="hljs dust"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- lang: java --&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">beans</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">context:property-placeholder</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"classpath:config.properties"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">/&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">

    </span></span></span><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- 配置服务发现组件 --&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"serviceDiscovery"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"com.xxx.rpc.registry.ServiceDiscovery"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
        </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">constructor-arg</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"registryAddress"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"$</span></span></span></span></span></span></span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable"><span class="hljs-template-variable"><span class="hljs-template-variable">{registry.address}</span></span></span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">/&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">

    </span></span></span><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- 配置 RPC 代理 --&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"rpcProxy"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"com.xxx.rpc.client.RpcProxy"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
        </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">constructor-arg</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"serviceDiscovery"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"> </span></span></span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">=</span></span></span></span></span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"serviceDiscovery"</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">/&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">beans</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
</span></span></span></span></code></pre><p>其中<code>config.properties</code>提供了具体的配置：</p>
<pre class="hljs xml"><code class="hljs xml"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- lang: java --&gt;</span></span></span></span>
# ZooKeeper 服务器
registry.address=127.0.0.1:2181
</code></pre><h1 id="h1_7">第八步：实现服务发现</h1>
<p>同样使用 ZooKeeper 实现服务发现功能，见如下代码：</p>
<pre class="hljs cs"><code class="hljs cs">&lt;!-- lang: java --&gt;
<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span></span></span> <span class="hljs-title"><span class="hljs-title"><span class="hljs-title"><span class="hljs-title">ServiceDiscovery</span></span></span></span> {

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span></span></span> final Logger LOGGER = LoggerFactory.getLogger(ServiceDiscovery.class);

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> CountDownLatch latch = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> CountDownLatch(<span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">1</span></span></span></span>);

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span></span></span> List&lt;String&gt; dataList = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> ArrayList&lt;&gt;();

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> String registryAddress;

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ServiceDiscovery</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">(</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">String registryAddress</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">) </span></span></span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.registryAddress = registryAddress;

        ZooKeeper zk = connectServer();
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (zk != <span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal">null</span></span></span></span>) {
            watchNode(zk);
        }
    }

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> String </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">discover</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">(</span></span></span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span></span>{
        String data = <span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal">null</span></span></span></span>;
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span></span></span> size = dataList.size();
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (size &gt; <span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">0</span></span></span></span>) {
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (size == <span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">1</span></span></span></span>) {
                data = dataList.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">get</span></span></span></span>(<span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">0</span></span></span></span>);
                LOGGER.debug(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"using only data: {}"</span></span></span></span>, data);
            } <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">else</span></span></span></span> {
                data = dataList.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">get</span></span></span></span>(ThreadLocalRandom.current().nextInt(size));
                LOGGER.debug(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"using random data: {}"</span></span></span></span>, data);
            }
        }
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span></span></span> data;
    }

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> ZooKeeper </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connectServer</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">(</span></span></span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span></span>{
        ZooKeeper zk = <span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal">null</span></span></span></span>;
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span></span></span> {
            zk = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> ZooKeeper(registryAddress, Constant.ZK_SESSION_TIMEOUT, <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> Watcher() {
                @<span class="hljs-function"><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">Override
                </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">(</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WatchedEvent </span></span></span></span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">event</span></span></span></span></span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">) </span></span></span></span>{
                    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">event</span></span></span></span>.getState() == Event.KeeperState.SyncConnected) {
                        latch.countDown();
                    }
                }
            });
            latch.await();
        } <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">catch</span></span></span></span> (IOException | InterruptedException e) {
            LOGGER.error(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">""</span></span></span></span>, e);
        }
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span></span></span> zk;
    }

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">watchNode</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">(</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">final ZooKeeper zk</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">) </span></span></span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span></span></span> {
            List&lt;String&gt; nodeList = zk.getChildren(Constant.ZK_REGISTRY_PATH, <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> Watcher() {
                @<span class="hljs-function"><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">Override
                </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">(</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WatchedEvent </span></span></span></span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">event</span></span></span></span></span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">) </span></span></span></span>{
                    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">event</span></span></span></span>.getType() == Event.EventType.NodeChildrenChanged) {
                        watchNode(zk);
                    }
                }
            });
            List&lt;String&gt; dataList = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> ArrayList&lt;&gt;();
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span></span></span> (String node : nodeList) {
                <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span></span></span>[] bytes = zk.getData(Constant.ZK_REGISTRY_PATH + <span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"/"</span></span></span></span> + node, <span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal">false</span></span></span></span>, <span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal"><span class="hljs-literal">null</span></span></span></span>);
                dataList.add(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> String(bytes));
            }
            LOGGER.debug(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"node data: {}"</span></span></span></span>, dataList);
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.dataList = dataList;
        } <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">catch</span></span></span></span> (KeeperException | InterruptedException e) {
            LOGGER.error(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">""</span></span></span></span>, e);
        }
    }
}
</code></pre><h1 id="h1_8">第九步：实现 RPC 代理</h1>
<p>这里使用 Java 提供的动态代理技术实现 RPC 代理（当然也可以使用 CGLib 来实现），具体代码如下：</p>
<pre class="hljs java"><code class="hljs java">&lt;!-- lang: java --&gt;
<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RpcProxy</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span></span>{

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> String serverAddress;
    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> ServiceDiscovery serviceDiscovery;

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RpcProxy</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String serverAddress)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.serverAddress = serverAddress;
    }

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RpcProxy</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ServiceDiscovery serviceDiscovery)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.serviceDiscovery = serviceDiscovery;
    }

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span></span></span>(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"unchecked"</span></span></span></span>)
    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-function"><span class="hljs-function"><span class="hljs-function">T </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;?&gt; interfaceClass)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span></span></span> (T) Proxy.newProxyInstance(
            interfaceClass.getClassLoader(),
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> Class&lt;?&gt;[]{interfaceClass},
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> InvocationHandler() {
                <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
                <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> Object </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object proxy, Method method, Object[] args)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> Throwable </span></span></span></span>{
                    RpcRequest request = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> RpcRequest(); <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 创建并初始化 RPC 请求</span></span></span></span>
                    request.setRequestId(UUID.randomUUID().toString());
                    request.setClassName(method.getDeclaringClass().getName());
                    request.setMethodName(method.getName());
                    request.setParameterTypes(method.getParameterTypes());
                    request.setParameters(args);

                    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (serviceDiscovery != <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></span></span>) {
                        serverAddress = serviceDiscovery.discover(); <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 发现服务</span></span></span></span>
                    }

                    String[] array = serverAddress.split(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">":"</span></span></span></span>);
                    String host = array[<span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">0</span></span></span></span>];
                    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span></span></span> port = Integer.parseInt(array[<span class="hljs-number"><span class="hljs-number"><span class="hljs-number"><span class="hljs-number">1</span></span></span></span>]);

                    RpcClient client = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> RpcClient(host, port); <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 初始化 RPC 客户端</span></span></span></span>
                    RpcResponse response = client.send(request); <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 通过 RPC 客户端发送 RPC 请求并获取 RPC 响应</span></span></span></span>

                    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (response.isError()) {
                        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span></span></span> response.getError();
                    } <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">else</span></span></span></span> {
                        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span></span></span> response.getResult();
                    }
                }
            }
        );
    }
}
</code></pre><p>使用<code>RpcClient</code>类实现 RPC 客户端，只需扩展 Netty 提供的<code>SimpleChannelInboundHandler</code>抽象类即可，代码如下：</p>
<pre class="hljs java"><code class="hljs java">&lt;!-- lang: java --&gt;
<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RpcClient</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimpleChannelInboundHandler</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class">&lt;</span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RpcResponse</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class">&gt; </span></span></span></span>{

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span></span></span> Logger LOGGER = LoggerFactory.getLogger(RpcClient.class);

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> String host;
    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span></span></span> port;

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> RpcResponse response;

    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span></span></span> Object obj = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> Object();

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RpcClient</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String host, </span></span></span></span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> port)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.host = host;
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.port = port;
    }

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">channelRead0</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ChannelHandlerContext ctx, RpcResponse response)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> Exception </span></span></span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>.response = response;

        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span></span></span> (obj) {
            obj.notifyAll(); <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 收到响应，唤醒线程</span></span></span></span>
        }
    }

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exceptionCaught</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ChannelHandlerContext ctx, Throwable cause)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> Exception </span></span></span></span>{
        LOGGER.error(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"client caught exception"</span></span></span></span>, cause);
        ctx.close();
    }

    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> RpcResponse </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(RpcRequest request)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> Exception </span></span></span></span>{
        EventLoopGroup group = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> NioEventLoopGroup();
        <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span></span></span> {
            Bootstrap bootstrap = <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> Bootstrap();
            bootstrap.group(group).channel(NioSocketChannel.class)
                .handler(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> ChannelInitializer&lt;SocketChannel&gt;() {
                    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span></span></span>
                    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initChannel</span></span></span></span></span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SocketChannel channel)</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> </span></span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span></span></span></span></span><span class="hljs-function"><span class="hljs-function"><span class="hljs-function"> Exception </span></span></span></span>{
                        channel.pipeline()
                            .addLast(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> RpcEncoder(RpcRequest.class)) <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 将 RPC 请求进行编码（为了发送请求）</span></span></span></span>
                            .addLast(<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span></span></span> RpcDecoder(RpcResponse.class)) <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 将 RPC 响应进行解码（为了处理响应）</span></span></span></span>
                            .addLast(RpcClient.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span></span></span>); <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 使用 RpcClient 发送 RPC 请求</span></span></span></span>
                    }
                })
                .option(ChannelOption.SO_KEEPALIVE, <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">true</span></span></span></span>);

            ChannelFuture future = bootstrap.connect(host, port).sync();
            future.channel().writeAndFlush(request).sync();

            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span></span></span> (obj) {
                obj.wait(); <span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">// 未收到响应，使线程等待</span></span></span></span>
            }

            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span></span></span> (response != <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">null</span></span></span></span>) {
                future.channel().closeFuture().sync();
            }
            <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span></span></span> response;
        } <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">finally</span></span></span></span> {
            group.shutdownGracefully();
        }
    }
}
</code></pre><h1 id="h1_9">第十步：发送 RPC 请求</h1>
<p>使用 JUnit 结合 Spring 编写一个单元测试，代码如下：</p>
<pre class="hljs groovy"><code class="hljs groovy">&lt;!-- <span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">lang:</span></span></span></span> java --&gt;
<span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@RunWith</span></span></span></span>(SpringJUnit4ClassRunner.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span></span></span>)
<span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@ContextConfiguration</span></span></span></span>(locations = <span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"classpath:spring.xml"</span></span></span></span>)
<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> </span></span></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelloServiceTest</span></span></span></span></span></span></span><span class="hljs-class"><span class="hljs-class"><span class="hljs-class"> {</span></span></span></span>

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span></span></span>
    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span></span></span> RpcProxy rpcProxy;

    <span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-meta">@Test</span></span></span></span>
    <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span></span></span> helloTest() {
        HelloService helloService = rpcProxy.create(HelloService.<span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span></span></span>);
        String result = helloService.hello(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"World"</span></span></span></span>);
        Assert.assertEquals(<span class="hljs-string"><span class="hljs-string"><span class="hljs-string"><span class="hljs-string">"Hello! World"</span></span></span></span>, result);
    }
}
</code></pre><p>运行以上单元测试，如果不出意外的话，您应该会看到绿条。</p>
<h1 id="h1_10">总结</h1>
<p>本文通过 Spring + Netty + Protostuff + ZooKeeper 实现了一个轻量级 RPC 框架，使用 Spring 提供依赖注入与参数配置，使用 Netty 实现 NIO 方式的数据传输，使用 Protostuff 实现对象序列化，使用 ZooKeeper 实现服务注册与发现。使用该框架，可将服务部署到分布式环境中的任意节点上，客户端通过远程接口来调用服务端的具体实现，让服务端与客户端的开发完全分离，为实现大规模分布式应用提供了基础支持。</p>
<h1 id="h1_11">附录：Maven 依赖</h1>
<pre class="hljs xml"><code class="hljs xml"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- lang: xml --&gt;</span></span></span></span>
<span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- JUnit --&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>junit<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>junit<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>4.11<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>test<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- SLF4J --&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>org.slf4j<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>slf4j-log4j12<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>1.7.7<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- Spring --&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>org.springframework<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>spring-context<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>3.2.12.RELEASE<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>org.springframework<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>spring-test<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>3.2.12.RELEASE<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>test<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- Netty --&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>io.netty<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>netty-all<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>4.0.24.Final<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- Protostuff --&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>com.dyuproject.protostuff<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>protostuff-core<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>1.0.8<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>com.dyuproject.protostuff<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>protostuff-runtime<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>1.0.8<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- ZooKeeper --&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>org.apache.zookeeper<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>zookeeper<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>3.4.6<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- Apache Commons Collections --&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>org.apache.commons<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>commons-collections4<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>4.0<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- Objenesis --&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>org.objenesis<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>objenesis<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>2.1<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- CGLib --&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>cglib<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>cglib<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>3.1<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
</code></pre><blockquote>
<p>源码地址：<a href="http://git.oschina.net/huangyong/rpc">http://git.oschina.net/huangyong/rpc</a></p>
</blockquote>
</div>
                            </div>
            <div class="blog-opr">
                <!-- 版权 -->
                <div class="blog-copyright">
                                            <span title="OSCHINA 博客文章版权属于作者，受法律保护。未经作者同意不得转载。">© 著作权归作者所有</span>
                                    </div>
                <!-- 分类、标签、字数 -->
                <div class="related-info">
                    <ul>
                                                    <li class="classify">分类：<span id="classify"><a href="https://my.oschina.net/huangyong/blog?catalog=407769">未分类</a></span></li>
                                                <li class="Words">字数：<span id="Words">3323</span></li>
                                            </ul>
                </div>
                <div class="tags">
                                            标签：
                                                                                                    <span class="tag" id="tag"><a href="https://my.oschina.net/huangyong/blog?search=%E5%88%86%E5%B8%83%E5%BC%8F">分布式</a></span>
                                                                                                    <span class="tag" id="tag"><a href="https://my.oschina.net/huangyong/blog?search=RPC">RPC</a></span>
                                                                                                    <span class="tag" id="tag"><a href="https://my.oschina.net/huangyong/blog?search=Netty">Netty</a></span>
                                                                                                    <span class="tag" id="tag"><a href="https://my.oschina.net/huangyong/blog?search=Protostuff">Protostuff</a></span>
                                                                                                    <span class="tag" id="tag"><a href="https://my.oschina.net/huangyong/blog?search=ZooKeeper">ZooKeeper</a></span>
                                                            </div>
            </div>
            <!-- 赞、收藏、分享 -->
            <div class="operate">
                <ul>
                                                            <val data-name="isAllowBlogDonate" data-value="true"></val>
                                        <!-- 打賞 -->
                    <li class="opr-btn-blog btn-reward-blog ">
                        <a href="javascript:void(0);" data-popupbox-model="reward" class="btn btn-black-blog">
                            <i class="icon-svg icon-reward-blog"></i>
                             <span id="" class="operate_title">
                                打赏
                             </span>
                        </a>
                    </li>
                                        <!-- 点赞 -->
                    <li class="opr-btn-blog btn-like-blog ">
                                                <a href="javascript:void(0);" class="btn btn-black-blog" onclick="page.vote(361751);">
                            <i class="icon-svg icon-thumbs-o-up-blog"></i>
                             <span id="" class="operate_title">
                                                                    点赞
                                                             </span>
                        </a>
                    </li>
                                            <!-- 收藏 -->
                        <li class="opr-btn-blog btn-favor-blog hover">
                            <a href="javascript:void(0);" class="btn btn-black-blog " data-blogid="361751" data-blogtype="3" data-userid="" data-thispage="https://my.oschina.net/huangyong/blog/361751">
                                <i class="icon-svg icon-star-blog"></i>
                             <span id="" class="operate_title">
                                                                    收藏
                                                             </span>
                            </a>
                                                    </li>

                                        <!-- 分享 -->
                    <li class="opr-btn-blog btn-share-blog hover">
                        <a href="javascript:void(0);" class="btn btn-black-blog">
                            <i class="icon-svg icon-share-o-blog"></i>
                            分享
                        </a>
                        <div class="operate-dropdown share-dropdown">
                            <span class="share-title">分享到：</span>
                            <div class="bdsharebuttonbox bdshare-button-style0-16" data-bd-bind="1479885438227">
                                <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_mshare" data-cmd="mshare" title="分享到一键分享">一键分享</a>
                                <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a>
                                <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a>
                                <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a>
                                <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a>
                                <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友">QQ好友</a>
                                <a href="https://my.oschina.net/huangyong/blog/361751#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记">有道云笔记</a>
                            </div>
                            <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","qzone","tsina","weixin","tqq","sqq"],"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/js/bdshare_api/share.js?t=1466497427000'];</script>
                        </div>
                    </li>
                </ul>
                <div data-type="tip" data-tip-type="fixed">
                    <div class="tooltips" id="error_tip"></div>
                </div>

            </div>
                        <div class="reward-list hide">
                <div class="reward-list-title">
                    共有 <span id="reward-num"></span>  人打赏支持<span id="donate_money"></span>
                </div>
                                <div class="donate-user-list" id="donate_user_list">
                    <p></p>
                </div>
            </div>
                    </div>

        <!-- 个人名片 -->
        <div class="user-card">
            <div class="blog-wrapper">
                <div class="layout-flex">
                    <div class="flex-grow">
                        <div class="layout-flex">
                            <div class="flex-left">
                                <div class="user-info">
                                    <div class="icon">
                                        <a href="https://my.oschina.net/huangyong/home" class="article_editor_head_img" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/223750_100.jpg" align="absmiddle" alt="黄勇" title="黄勇" class="LargePortrait"></a>
                                    </div>
                                    <div class="follow-status">
                                                                                    
                                            <span class="btn btn-green btn-follow " data-follow-value="1" data-follow="btn" data-fansid="223750"> + 关注 </span>
                                                                            </div>
                                </div>
                            </div>
                            <div class="flex-grow">

                                <div class="opus-info">
                                    <div class="title">
                                        <a href="https://my.oschina.net/huangyong/home" class="name" target="_blank">黄勇
                                        </a>
                                        <div class="medal medal-osc">
                                                                                                                                                                                            <div class="medal-item">
                                                        <a class="medal-logo" href="javascript:void(0);" target="_blank">
                                                            <img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/slogo1389665116991.png" alt="高手问答" title="高手问答">
                                                        </a>
                                                        <div class="dropdown tooltip-box">
                                                            <div class="layout-flex">
                                                                <div class="medal-logo">
                                                                    <img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/logo1392021414744.png" alt="高手问答">
                                                                </div>
                                                                <div class="flex-start">
                                                                    <span class="panel-row title">高手问答</span>
                                                                    <span class="panel-row font-green">领取时间：2015-09-09</span>
                                                                    <span class="panel-row "><p><a title="高手问答" href="http://www.oschina.net/question/tag/%E9%AB%98%E6%89%8B%E9%97%AE%E7%AD%94" target="_blank">高手问答</a> 是开源中国针对行业特定技术问题发起的专家问答。</p></span>
                                                                    <span class="panel-row"><span class="font-red">领取条件：</span><span class="font-gray">受邀参与高手问答的技术专家可以领取</span></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                                                                    <div class="medal-item">
                                                        <a class="medal-logo" href="javascript:void(0);" target="_blank">
                                                            <img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/slogo1392107698619.png" alt="开源项目作者" title="开源项目作者">
                                                        </a>
                                                        <div class="dropdown tooltip-box">
                                                            <div class="layout-flex">
                                                                <div class="medal-logo">
                                                                    <img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/logo1392107698618.png" alt="开源项目作者">
                                                                </div>
                                                                <div class="flex-start">
                                                                    <span class="panel-row title">开源项目作者</span>
                                                                    <span class="panel-row font-green">领取时间：2014-02-12</span>
                                                                    <span class="panel-row ">作为一个开源项目作者，是时候站出来拯救世界了！</span>
                                                                    <span class="panel-row"><span class="font-red">领取条件：</span><span class="font-gray">开源项目被开源中国收录的开发者可领取</span></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                                                                                                                                                </div>
                                    </div>
                                    <div class="card-post-info">
                                                                                <span class="card-post">
                                            <i class="icon-svg icon-post-blog"></i>
                                            CTO(技术副总裁)
                                        </span>
                                                                                                                        <span class="card-address">
                                             <i class="icon-svg icon-address-blog"></i>
                                             浦东
                                        </span>
                                                                            </div>
                                    <div class="opus-opr">
                                        <div class="opus-opr-item">粉丝 <span>4269</span></div>
                                        <div class="opus-opr-item">博文 <span>114</span></div>
                                        <div class="opus-opr-item">码字总数 <span>196351 </span></div>
                                                                                                                        <div class="opus-opr-item">作品 <span>
                                        1 </span></div>
                                                                            </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="flex-right">
                        <!-- 技能雷达 -->
                        <div class="user-radar hide" data-user="223750" style="display: block;">
                            <div id="radar-skill" style="width: 200px; height: 120px; margin: auto; position: relative;" data-detail="https://www.oschina.net/radar/huangyong">
                            <canvas width="200" height="120" style="width: 200px; height: 120px;"></canvas></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 相关博客 -->
                        <div class="blog-related">
            <div class="blog-wrapper">
                 <div class="panel panel-related" id="blog-related">
                     <div class="panel-heading">
                          相关博客
                     </div>
                     <div class="panel-body">
                         <div class="related-blogs-list flex-item">
                                                                                            <div class="blog-item">
                                    <div class="layout-flex">
                                                                                  <span class="img">
                                                <img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/002234_ENsM_223750.png">
                                           </span>
                                                                              <div class="flex-grow">
                                            <a href="https://my.oschina.net/u/2000064/blog/684069" class="title" title="轻量级分布式 RPC 框架" target="_self">
                                                轻量级分布式 RPC 框架
                                            </a>
                                            <div class="author-info">
                                                <span class="icon">
                                                    <img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/portrait.gif">
                                                </span>
                                                冰凌呈夏
                                            </div>
                                        </div>
                                    </div>
                                    <div class="relation-data text-right">
                                        <span class="view data-item"><i class="icon-svg icon-eye"></i>64</span>
                                        <a class="reply data-item" href="http://my.oschina.com:8888/J25/blog/190490#comment-list" target="_blank"><i class="icon-svg icon-reply"></i>0</a>
                                    </div>
                                </div>
                                                                                                                            <div class="blog-item">
                                    <div class="layout-flex">
                                                                                  <span class="img">
                                                <img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/22140509_TgUx.png">
                                           </span>
                                                                              <div class="flex-grow">
                                            <a href="https://my.oschina.net/u/2890903/blog/736059" class="title" title="大型分布式网络架构设计与实践笔记01. RPC" target="_self">
                                                大型分布式网络架构设计与实践笔记01. RPC
                                            </a>
                                            <div class="author-info">
                                                <span class="icon">
                                                    <img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/2890903_50.png">
                                                </span>
                                                landx
                                            </div>
                                        </div>
                                    </div>
                                    <div class="relation-data text-right">
                                        <span class="view data-item"><i class="icon-svg icon-eye"></i>89</span>
                                        <a class="reply data-item" href="http://my.oschina.com:8888/J25/blog/190490#comment-list" target="_blank"><i class="icon-svg icon-reply"></i>0</a>
                                    </div>
                                </div>
                                                                                                                            <div class="blog-item">
                                    <div class="layout-flex">
                                                                              <div class="flex-grow">
                                            <a href="https://my.oschina.net/xiaoniull/blog/614947" class="title" title="分布式服务框架与RPC框架" target="_self">
                                                分布式服务框架与RPC框架
                                            </a>
                                            <div class="author-info">
                                                <span class="icon">
                                                    <img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/portrait.gif">
                                                </span>
                                                n78498129
                                            </div>
                                        </div>
                                    </div>
                                    <div class="relation-data text-right">
                                        <span class="view data-item"><i class="icon-svg icon-eye"></i>320</span>
                                        <a class="reply data-item" href="http://my.oschina.com:8888/J25/blog/190490#comment-list" target="_blank"><i class="icon-svg icon-reply"></i>0</a>
                                    </div>
                                </div>
                                                                                     </div>
                     </div>
                 </div>
            </div>
        </div>
                <!-- 评论 -->
        <div class="blog-comments">
            <div class="blog-wrapper">
                <div class="panel panel-comments" id="comment-list">
                    <div class="panel-heading" id="blog-comments-list">评论
                        <em>
                            (<span class="reply_count">140</span>)
                        </em>
                    </div>
                    <div class="panel-body">
                        <div class="panel-comment-form">
                            <!-- 发表评论表单 -->
                                                            <!--  -->
<val data-name="emoji_js_url" data-value="/build/www/vendor/emoji/emoji_github.js?t=1471883054000"></val>
<val data-name="emoji_css_url" data-value="/build/www/vendor/emoji/emoji.min.css?t=1471883054000"></val>
<div class="SpaceList">
    <a name="comments" id="postform"></a>
        <div class="layout BlogCommentForm blog-comment-form comment-emoji">
                    <form id="form_comment" action="https://my.oschina.net/action/blog/add_comment?blog=361751" method="POST">
                                                                                                <div class="comment_form layout-column">
                    <textarea name="content" id="wmd-input" placeholder=""></textarea>
                    <div class="layout">
                        <div class="layout-right">
                            <span class="text-muted">
                                Ctrl+Enter
                            </span>
                            <button type="submit" class="btn btn-green blg_submit_btn">发表评论</button>
                        </div>
                        <div class="layout-column">
                            <a href="javascript:;" class="blog_emotion">
                                <i class="icon-svg icon-emotions-hollow-gray"></i>
                                <div data-emoji="wrapper">
                                    <ul data-emoji="nav">
                                        <li data-emoji-nav="People" class="active">People</li>
                                        <li data-emoji-nav="Nature">Nature</li>
                                        <li data-emoji-nav="Objects">Objects</li>
                                        <li data-emoji-nav="Places">Places</li>
                                        <li data-emoji-nav="Symbols">Symbols</li>
                                    </ul>
                                    <div data-emoji="panel">
                                        <div data-emoji-item="People" class="active"><div data-group="People"><div data-group-title="emoji-group-title" style="display: none;">People</div><div class="emoji-row"><div class="emoji-block" title="bowtie" data-emoji="bowtie"></div><div class="emoji-block" title="smile" data-emoji="smile"></div><div class="emoji-block" title="laughing" data-emoji="laughing"></div><div class="emoji-block" title="blush" data-emoji="blush"></div><div class="emoji-block" title="smiley" data-emoji="smiley"></div><div class="emoji-block" title="relaxed" data-emoji="relaxed"></div><div class="emoji-block" title="smirk" data-emoji="smirk"></div><div class="emoji-block" title="heart_eyes" data-emoji="heart_eyes"></div><div class="emoji-block" title="kissing_heart" data-emoji="kissing_heart"></div><div class="emoji-block" title="kissing_closed_eyes" data-emoji="kissing_closed_eyes"></div><div class="emoji-block" title="flushed" data-emoji="flushed"></div><div class="emoji-block" title="relieved" data-emoji="relieved"></div><div class="emoji-block" title="satisfied" data-emoji="satisfied"></div><div class="emoji-block" title="grin" data-emoji="grin"></div><div class="emoji-block" title="wink" data-emoji="wink"></div><div class="emoji-block" title="stuck_out_tongue_winking_eye" data-emoji="stuck_out_tongue_winking_eye"></div><div class="emoji-block" title="stuck_out_tongue_closed_eyes" data-emoji="stuck_out_tongue_closed_eyes"></div><div class="emoji-block" title="grinning" data-emoji="grinning"></div><div class="emoji-block" title="kissing" data-emoji="kissing"></div><div class="emoji-block" title="kissing_smiling_eyes" data-emoji="kissing_smiling_eyes"></div></div><div class="emoji-row"><div class="emoji-block" title="stuck_out_tongue" data-emoji="stuck_out_tongue"></div><div class="emoji-block" title="sleeping" data-emoji="sleeping"></div><div class="emoji-block" title="worried" data-emoji="worried"></div><div class="emoji-block" title="frowning" data-emoji="frowning"></div><div class="emoji-block" title="anguished" data-emoji="anguished"></div><div class="emoji-block" title="open_mouth" data-emoji="open_mouth"></div><div class="emoji-block" title="grimacing" data-emoji="grimacing"></div><div class="emoji-block" title="confused" data-emoji="confused"></div><div class="emoji-block" title="hushed" data-emoji="hushed"></div><div class="emoji-block" title="expressionless" data-emoji="expressionless"></div><div class="emoji-block" title="unamused" data-emoji="unamused"></div><div class="emoji-block" title="sweat_smile" data-emoji="sweat_smile"></div><div class="emoji-block" title="sweat" data-emoji="sweat"></div><div class="emoji-block" title="disappointed_relieved" data-emoji="disappointed_relieved"></div><div class="emoji-block" title="weary" data-emoji="weary"></div><div class="emoji-block" title="pensive" data-emoji="pensive"></div><div class="emoji-block" title="disappointed" data-emoji="disappointed"></div><div class="emoji-block" title="confounded" data-emoji="confounded"></div><div class="emoji-block" title="fearful" data-emoji="fearful"></div><div class="emoji-block" title="cold_sweat" data-emoji="cold_sweat"></div></div><div class="emoji-row"><div class="emoji-block" title="persevere" data-emoji="persevere"></div><div class="emoji-block" title="cry" data-emoji="cry"></div><div class="emoji-block" title="sob" data-emoji="sob"></div><div class="emoji-block" title="joy" data-emoji="joy"></div><div class="emoji-block" title="astonished" data-emoji="astonished"></div><div class="emoji-block" title="scream" data-emoji="scream"></div><div class="emoji-block" title="neckbeard" data-emoji="neckbeard"></div><div class="emoji-block" title="tired_face" data-emoji="tired_face"></div><div class="emoji-block" title="angry" data-emoji="angry"></div><div class="emoji-block" title="rage" data-emoji="rage"></div><div class="emoji-block" title="triumph" data-emoji="triumph"></div><div class="emoji-block" title="sleepy" data-emoji="sleepy"></div><div class="emoji-block" title="yum" data-emoji="yum"></div><div class="emoji-block" title="mask" data-emoji="mask"></div><div class="emoji-block" title="sunglasses" data-emoji="sunglasses"></div><div class="emoji-block" title="dizzy_face" data-emoji="dizzy_face"></div><div class="emoji-block" title="imp" data-emoji="imp"></div><div class="emoji-block" title="smiling_imp" data-emoji="smiling_imp"></div><div class="emoji-block" title="neutral_face" data-emoji="neutral_face"></div><div class="emoji-block" title="no_mouth" data-emoji="no_mouth"></div></div><div class="emoji-row"><div class="emoji-block" title="innocent" data-emoji="innocent"></div><div class="emoji-block" title="alien" data-emoji="alien"></div><div class="emoji-block" title="yellow_heart" data-emoji="yellow_heart"></div><div class="emoji-block" title="blue_heart" data-emoji="blue_heart"></div><div class="emoji-block" title="purple_heart" data-emoji="purple_heart"></div><div class="emoji-block" title="heart" data-emoji="heart"></div><div class="emoji-block" title="green_heart" data-emoji="green_heart"></div><div class="emoji-block" title="broken_heart" data-emoji="broken_heart"></div><div class="emoji-block" title="heartbeat" data-emoji="heartbeat"></div><div class="emoji-block" title="heartpulse" data-emoji="heartpulse"></div><div class="emoji-block" title="two_hearts" data-emoji="two_hearts"></div><div class="emoji-block" title="revolving_hearts" data-emoji="revolving_hearts"></div><div class="emoji-block" title="cupid" data-emoji="cupid"></div><div class="emoji-block" title="sparkling_heart" data-emoji="sparkling_heart"></div><div class="emoji-block" title="sparkles" data-emoji="sparkles"></div><div class="emoji-block" title="star" data-emoji="star"></div><div class="emoji-block" title="star2" data-emoji="star2"></div><div class="emoji-block" title="dizzy" data-emoji="dizzy"></div><div class="emoji-block" title="boom" data-emoji="boom"></div><div class="emoji-block" title="collision" data-emoji="collision"></div></div><div class="emoji-row"><div class="emoji-block" title="anger" data-emoji="anger"></div><div class="emoji-block" title="exclamation" data-emoji="exclamation"></div><div class="emoji-block" title="question" data-emoji="question"></div><div class="emoji-block" title="grey_exclamation" data-emoji="grey_exclamation"></div><div class="emoji-block" title="grey_question" data-emoji="grey_question"></div><div class="emoji-block" title="zzz" data-emoji="zzz"></div><div class="emoji-block" title="dash" data-emoji="dash"></div><div class="emoji-block" title="sweat_drops" data-emoji="sweat_drops"></div><div class="emoji-block" title="notes" data-emoji="notes"></div><div class="emoji-block" title="musical_note" data-emoji="musical_note"></div><div class="emoji-block" title="fire" data-emoji="fire"></div><div class="emoji-block" title="hankey" data-emoji="hankey"></div><div class="emoji-block" title="poop" data-emoji="poop"></div><div class="emoji-block" title="shit" data-emoji="shit"></div><div class="emoji-block" title="+1" data-emoji="+1"></div><div class="emoji-block" title="thumbsup" data-emoji="thumbsup"></div><div class="emoji-block" title="-1" data-emoji="-1"></div><div class="emoji-block" title="thumbsdown" data-emoji="thumbsdown"></div><div class="emoji-block" title="ok_hand" data-emoji="ok_hand"></div><div class="emoji-block" title="punch" data-emoji="punch"></div></div><div class="emoji-row"><div class="emoji-block" title="facepunch" data-emoji="facepunch"></div><div class="emoji-block" title="fist" data-emoji="fist"></div><div class="emoji-block" title="v" data-emoji="v"></div><div class="emoji-block" title="wave" data-emoji="wave"></div><div class="emoji-block" title="hand" data-emoji="hand"></div><div class="emoji-block" title="raised_hand" data-emoji="raised_hand"></div><div class="emoji-block" title="open_hands" data-emoji="open_hands"></div><div class="emoji-block" title="point_up" data-emoji="point_up"></div><div class="emoji-block" title="point_down" data-emoji="point_down"></div><div class="emoji-block" title="point_left" data-emoji="point_left"></div><div class="emoji-block" title="point_right" data-emoji="point_right"></div><div class="emoji-block" title="raised_hands" data-emoji="raised_hands"></div><div class="emoji-block" title="pray" data-emoji="pray"></div><div class="emoji-block" title="point_up_2" data-emoji="point_up_2"></div><div class="emoji-block" title="clap" data-emoji="clap"></div><div class="emoji-block" title="muscle" data-emoji="muscle"></div><div class="emoji-block" title="metal" data-emoji="metal"></div><div class="emoji-block" title="fu" data-emoji="fu"></div><div class="emoji-block" title="walking" data-emoji="walking"></div><div class="emoji-block" title="runner" data-emoji="runner"></div></div><div class="emoji-row"><div class="emoji-block" title="running" data-emoji="running"></div><div class="emoji-block" title="couple" data-emoji="couple"></div><div class="emoji-block" title="family" data-emoji="family"></div><div class="emoji-block" title="two_men_holding_hands" data-emoji="two_men_holding_hands"></div><div class="emoji-block" title="two_women_holding_hands" data-emoji="two_women_holding_hands"></div><div class="emoji-block" title="dancer" data-emoji="dancer"></div><div class="emoji-block" title="dancers" data-emoji="dancers"></div><div class="emoji-block" title="ok_woman" data-emoji="ok_woman"></div><div class="emoji-block" title="no_good" data-emoji="no_good"></div><div class="emoji-block" title="information_desk_person" data-emoji="information_desk_person"></div><div class="emoji-block" title="raising_hand" data-emoji="raising_hand"></div><div class="emoji-block" title="bride_with_veil" data-emoji="bride_with_veil"></div><div class="emoji-block" title="person_with_pouting_face" data-emoji="person_with_pouting_face"></div><div class="emoji-block" title="person_frowning" data-emoji="person_frowning"></div><div class="emoji-block" title="bow" data-emoji="bow"></div><div class="emoji-block" title="couplekiss" data-emoji="couplekiss"></div><div class="emoji-block" title="couple_with_heart" data-emoji="couple_with_heart"></div><div class="emoji-block" title="massage" data-emoji="massage"></div><div class="emoji-block" title="haircut" data-emoji="haircut"></div><div class="emoji-block" title="nail_care" data-emoji="nail_care"></div></div><div class="emoji-row"><div class="emoji-block" title="boy" data-emoji="boy"></div><div class="emoji-block" title="girl" data-emoji="girl"></div><div class="emoji-block" title="woman" data-emoji="woman"></div><div class="emoji-block" title="man" data-emoji="man"></div><div class="emoji-block" title="baby" data-emoji="baby"></div><div class="emoji-block" title="older_woman" data-emoji="older_woman"></div><div class="emoji-block" title="older_man" data-emoji="older_man"></div><div class="emoji-block" title="person_with_blond_hair" data-emoji="person_with_blond_hair"></div><div class="emoji-block" title="man_with_gua_pi_mao" data-emoji="man_with_gua_pi_mao"></div><div class="emoji-block" title="man_with_turban" data-emoji="man_with_turban"></div><div class="emoji-block" title="construction_worker" data-emoji="construction_worker"></div><div class="emoji-block" title="cop" data-emoji="cop"></div><div class="emoji-block" title="angel" data-emoji="angel"></div><div class="emoji-block" title="princess" data-emoji="princess"></div><div class="emoji-block" title="smiley_cat" data-emoji="smiley_cat"></div><div class="emoji-block" title="smile_cat" data-emoji="smile_cat"></div><div class="emoji-block" title="heart_eyes_cat" data-emoji="heart_eyes_cat"></div><div class="emoji-block" title="kissing_cat" data-emoji="kissing_cat"></div><div class="emoji-block" title="smirk_cat" data-emoji="smirk_cat"></div><div class="emoji-block" title="scream_cat" data-emoji="scream_cat"></div></div><div class="emoji-row"><div class="emoji-block" title="crying_cat_face" data-emoji="crying_cat_face"></div><div class="emoji-block" title="joy_cat" data-emoji="joy_cat"></div><div class="emoji-block" title="pouting_cat" data-emoji="pouting_cat"></div><div class="emoji-block" title="japanese_ogre" data-emoji="japanese_ogre"></div><div class="emoji-block" title="japanese_goblin" data-emoji="japanese_goblin"></div><div class="emoji-block" title="see_no_evil" data-emoji="see_no_evil"></div><div class="emoji-block" title="hear_no_evil" data-emoji="hear_no_evil"></div><div class="emoji-block" title="speak_no_evil" data-emoji="speak_no_evil"></div><div class="emoji-block" title="guardsman" data-emoji="guardsman"></div><div class="emoji-block" title="skull" data-emoji="skull"></div><div class="emoji-block" title="feet" data-emoji="feet"></div><div class="emoji-block" title="lips" data-emoji="lips"></div><div class="emoji-block" title="kiss" data-emoji="kiss"></div><div class="emoji-block" title="droplet" data-emoji="droplet"></div><div class="emoji-block" title="ear" data-emoji="ear"></div><div class="emoji-block" title="eyes" data-emoji="eyes"></div><div class="emoji-block" title="nose" data-emoji="nose"></div><div class="emoji-block" title="tongue" data-emoji="tongue"></div><div class="emoji-block" title="love_letter" data-emoji="love_letter"></div><div class="emoji-block" title="bust_in_silhouette" data-emoji="bust_in_silhouette"></div></div><div class="emoji-row"><div class="emoji-block" title="busts_in_silhouette" data-emoji="busts_in_silhouette"></div><div class="emoji-block" title="speech_balloon" data-emoji="speech_balloon"></div><div class="emoji-block" title="thought_balloon" data-emoji="thought_balloon"></div><div class="emoji-block" title="feelsgood" data-emoji="feelsgood"></div><div class="emoji-block" title="finnadie" data-emoji="finnadie"></div><div class="emoji-block" title="goberserk" data-emoji="goberserk"></div><div class="emoji-block" title="godmode" data-emoji="godmode"></div><div class="emoji-block" title="hurtrealbad" data-emoji="hurtrealbad"></div><div class="emoji-block" title="rage1" data-emoji="rage1"></div><div class="emoji-block" title="rage2" data-emoji="rage2"></div><div class="emoji-block" title="rage3" data-emoji="rage3"></div><div class="emoji-block" title="rage4" data-emoji="rage4"></div><div class="emoji-block" title="suspect" data-emoji="suspect"></div><div class="emoji-block" title="trollface" data-emoji="trollface"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div></div></div></div>
                                        <div data-emoji-item="Nature"><div data-group="Nature"><div data-group-title="emoji-group-title" style="display: none;">Nature</div><div class="emoji-row"><div class="emoji-block" title="sunny" data-emoji="sunny"></div><div class="emoji-block" title="umbrella" data-emoji="umbrella"></div><div class="emoji-block" title="cloud" data-emoji="cloud"></div><div class="emoji-block" title="snowflake" data-emoji="snowflake"></div><div class="emoji-block" title="snowman" data-emoji="snowman"></div><div class="emoji-block" title="zap" data-emoji="zap"></div><div class="emoji-block" title="cyclone" data-emoji="cyclone"></div><div class="emoji-block" title="foggy" data-emoji="foggy"></div><div class="emoji-block" title="ocean" data-emoji="ocean"></div><div class="emoji-block" title="cat" data-emoji="cat"></div><div class="emoji-block" title="dog" data-emoji="dog"></div><div class="emoji-block" title="mouse" data-emoji="mouse"></div><div class="emoji-block" title="hamster" data-emoji="hamster"></div><div class="emoji-block" title="rabbit" data-emoji="rabbit"></div><div class="emoji-block" title="wolf" data-emoji="wolf"></div><div class="emoji-block" title="frog" data-emoji="frog"></div><div class="emoji-block" title="tiger" data-emoji="tiger"></div><div class="emoji-block" title="koala" data-emoji="koala"></div><div class="emoji-block" title="bear" data-emoji="bear"></div><div class="emoji-block" title="pig" data-emoji="pig"></div></div><div class="emoji-row"><div class="emoji-block" title="pig_nose" data-emoji="pig_nose"></div><div class="emoji-block" title="cow" data-emoji="cow"></div><div class="emoji-block" title="boar" data-emoji="boar"></div><div class="emoji-block" title="monkey_face" data-emoji="monkey_face"></div><div class="emoji-block" title="monkey" data-emoji="monkey"></div><div class="emoji-block" title="horse" data-emoji="horse"></div><div class="emoji-block" title="racehorse" data-emoji="racehorse"></div><div class="emoji-block" title="camel" data-emoji="camel"></div><div class="emoji-block" title="sheep" data-emoji="sheep"></div><div class="emoji-block" title="elephant" data-emoji="elephant"></div><div class="emoji-block" title="panda_face" data-emoji="panda_face"></div><div class="emoji-block" title="snake" data-emoji="snake"></div><div class="emoji-block" title="bird" data-emoji="bird"></div><div class="emoji-block" title="baby_chick" data-emoji="baby_chick"></div><div class="emoji-block" title="hatched_chick" data-emoji="hatched_chick"></div><div class="emoji-block" title="hatching_chick" data-emoji="hatching_chick"></div><div class="emoji-block" title="chicken" data-emoji="chicken"></div><div class="emoji-block" title="penguin" data-emoji="penguin"></div><div class="emoji-block" title="turtle" data-emoji="turtle"></div><div class="emoji-block" title="bug" data-emoji="bug"></div></div><div class="emoji-row"><div class="emoji-block" title="honeybee" data-emoji="honeybee"></div><div class="emoji-block" title="ant" data-emoji="ant"></div><div class="emoji-block" title="beetle" data-emoji="beetle"></div><div class="emoji-block" title="snail" data-emoji="snail"></div><div class="emoji-block" title="octopus" data-emoji="octopus"></div><div class="emoji-block" title="tropical_fish" data-emoji="tropical_fish"></div><div class="emoji-block" title="fish" data-emoji="fish"></div><div class="emoji-block" title="whale" data-emoji="whale"></div><div class="emoji-block" title="whale2" data-emoji="whale2"></div><div class="emoji-block" title="dolphin" data-emoji="dolphin"></div><div class="emoji-block" title="cow2" data-emoji="cow2"></div><div class="emoji-block" title="ram" data-emoji="ram"></div><div class="emoji-block" title="rat" data-emoji="rat"></div><div class="emoji-block" title="water_buffalo" data-emoji="water_buffalo"></div><div class="emoji-block" title="tiger2" data-emoji="tiger2"></div><div class="emoji-block" title="rabbit2" data-emoji="rabbit2"></div><div class="emoji-block" title="dragon" data-emoji="dragon"></div><div class="emoji-block" title="goat" data-emoji="goat"></div><div class="emoji-block" title="rooster" data-emoji="rooster"></div><div class="emoji-block" title="dog2" data-emoji="dog2"></div></div><div class="emoji-row"><div class="emoji-block" title="pig2" data-emoji="pig2"></div><div class="emoji-block" title="mouse2" data-emoji="mouse2"></div><div class="emoji-block" title="ox" data-emoji="ox"></div><div class="emoji-block" title="dragon_face" data-emoji="dragon_face"></div><div class="emoji-block" title="blowfish" data-emoji="blowfish"></div><div class="emoji-block" title="crocodile" data-emoji="crocodile"></div><div class="emoji-block" title="dromedary_camel" data-emoji="dromedary_camel"></div><div class="emoji-block" title="leopard" data-emoji="leopard"></div><div class="emoji-block" title="cat2" data-emoji="cat2"></div><div class="emoji-block" title="poodle" data-emoji="poodle"></div><div class="emoji-block" title="paw_prints" data-emoji="paw_prints"></div><div class="emoji-block" title="bouquet" data-emoji="bouquet"></div><div class="emoji-block" title="cherry_blossom" data-emoji="cherry_blossom"></div><div class="emoji-block" title="tulip" data-emoji="tulip"></div><div class="emoji-block" title="four_leaf_clover" data-emoji="four_leaf_clover"></div><div class="emoji-block" title="rose" data-emoji="rose"></div><div class="emoji-block" title="sunflower" data-emoji="sunflower"></div><div class="emoji-block" title="hibiscus" data-emoji="hibiscus"></div><div class="emoji-block" title="maple_leaf" data-emoji="maple_leaf"></div><div class="emoji-block" title="leaves" data-emoji="leaves"></div></div><div class="emoji-row"><div class="emoji-block" title="fallen_leaf" data-emoji="fallen_leaf"></div><div class="emoji-block" title="herb" data-emoji="herb"></div><div class="emoji-block" title="mushroom" data-emoji="mushroom"></div><div class="emoji-block" title="cactus" data-emoji="cactus"></div><div class="emoji-block" title="palm_tree" data-emoji="palm_tree"></div><div class="emoji-block" title="evergreen_tree" data-emoji="evergreen_tree"></div><div class="emoji-block" title="deciduous_tree" data-emoji="deciduous_tree"></div><div class="emoji-block" title="chestnut" data-emoji="chestnut"></div><div class="emoji-block" title="seedling" data-emoji="seedling"></div><div class="emoji-block" title="blossom" data-emoji="blossom"></div><div class="emoji-block" title="ear_of_rice" data-emoji="ear_of_rice"></div><div class="emoji-block" title="shell" data-emoji="shell"></div><div class="emoji-block" title="globe_with_meridians" data-emoji="globe_with_meridians"></div><div class="emoji-block" title="sun_with_face" data-emoji="sun_with_face"></div><div class="emoji-block" title="full_moon_with_face" data-emoji="full_moon_with_face"></div><div class="emoji-block" title="new_moon_with_face" data-emoji="new_moon_with_face"></div><div class="emoji-block" title="new_moon" data-emoji="new_moon"></div><div class="emoji-block" title="waxing_crescent_moon" data-emoji="waxing_crescent_moon"></div><div class="emoji-block" title="first_quarter_moon" data-emoji="first_quarter_moon"></div><div class="emoji-block" title="waxing_gibbous_moon" data-emoji="waxing_gibbous_moon"></div></div><div class="emoji-row"><div class="emoji-block" title="full_moon" data-emoji="full_moon"></div><div class="emoji-block" title="waning_gibbous_moon" data-emoji="waning_gibbous_moon"></div><div class="emoji-block" title="last_quarter_moon" data-emoji="last_quarter_moon"></div><div class="emoji-block" title="waning_crescent_moon" data-emoji="waning_crescent_moon"></div><div class="emoji-block" title="last_quarter_moon_with_face" data-emoji="last_quarter_moon_with_face"></div><div class="emoji-block" title="first_quarter_moon_with_face" data-emoji="first_quarter_moon_with_face"></div><div class="emoji-block" title="moon" data-emoji="moon"></div><div class="emoji-block" title="earth_africa" data-emoji="earth_africa"></div><div class="emoji-block" title="earth_americas" data-emoji="earth_americas"></div><div class="emoji-block" title="earth_asia" data-emoji="earth_asia"></div><div class="emoji-block" title="volcano" data-emoji="volcano"></div><div class="emoji-block" title="milky_way" data-emoji="milky_way"></div><div class="emoji-block" title="partly_sunny" data-emoji="partly_sunny"></div><div class="emoji-block" title="octocat" data-emoji="octocat"></div><div class="emoji-block" title="squirrel" data-emoji="squirrel"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div></div></div></div>
                                        <div data-emoji-item="Objects"><div data-group="Objects"><div data-group-title="emoji-group-title" style="display: none;">Objects</div><div class="emoji-row"><div class="emoji-block" title="bamboo" data-emoji="bamboo"></div><div class="emoji-block" title="gift_heart" data-emoji="gift_heart"></div><div class="emoji-block" title="dolls" data-emoji="dolls"></div><div class="emoji-block" title="school_satchel" data-emoji="school_satchel"></div><div class="emoji-block" title="mortar_board" data-emoji="mortar_board"></div><div class="emoji-block" title="flags" data-emoji="flags"></div><div class="emoji-block" title="fireworks" data-emoji="fireworks"></div><div class="emoji-block" title="sparkler" data-emoji="sparkler"></div><div class="emoji-block" title="wind_chime" data-emoji="wind_chime"></div><div class="emoji-block" title="rice_scene" data-emoji="rice_scene"></div><div class="emoji-block" title="jack_o_lantern" data-emoji="jack_o_lantern"></div><div class="emoji-block" title="ghost" data-emoji="ghost"></div><div class="emoji-block" title="santa" data-emoji="santa"></div><div class="emoji-block" title="christmas_tree" data-emoji="christmas_tree"></div><div class="emoji-block" title="gift" data-emoji="gift"></div><div class="emoji-block" title="bell" data-emoji="bell"></div><div class="emoji-block" title="no_bell" data-emoji="no_bell"></div><div class="emoji-block" title="tanabata_tree" data-emoji="tanabata_tree"></div><div class="emoji-block" title="tada" data-emoji="tada"></div><div class="emoji-block" title="confetti_ball" data-emoji="confetti_ball"></div></div><div class="emoji-row"><div class="emoji-block" title="balloon" data-emoji="balloon"></div><div class="emoji-block" title="crystal_ball" data-emoji="crystal_ball"></div><div class="emoji-block" title="cd" data-emoji="cd"></div><div class="emoji-block" title="dvd" data-emoji="dvd"></div><div class="emoji-block" title="floppy_disk" data-emoji="floppy_disk"></div><div class="emoji-block" title="camera" data-emoji="camera"></div><div class="emoji-block" title="video_camera" data-emoji="video_camera"></div><div class="emoji-block" title="movie_camera" data-emoji="movie_camera"></div><div class="emoji-block" title="computer" data-emoji="computer"></div><div class="emoji-block" title="tv" data-emoji="tv"></div><div class="emoji-block" title="iphone" data-emoji="iphone"></div><div class="emoji-block" title="phone" data-emoji="phone"></div><div class="emoji-block" title="telephone" data-emoji="telephone"></div><div class="emoji-block" title="telephone_receiver" data-emoji="telephone_receiver"></div><div class="emoji-block" title="pager" data-emoji="pager"></div><div class="emoji-block" title="fax" data-emoji="fax"></div><div class="emoji-block" title="minidisc" data-emoji="minidisc"></div><div class="emoji-block" title="vhs" data-emoji="vhs"></div><div class="emoji-block" title="sound" data-emoji="sound"></div><div class="emoji-block" title="speaker" data-emoji="speaker"></div></div><div class="emoji-row"><div class="emoji-block" title="mute" data-emoji="mute"></div><div class="emoji-block" title="loudspeaker" data-emoji="loudspeaker"></div><div class="emoji-block" title="mega" data-emoji="mega"></div><div class="emoji-block" title="hourglass" data-emoji="hourglass"></div><div class="emoji-block" title="hourglass_flowing_sand" data-emoji="hourglass_flowing_sand"></div><div class="emoji-block" title="alarm_clock" data-emoji="alarm_clock"></div><div class="emoji-block" title="watch" data-emoji="watch"></div><div class="emoji-block" title="radio" data-emoji="radio"></div><div class="emoji-block" title="satellite" data-emoji="satellite"></div><div class="emoji-block" title="loop" data-emoji="loop"></div><div class="emoji-block" title="mag" data-emoji="mag"></div><div class="emoji-block" title="mag_right" data-emoji="mag_right"></div><div class="emoji-block" title="unlock" data-emoji="unlock"></div><div class="emoji-block" title="lock" data-emoji="lock"></div><div class="emoji-block" title="lock_with_ink_pen" data-emoji="lock_with_ink_pen"></div><div class="emoji-block" title="closed_lock_with_key" data-emoji="closed_lock_with_key"></div><div class="emoji-block" title="key" data-emoji="key"></div><div class="emoji-block" title="bulb" data-emoji="bulb"></div><div class="emoji-block" title="flashlight" data-emoji="flashlight"></div><div class="emoji-block" title="high_brightness" data-emoji="high_brightness"></div></div><div class="emoji-row"><div class="emoji-block" title="low_brightness" data-emoji="low_brightness"></div><div class="emoji-block" title="electric_plug" data-emoji="electric_plug"></div><div class="emoji-block" title="battery" data-emoji="battery"></div><div class="emoji-block" title="calling" data-emoji="calling"></div><div class="emoji-block" title="email" data-emoji="email"></div><div class="emoji-block" title="mailbox" data-emoji="mailbox"></div><div class="emoji-block" title="postbox" data-emoji="postbox"></div><div class="emoji-block" title="bath" data-emoji="bath"></div><div class="emoji-block" title="bathtub" data-emoji="bathtub"></div><div class="emoji-block" title="shower" data-emoji="shower"></div><div class="emoji-block" title="toilet" data-emoji="toilet"></div><div class="emoji-block" title="wrench" data-emoji="wrench"></div><div class="emoji-block" title="nut_and_bolt" data-emoji="nut_and_bolt"></div><div class="emoji-block" title="hammer" data-emoji="hammer"></div><div class="emoji-block" title="seat" data-emoji="seat"></div><div class="emoji-block" title="moneybag" data-emoji="moneybag"></div><div class="emoji-block" title="yen" data-emoji="yen"></div><div class="emoji-block" title="dollar" data-emoji="dollar"></div><div class="emoji-block" title="pound" data-emoji="pound"></div><div class="emoji-block" title="euro" data-emoji="euro"></div></div><div class="emoji-row"><div class="emoji-block" title="credit_card" data-emoji="credit_card"></div><div class="emoji-block" title="money_with_wings" data-emoji="money_with_wings"></div><div class="emoji-block" title="e-mail" data-emoji="e-mail"></div><div class="emoji-block" title="inbox_tray" data-emoji="inbox_tray"></div><div class="emoji-block" title="outbox_tray" data-emoji="outbox_tray"></div><div class="emoji-block" title="envelope" data-emoji="envelope"></div><div class="emoji-block" title="incoming_envelope" data-emoji="incoming_envelope"></div><div class="emoji-block" title="postal_horn" data-emoji="postal_horn"></div><div class="emoji-block" title="mailbox_closed" data-emoji="mailbox_closed"></div><div class="emoji-block" title="mailbox_with_mail" data-emoji="mailbox_with_mail"></div><div class="emoji-block" title="mailbox_with_no_mail" data-emoji="mailbox_with_no_mail"></div><div class="emoji-block" title="package" data-emoji="package"></div><div class="emoji-block" title="door" data-emoji="door"></div><div class="emoji-block" title="smoking" data-emoji="smoking"></div><div class="emoji-block" title="bomb" data-emoji="bomb"></div><div class="emoji-block" title="gun" data-emoji="gun"></div><div class="emoji-block" title="hocho" data-emoji="hocho"></div><div class="emoji-block" title="pill" data-emoji="pill"></div><div class="emoji-block" title="syringe" data-emoji="syringe"></div><div class="emoji-block" title="page_facing_up" data-emoji="page_facing_up"></div></div><div class="emoji-row"><div class="emoji-block" title="page_with_curl" data-emoji="page_with_curl"></div><div class="emoji-block" title="bookmark_tabs" data-emoji="bookmark_tabs"></div><div class="emoji-block" title="bar_chart" data-emoji="bar_chart"></div><div class="emoji-block" title="chart_with_upwards_trend" data-emoji="chart_with_upwards_trend"></div><div class="emoji-block" title="chart_with_downwards_trend" data-emoji="chart_with_downwards_trend"></div><div class="emoji-block" title="scroll" data-emoji="scroll"></div><div class="emoji-block" title="clipboard" data-emoji="clipboard"></div><div class="emoji-block" title="calendar" data-emoji="calendar"></div><div class="emoji-block" title="date" data-emoji="date"></div><div class="emoji-block" title="card_index" data-emoji="card_index"></div><div class="emoji-block" title="file_folder" data-emoji="file_folder"></div><div class="emoji-block" title="open_file_folder" data-emoji="open_file_folder"></div><div class="emoji-block" title="scissors" data-emoji="scissors"></div><div class="emoji-block" title="pushpin" data-emoji="pushpin"></div><div class="emoji-block" title="paperclip" data-emoji="paperclip"></div><div class="emoji-block" title="black_nib" data-emoji="black_nib"></div><div class="emoji-block" title="pencil2" data-emoji="pencil2"></div><div class="emoji-block" title="straight_ruler" data-emoji="straight_ruler"></div><div class="emoji-block" title="triangular_ruler" data-emoji="triangular_ruler"></div><div class="emoji-block" title="closed_book" data-emoji="closed_book"></div></div><div class="emoji-row"><div class="emoji-block" title="green_book" data-emoji="green_book"></div><div class="emoji-block" title="blue_book" data-emoji="blue_book"></div><div class="emoji-block" title="orange_book" data-emoji="orange_book"></div><div class="emoji-block" title="notebook" data-emoji="notebook"></div><div class="emoji-block" title="notebook_with_decorative_cover" data-emoji="notebook_with_decorative_cover"></div><div class="emoji-block" title="ledger" data-emoji="ledger"></div><div class="emoji-block" title="books" data-emoji="books"></div><div class="emoji-block" title="bookmark" data-emoji="bookmark"></div><div class="emoji-block" title="name_badge" data-emoji="name_badge"></div><div class="emoji-block" title="microscope" data-emoji="microscope"></div><div class="emoji-block" title="telescope" data-emoji="telescope"></div><div class="emoji-block" title="newspaper" data-emoji="newspaper"></div><div class="emoji-block" title="football" data-emoji="football"></div><div class="emoji-block" title="basketball" data-emoji="basketball"></div><div class="emoji-block" title="soccer" data-emoji="soccer"></div><div class="emoji-block" title="baseball" data-emoji="baseball"></div><div class="emoji-block" title="tennis" data-emoji="tennis"></div><div class="emoji-block" title="8ball" data-emoji="8ball"></div><div class="emoji-block" title="rugby_football" data-emoji="rugby_football"></div><div class="emoji-block" title="bowling" data-emoji="bowling"></div></div><div class="emoji-row"><div class="emoji-block" title="golf" data-emoji="golf"></div><div class="emoji-block" title="mountain_bicyclist" data-emoji="mountain_bicyclist"></div><div class="emoji-block" title="bicyclist" data-emoji="bicyclist"></div><div class="emoji-block" title="horse_racing" data-emoji="horse_racing"></div><div class="emoji-block" title="snowboarder" data-emoji="snowboarder"></div><div class="emoji-block" title="swimmer" data-emoji="swimmer"></div><div class="emoji-block" title="surfer" data-emoji="surfer"></div><div class="emoji-block" title="ski" data-emoji="ski"></div><div class="emoji-block" title="spades" data-emoji="spades"></div><div class="emoji-block" title="hearts" data-emoji="hearts"></div><div class="emoji-block" title="clubs" data-emoji="clubs"></div><div class="emoji-block" title="diamonds" data-emoji="diamonds"></div><div class="emoji-block" title="gem" data-emoji="gem"></div><div class="emoji-block" title="ring" data-emoji="ring"></div><div class="emoji-block" title="trophy" data-emoji="trophy"></div><div class="emoji-block" title="musical_score" data-emoji="musical_score"></div><div class="emoji-block" title="musical_keyboard" data-emoji="musical_keyboard"></div><div class="emoji-block" title="violin" data-emoji="violin"></div><div class="emoji-block" title="space_invader" data-emoji="space_invader"></div><div class="emoji-block" title="video_game" data-emoji="video_game"></div></div><div class="emoji-row"><div class="emoji-block" title="black_joker" data-emoji="black_joker"></div><div class="emoji-block" title="flower_playing_cards" data-emoji="flower_playing_cards"></div><div class="emoji-block" title="game_die" data-emoji="game_die"></div><div class="emoji-block" title="dart" data-emoji="dart"></div><div class="emoji-block" title="mahjong" data-emoji="mahjong"></div><div class="emoji-block" title="clapper" data-emoji="clapper"></div><div class="emoji-block" title="memo" data-emoji="memo"></div><div class="emoji-block" title="pencil" data-emoji="pencil"></div><div class="emoji-block" title="book" data-emoji="book"></div><div class="emoji-block" title="art" data-emoji="art"></div><div class="emoji-block" title="microphone" data-emoji="microphone"></div><div class="emoji-block" title="headphones" data-emoji="headphones"></div><div class="emoji-block" title="trumpet" data-emoji="trumpet"></div><div class="emoji-block" title="saxophone" data-emoji="saxophone"></div><div class="emoji-block" title="guitar" data-emoji="guitar"></div><div class="emoji-block" title="shoe" data-emoji="shoe"></div><div class="emoji-block" title="sandal" data-emoji="sandal"></div><div class="emoji-block" title="high_heel" data-emoji="high_heel"></div><div class="emoji-block" title="lipstick" data-emoji="lipstick"></div><div class="emoji-block" title="boot" data-emoji="boot"></div></div><div class="emoji-row"><div class="emoji-block" title="shirt" data-emoji="shirt"></div><div class="emoji-block" title="tshirt" data-emoji="tshirt"></div><div class="emoji-block" title="necktie" data-emoji="necktie"></div><div class="emoji-block" title="womans_clothes" data-emoji="womans_clothes"></div><div class="emoji-block" title="dress" data-emoji="dress"></div><div class="emoji-block" title="running_shirt_with_sash" data-emoji="running_shirt_with_sash"></div><div class="emoji-block" title="jeans" data-emoji="jeans"></div><div class="emoji-block" title="kimono" data-emoji="kimono"></div><div class="emoji-block" title="bikini" data-emoji="bikini"></div><div class="emoji-block" title="ribbon" data-emoji="ribbon"></div><div class="emoji-block" title="tophat" data-emoji="tophat"></div><div class="emoji-block" title="crown" data-emoji="crown"></div><div class="emoji-block" title="womans_hat" data-emoji="womans_hat"></div><div class="emoji-block" title="mans_shoe" data-emoji="mans_shoe"></div><div class="emoji-block" title="closed_umbrella" data-emoji="closed_umbrella"></div><div class="emoji-block" title="briefcase" data-emoji="briefcase"></div><div class="emoji-block" title="handbag" data-emoji="handbag"></div><div class="emoji-block" title="pouch" data-emoji="pouch"></div><div class="emoji-block" title="purse" data-emoji="purse"></div><div class="emoji-block" title="eyeglasses" data-emoji="eyeglasses"></div></div><div class="emoji-row"><div class="emoji-block" title="fishing_pole_and_fish" data-emoji="fishing_pole_and_fish"></div><div class="emoji-block" title="coffee" data-emoji="coffee"></div><div class="emoji-block" title="tea" data-emoji="tea"></div><div class="emoji-block" title="sake" data-emoji="sake"></div><div class="emoji-block" title="baby_bottle" data-emoji="baby_bottle"></div><div class="emoji-block" title="beer" data-emoji="beer"></div><div class="emoji-block" title="beers" data-emoji="beers"></div><div class="emoji-block" title="cocktail" data-emoji="cocktail"></div><div class="emoji-block" title="tropical_drink" data-emoji="tropical_drink"></div><div class="emoji-block" title="wine_glass" data-emoji="wine_glass"></div><div class="emoji-block" title="fork_and_knife" data-emoji="fork_and_knife"></div><div class="emoji-block" title="pizza" data-emoji="pizza"></div><div class="emoji-block" title="hamburger" data-emoji="hamburger"></div><div class="emoji-block" title="fries" data-emoji="fries"></div><div class="emoji-block" title="poultry_leg" data-emoji="poultry_leg"></div><div class="emoji-block" title="meat_on_bone" data-emoji="meat_on_bone"></div><div class="emoji-block" title="spaghetti" data-emoji="spaghetti"></div><div class="emoji-block" title="curry" data-emoji="curry"></div><div class="emoji-block" title="fried_shrimp" data-emoji="fried_shrimp"></div><div class="emoji-block" title="bento" data-emoji="bento"></div></div><div class="emoji-row"><div class="emoji-block" title="sushi" data-emoji="sushi"></div><div class="emoji-block" title="fish_cake" data-emoji="fish_cake"></div><div class="emoji-block" title="rice_ball" data-emoji="rice_ball"></div><div class="emoji-block" title="rice_cracker" data-emoji="rice_cracker"></div><div class="emoji-block" title="rice" data-emoji="rice"></div><div class="emoji-block" title="ramen" data-emoji="ramen"></div><div class="emoji-block" title="stew" data-emoji="stew"></div><div class="emoji-block" title="oden" data-emoji="oden"></div><div class="emoji-block" title="dango" data-emoji="dango"></div><div class="emoji-block" title="egg" data-emoji="egg"></div><div class="emoji-block" title="bread" data-emoji="bread"></div><div class="emoji-block" title="doughnut" data-emoji="doughnut"></div><div class="emoji-block" title="custard" data-emoji="custard"></div><div class="emoji-block" title="icecream" data-emoji="icecream"></div><div class="emoji-block" title="ice_cream" data-emoji="ice_cream"></div><div class="emoji-block" title="shaved_ice" data-emoji="shaved_ice"></div><div class="emoji-block" title="birthday" data-emoji="birthday"></div><div class="emoji-block" title="cake" data-emoji="cake"></div><div class="emoji-block" title="cookie" data-emoji="cookie"></div><div class="emoji-block" title="chocolate_bar" data-emoji="chocolate_bar"></div></div><div class="emoji-row"><div class="emoji-block" title="candy" data-emoji="candy"></div><div class="emoji-block" title="lollipop" data-emoji="lollipop"></div><div class="emoji-block" title="honey_pot" data-emoji="honey_pot"></div><div class="emoji-block" title="apple" data-emoji="apple"></div><div class="emoji-block" title="green_apple" data-emoji="green_apple"></div><div class="emoji-block" title="tangerine" data-emoji="tangerine"></div><div class="emoji-block" title="lemon" data-emoji="lemon"></div><div class="emoji-block" title="cherries" data-emoji="cherries"></div><div class="emoji-block" title="grapes" data-emoji="grapes"></div><div class="emoji-block" title="watermelon" data-emoji="watermelon"></div><div class="emoji-block" title="strawberry" data-emoji="strawberry"></div><div class="emoji-block" title="peach" data-emoji="peach"></div><div class="emoji-block" title="melon" data-emoji="melon"></div><div class="emoji-block" title="banana" data-emoji="banana"></div><div class="emoji-block" title="pear" data-emoji="pear"></div><div class="emoji-block" title="pineapple" data-emoji="pineapple"></div><div class="emoji-block" title="sweet_potato" data-emoji="sweet_potato"></div><div class="emoji-block" title="eggplant" data-emoji="eggplant"></div><div class="emoji-block" title="tomato" data-emoji="tomato"></div><div class="emoji-block" title="corn" data-emoji="corn"></div></div></div></div>
                                        <div data-emoji-item="Places"><div data-group="Places"><div data-group-title="emoji-group-title" style="display: none;">Places</div><div class="emoji-row"><div class="emoji-block" title="house" data-emoji="house"></div><div class="emoji-block" title="house_with_garden" data-emoji="house_with_garden"></div><div class="emoji-block" title="school" data-emoji="school"></div><div class="emoji-block" title="office" data-emoji="office"></div><div class="emoji-block" title="post_office" data-emoji="post_office"></div><div class="emoji-block" title="hospital" data-emoji="hospital"></div><div class="emoji-block" title="bank" data-emoji="bank"></div><div class="emoji-block" title="convenience_store" data-emoji="convenience_store"></div><div class="emoji-block" title="love_hotel" data-emoji="love_hotel"></div><div class="emoji-block" title="hotel" data-emoji="hotel"></div><div class="emoji-block" title="wedding" data-emoji="wedding"></div><div class="emoji-block" title="church" data-emoji="church"></div><div class="emoji-block" title="department_store" data-emoji="department_store"></div><div class="emoji-block" title="european_post_office" data-emoji="european_post_office"></div><div class="emoji-block" title="city_sunrise" data-emoji="city_sunrise"></div><div class="emoji-block" title="city_sunset" data-emoji="city_sunset"></div><div class="emoji-block" title="japanese_castle" data-emoji="japanese_castle"></div><div class="emoji-block" title="european_castle" data-emoji="european_castle"></div><div class="emoji-block" title="tent" data-emoji="tent"></div><div class="emoji-block" title="factory" data-emoji="factory"></div></div><div class="emoji-row"><div class="emoji-block" title="tokyo_tower" data-emoji="tokyo_tower"></div><div class="emoji-block" title="japan" data-emoji="japan"></div><div class="emoji-block" title="mount_fuji" data-emoji="mount_fuji"></div><div class="emoji-block" title="sunrise_over_mountains" data-emoji="sunrise_over_mountains"></div><div class="emoji-block" title="sunrise" data-emoji="sunrise"></div><div class="emoji-block" title="stars" data-emoji="stars"></div><div class="emoji-block" title="statue_of_liberty" data-emoji="statue_of_liberty"></div><div class="emoji-block" title="bridge_at_night" data-emoji="bridge_at_night"></div><div class="emoji-block" title="carousel_horse" data-emoji="carousel_horse"></div><div class="emoji-block" title="rainbow" data-emoji="rainbow"></div><div class="emoji-block" title="ferris_wheel" data-emoji="ferris_wheel"></div><div class="emoji-block" title="fountain" data-emoji="fountain"></div><div class="emoji-block" title="roller_coaster" data-emoji="roller_coaster"></div><div class="emoji-block" title="ship" data-emoji="ship"></div><div class="emoji-block" title="speedboat" data-emoji="speedboat"></div><div class="emoji-block" title="boat" data-emoji="boat"></div><div class="emoji-block" title="sailboat" data-emoji="sailboat"></div><div class="emoji-block" title="rowboat" data-emoji="rowboat"></div><div class="emoji-block" title="anchor" data-emoji="anchor"></div><div class="emoji-block" title="rocket" data-emoji="rocket"></div></div><div class="emoji-row"><div class="emoji-block" title="airplane" data-emoji="airplane"></div><div class="emoji-block" title="helicopter" data-emoji="helicopter"></div><div class="emoji-block" title="steam_locomotive" data-emoji="steam_locomotive"></div><div class="emoji-block" title="tram" data-emoji="tram"></div><div class="emoji-block" title="mountain_railway" data-emoji="mountain_railway"></div><div class="emoji-block" title="bike" data-emoji="bike"></div><div class="emoji-block" title="aerial_tramway" data-emoji="aerial_tramway"></div><div class="emoji-block" title="suspension_railway" data-emoji="suspension_railway"></div><div class="emoji-block" title="mountain_cableway" data-emoji="mountain_cableway"></div><div class="emoji-block" title="tractor" data-emoji="tractor"></div><div class="emoji-block" title="blue_car" data-emoji="blue_car"></div><div class="emoji-block" title="oncoming_automobile" data-emoji="oncoming_automobile"></div><div class="emoji-block" title="car" data-emoji="car"></div><div class="emoji-block" title="red_car" data-emoji="red_car"></div><div class="emoji-block" title="taxi" data-emoji="taxi"></div><div class="emoji-block" title="oncoming_taxi" data-emoji="oncoming_taxi"></div><div class="emoji-block" title="articulated_lorry" data-emoji="articulated_lorry"></div><div class="emoji-block" title="bus" data-emoji="bus"></div><div class="emoji-block" title="oncoming_bus" data-emoji="oncoming_bus"></div><div class="emoji-block" title="rotating_light" data-emoji="rotating_light"></div></div><div class="emoji-row"><div class="emoji-block" title="police_car" data-emoji="police_car"></div><div class="emoji-block" title="oncoming_police_car" data-emoji="oncoming_police_car"></div><div class="emoji-block" title="fire_engine" data-emoji="fire_engine"></div><div class="emoji-block" title="ambulance" data-emoji="ambulance"></div><div class="emoji-block" title="minibus" data-emoji="minibus"></div><div class="emoji-block" title="truck" data-emoji="truck"></div><div class="emoji-block" title="train" data-emoji="train"></div><div class="emoji-block" title="station" data-emoji="station"></div><div class="emoji-block" title="train2" data-emoji="train2"></div><div class="emoji-block" title="bullettrain_front" data-emoji="bullettrain_front"></div><div class="emoji-block" title="bullettrain_side" data-emoji="bullettrain_side"></div><div class="emoji-block" title="light_rail" data-emoji="light_rail"></div><div class="emoji-block" title="monorail" data-emoji="monorail"></div><div class="emoji-block" title="railway_car" data-emoji="railway_car"></div><div class="emoji-block" title="trolleybus" data-emoji="trolleybus"></div><div class="emoji-block" title="ticket" data-emoji="ticket"></div><div class="emoji-block" title="fuelpump" data-emoji="fuelpump"></div><div class="emoji-block" title="vertical_traffic_light" data-emoji="vertical_traffic_light"></div><div class="emoji-block" title="traffic_light" data-emoji="traffic_light"></div><div class="emoji-block" title="warning" data-emoji="warning"></div></div><div class="emoji-row"><div class="emoji-block" title="construction" data-emoji="construction"></div><div class="emoji-block" title="beginner" data-emoji="beginner"></div><div class="emoji-block" title="atm" data-emoji="atm"></div><div class="emoji-block" title="slot_machine" data-emoji="slot_machine"></div><div class="emoji-block" title="busstop" data-emoji="busstop"></div><div class="emoji-block" title="barber" data-emoji="barber"></div><div class="emoji-block" title="hotsprings" data-emoji="hotsprings"></div><div class="emoji-block" title="checkered_flag" data-emoji="checkered_flag"></div><div class="emoji-block" title="crossed_flags" data-emoji="crossed_flags"></div><div class="emoji-block" title="izakaya_lantern" data-emoji="izakaya_lantern"></div><div class="emoji-block" title="moyai" data-emoji="moyai"></div><div class="emoji-block" title="circus_tent" data-emoji="circus_tent"></div><div class="emoji-block" title="performing_arts" data-emoji="performing_arts"></div><div class="emoji-block" title="round_pushpin" data-emoji="round_pushpin"></div><div class="emoji-block" title="triangular_flag_on_post" data-emoji="triangular_flag_on_post"></div><div class="emoji-block" title="jp" data-emoji="jp"></div><div class="emoji-block" title="kr" data-emoji="kr"></div><div class="emoji-block" title="cn" data-emoji="cn"></div><div class="emoji-block" title="us" data-emoji="us"></div><div class="emoji-block" title="fr" data-emoji="fr"></div></div><div class="emoji-row"><div class="emoji-block" title="es" data-emoji="es"></div><div class="emoji-block" title="it" data-emoji="it"></div><div class="emoji-block" title="ru" data-emoji="ru"></div><div class="emoji-block" title="gb" data-emoji="gb"></div><div class="emoji-block" title="uk" data-emoji="uk"></div><div class="emoji-block" title="de" data-emoji="de"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div></div></div></div>
                                        <div data-emoji-item="Symbols"><div data-group="Symbols"><div data-group-title="emoji-group-title" style="display: none;">Symbols</div><div class="emoji-row"><div class="emoji-block" title="one" data-emoji="one"></div><div class="emoji-block" title="two" data-emoji="two"></div><div class="emoji-block" title="three" data-emoji="three"></div><div class="emoji-block" title="four" data-emoji="four"></div><div class="emoji-block" title="five" data-emoji="five"></div><div class="emoji-block" title="six" data-emoji="six"></div><div class="emoji-block" title="seven" data-emoji="seven"></div><div class="emoji-block" title="eight" data-emoji="eight"></div><div class="emoji-block" title="nine" data-emoji="nine"></div><div class="emoji-block" title="keycap_ten" data-emoji="keycap_ten"></div><div class="emoji-block" title="1234" data-emoji="1234"></div><div class="emoji-block" title="zero" data-emoji="zero"></div><div class="emoji-block" title="hash" data-emoji="hash"></div><div class="emoji-block" title="symbols" data-emoji="symbols"></div><div class="emoji-block" title="arrow_backward" data-emoji="arrow_backward"></div><div class="emoji-block" title="arrow_down" data-emoji="arrow_down"></div><div class="emoji-block" title="arrow_forward" data-emoji="arrow_forward"></div><div class="emoji-block" title="arrow_left" data-emoji="arrow_left"></div><div class="emoji-block" title="capital_abcd" data-emoji="capital_abcd"></div><div class="emoji-block" title="abcd" data-emoji="abcd"></div></div><div class="emoji-row"><div class="emoji-block" title="abc" data-emoji="abc"></div><div class="emoji-block" title="arrow_lower_left" data-emoji="arrow_lower_left"></div><div class="emoji-block" title="arrow_lower_right" data-emoji="arrow_lower_right"></div><div class="emoji-block" title="arrow_right" data-emoji="arrow_right"></div><div class="emoji-block" title="arrow_up" data-emoji="arrow_up"></div><div class="emoji-block" title="arrow_upper_left" data-emoji="arrow_upper_left"></div><div class="emoji-block" title="arrow_upper_right" data-emoji="arrow_upper_right"></div><div class="emoji-block" title="arrow_double_down" data-emoji="arrow_double_down"></div><div class="emoji-block" title="arrow_double_up" data-emoji="arrow_double_up"></div><div class="emoji-block" title="arrow_down_small" data-emoji="arrow_down_small"></div><div class="emoji-block" title="arrow_heading_down" data-emoji="arrow_heading_down"></div><div class="emoji-block" title="arrow_heading_up" data-emoji="arrow_heading_up"></div><div class="emoji-block" title="leftwards_arrow_with_hook" data-emoji="leftwards_arrow_with_hook"></div><div class="emoji-block" title="arrow_right_hook" data-emoji="arrow_right_hook"></div><div class="emoji-block" title="left_right_arrow" data-emoji="left_right_arrow"></div><div class="emoji-block" title="arrow_up_down" data-emoji="arrow_up_down"></div><div class="emoji-block" title="arrow_up_small" data-emoji="arrow_up_small"></div><div class="emoji-block" title="arrows_clockwise" data-emoji="arrows_clockwise"></div><div class="emoji-block" title="arrows_counterclockwise" data-emoji="arrows_counterclockwise"></div><div class="emoji-block" title="rewind" data-emoji="rewind"></div></div><div class="emoji-row"><div class="emoji-block" title="fast_forward" data-emoji="fast_forward"></div><div class="emoji-block" title="information_source" data-emoji="information_source"></div><div class="emoji-block" title="ok" data-emoji="ok"></div><div class="emoji-block" title="twisted_rightwards_arrows" data-emoji="twisted_rightwards_arrows"></div><div class="emoji-block" title="repeat" data-emoji="repeat"></div><div class="emoji-block" title="repeat_one" data-emoji="repeat_one"></div><div class="emoji-block" title="new" data-emoji="new"></div><div class="emoji-block" title="top" data-emoji="top"></div><div class="emoji-block" title="up" data-emoji="up"></div><div class="emoji-block" title="cool" data-emoji="cool"></div><div class="emoji-block" title="free" data-emoji="free"></div><div class="emoji-block" title="ng" data-emoji="ng"></div><div class="emoji-block" title="cinema" data-emoji="cinema"></div><div class="emoji-block" title="koko" data-emoji="koko"></div><div class="emoji-block" title="signal_strength" data-emoji="signal_strength"></div><div class="emoji-block" title="u5272" data-emoji="u5272"></div><div class="emoji-block" title="u5408" data-emoji="u5408"></div><div class="emoji-block" title="u55b6" data-emoji="u55b6"></div><div class="emoji-block" title="u6307" data-emoji="u6307"></div><div class="emoji-block" title="u6708" data-emoji="u6708"></div></div><div class="emoji-row"><div class="emoji-block" title="u6709" data-emoji="u6709"></div><div class="emoji-block" title="u6e80" data-emoji="u6e80"></div><div class="emoji-block" title="u7121" data-emoji="u7121"></div><div class="emoji-block" title="u7533" data-emoji="u7533"></div><div class="emoji-block" title="u7a7a" data-emoji="u7a7a"></div><div class="emoji-block" title="u7981" data-emoji="u7981"></div><div class="emoji-block" title="sa" data-emoji="sa"></div><div class="emoji-block" title="restroom" data-emoji="restroom"></div><div class="emoji-block" title="mens" data-emoji="mens"></div><div class="emoji-block" title="womens" data-emoji="womens"></div><div class="emoji-block" title="baby_symbol" data-emoji="baby_symbol"></div><div class="emoji-block" title="no_smoking" data-emoji="no_smoking"></div><div class="emoji-block" title="parking" data-emoji="parking"></div><div class="emoji-block" title="wheelchair" data-emoji="wheelchair"></div><div class="emoji-block" title="metro" data-emoji="metro"></div><div class="emoji-block" title="baggage_claim" data-emoji="baggage_claim"></div><div class="emoji-block" title="accept" data-emoji="accept"></div><div class="emoji-block" title="wc" data-emoji="wc"></div><div class="emoji-block" title="potable_water" data-emoji="potable_water"></div><div class="emoji-block" title="put_litter_in_its_place" data-emoji="put_litter_in_its_place"></div></div><div class="emoji-row"><div class="emoji-block" title="secret" data-emoji="secret"></div><div class="emoji-block" title="congratulations" data-emoji="congratulations"></div><div class="emoji-block" title="m" data-emoji="m"></div><div class="emoji-block" title="passport_control" data-emoji="passport_control"></div><div class="emoji-block" title="left_luggage" data-emoji="left_luggage"></div><div class="emoji-block" title="customs" data-emoji="customs"></div><div class="emoji-block" title="ideograph_advantage" data-emoji="ideograph_advantage"></div><div class="emoji-block" title="cl" data-emoji="cl"></div><div class="emoji-block" title="sos" data-emoji="sos"></div><div class="emoji-block" title="id" data-emoji="id"></div><div class="emoji-block" title="no_entry_sign" data-emoji="no_entry_sign"></div><div class="emoji-block" title="underage" data-emoji="underage"></div><div class="emoji-block" title="no_mobile_phones" data-emoji="no_mobile_phones"></div><div class="emoji-block" title="do_not_litter" data-emoji="do_not_litter"></div><div class="emoji-block" title="non-potable_water" data-emoji="non-potable_water"></div><div class="emoji-block" title="no_bicycles" data-emoji="no_bicycles"></div><div class="emoji-block" title="no_pedestrians" data-emoji="no_pedestrians"></div><div class="emoji-block" title="children_crossing" data-emoji="children_crossing"></div><div class="emoji-block" title="no_entry" data-emoji="no_entry"></div><div class="emoji-block" title="eight_spoked_asterisk" data-emoji="eight_spoked_asterisk"></div></div><div class="emoji-row"><div class="emoji-block" title="sparkle" data-emoji="sparkle"></div><div class="emoji-block" title="eight_pointed_black_star" data-emoji="eight_pointed_black_star"></div><div class="emoji-block" title="heart_decoration" data-emoji="heart_decoration"></div><div class="emoji-block" title="vs" data-emoji="vs"></div><div class="emoji-block" title="vibration_mode" data-emoji="vibration_mode"></div><div class="emoji-block" title="mobile_phone_off" data-emoji="mobile_phone_off"></div><div class="emoji-block" title="chart" data-emoji="chart"></div><div class="emoji-block" title="currency_exchange" data-emoji="currency_exchange"></div><div class="emoji-block" title="aries" data-emoji="aries"></div><div class="emoji-block" title="taurus" data-emoji="taurus"></div><div class="emoji-block" title="gemini" data-emoji="gemini"></div><div class="emoji-block" title="cancer" data-emoji="cancer"></div><div class="emoji-block" title="leo" data-emoji="leo"></div><div class="emoji-block" title="virgo" data-emoji="virgo"></div><div class="emoji-block" title="libra" data-emoji="libra"></div><div class="emoji-block" title="scorpius" data-emoji="scorpius"></div><div class="emoji-block" title="sagittarius" data-emoji="sagittarius"></div><div class="emoji-block" title="capricorn" data-emoji="capricorn"></div><div class="emoji-block" title="aquarius" data-emoji="aquarius"></div><div class="emoji-block" title="pisces" data-emoji="pisces"></div></div><div class="emoji-row"><div class="emoji-block" title="ophiuchus" data-emoji="ophiuchus"></div><div class="emoji-block" title="six_pointed_star" data-emoji="six_pointed_star"></div><div class="emoji-block" title="negative_squared_cross_mark" data-emoji="negative_squared_cross_mark"></div><div class="emoji-block" title="a" data-emoji="a"></div><div class="emoji-block" title="b" data-emoji="b"></div><div class="emoji-block" title="ab" data-emoji="ab"></div><div class="emoji-block" title="o2" data-emoji="o2"></div><div class="emoji-block" title="diamond_shape_with_a_dot_inside" data-emoji="diamond_shape_with_a_dot_inside"></div><div class="emoji-block" title="recycle" data-emoji="recycle"></div><div class="emoji-block" title="end" data-emoji="end"></div><div class="emoji-block" title="back" data-emoji="back"></div><div class="emoji-block" title="on" data-emoji="on"></div><div class="emoji-block" title="soon" data-emoji="soon"></div><div class="emoji-block" title="clock1" data-emoji="clock1"></div><div class="emoji-block" title="clock130" data-emoji="clock130"></div><div class="emoji-block" title="clock10" data-emoji="clock10"></div><div class="emoji-block" title="clock1030" data-emoji="clock1030"></div><div class="emoji-block" title="clock11" data-emoji="clock11"></div><div class="emoji-block" title="clock1130" data-emoji="clock1130"></div><div class="emoji-block" title="clock12" data-emoji="clock12"></div></div><div class="emoji-row"><div class="emoji-block" title="clock1230" data-emoji="clock1230"></div><div class="emoji-block" title="clock2" data-emoji="clock2"></div><div class="emoji-block" title="clock230" data-emoji="clock230"></div><div class="emoji-block" title="clock3" data-emoji="clock3"></div><div class="emoji-block" title="clock330" data-emoji="clock330"></div><div class="emoji-block" title="clock4" data-emoji="clock4"></div><div class="emoji-block" title="clock430" data-emoji="clock430"></div><div class="emoji-block" title="clock5" data-emoji="clock5"></div><div class="emoji-block" title="clock530" data-emoji="clock530"></div><div class="emoji-block" title="clock6" data-emoji="clock6"></div><div class="emoji-block" title="clock630" data-emoji="clock630"></div><div class="emoji-block" title="clock7" data-emoji="clock7"></div><div class="emoji-block" title="clock730" data-emoji="clock730"></div><div class="emoji-block" title="clock8" data-emoji="clock8"></div><div class="emoji-block" title="clock830" data-emoji="clock830"></div><div class="emoji-block" title="clock9" data-emoji="clock9"></div><div class="emoji-block" title="clock930" data-emoji="clock930"></div><div class="emoji-block" title="heavy_dollar_sign" data-emoji="heavy_dollar_sign"></div><div class="emoji-block" title="copyright" data-emoji="copyright"></div><div class="emoji-block" title="registered" data-emoji="registered"></div></div><div class="emoji-row"><div class="emoji-block" title="tm" data-emoji="tm"></div><div class="emoji-block" title="x" data-emoji="x"></div><div class="emoji-block" title="heavy_exclamation_mark" data-emoji="heavy_exclamation_mark"></div><div class="emoji-block" title="bangbang" data-emoji="bangbang"></div><div class="emoji-block" title="interrobang" data-emoji="interrobang"></div><div class="emoji-block" title="o" data-emoji="o"></div><div class="emoji-block" title="heavy_multiplication_x" data-emoji="heavy_multiplication_x"></div><div class="emoji-block" title="heavy_plus_sign" data-emoji="heavy_plus_sign"></div><div class="emoji-block" title="heavy_minus_sign" data-emoji="heavy_minus_sign"></div><div class="emoji-block" title="heavy_division_sign" data-emoji="heavy_division_sign"></div><div class="emoji-block" title="white_flower" data-emoji="white_flower"></div><div class="emoji-block" title="100" data-emoji="100"></div><div class="emoji-block" title="heavy_check_mark" data-emoji="heavy_check_mark"></div><div class="emoji-block" title="ballot_box_with_check" data-emoji="ballot_box_with_check"></div><div class="emoji-block" title="radio_button" data-emoji="radio_button"></div><div class="emoji-block" title="link" data-emoji="link"></div><div class="emoji-block" title="curly_loop" data-emoji="curly_loop"></div><div class="emoji-block" title="wavy_dash" data-emoji="wavy_dash"></div><div class="emoji-block" title="part_alternation_mark" data-emoji="part_alternation_mark"></div><div class="emoji-block" title="trident" data-emoji="trident"></div></div><div class="emoji-row"><div class="emoji-block" title="black_small_square" data-emoji="black_small_square"></div><div class="emoji-block" title="white_small_square" data-emoji="white_small_square"></div><div class="emoji-block" title="black_medium_small_square" data-emoji="black_medium_small_square"></div><div class="emoji-block" title="white_medium_small_square" data-emoji="white_medium_small_square"></div><div class="emoji-block" title="black_medium_square" data-emoji="black_medium_square"></div><div class="emoji-block" title="white_medium_square" data-emoji="white_medium_square"></div><div class="emoji-block" title="black_large_square" data-emoji="black_large_square"></div><div class="emoji-block" title="white_large_square" data-emoji="white_large_square"></div><div class="emoji-block" title="white_check_mark" data-emoji="white_check_mark"></div><div class="emoji-block" title="black_square_button" data-emoji="black_square_button"></div><div class="emoji-block" title="white_square_button" data-emoji="white_square_button"></div><div class="emoji-block" title="black_circle" data-emoji="black_circle"></div><div class="emoji-block" title="white_circle" data-emoji="white_circle"></div><div class="emoji-block" title="red_circle" data-emoji="red_circle"></div><div class="emoji-block" title="large_blue_circle" data-emoji="large_blue_circle"></div><div class="emoji-block" title="large_blue_diamond" data-emoji="large_blue_diamond"></div><div class="emoji-block" title="large_orange_diamond" data-emoji="large_orange_diamond"></div><div class="emoji-block" title="small_blue_diamond" data-emoji="small_blue_diamond"></div><div class="emoji-block" title="small_orange_diamond" data-emoji="small_orange_diamond"></div><div class="emoji-block" title="small_red_triangle" data-emoji="small_red_triangle"></div></div><div class="emoji-row"><div class="emoji-block" title="small_red_triangle_down" data-emoji="small_red_triangle_down"></div><div class="emoji-block" title="shipit" data-emoji="shipit"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div></div></div></div>
                                    </div>
                                </div>
                            </a>
                            <a href="javascript:page.insert_projects();" class="blog_soft">
                                <i class="icon-svg icon-project-hollow-gray"></i>
                            </a>
                            <span class="NoData" id="cmt_tip"></span>
                        </div>
                    </div>
                </div>
            </form>
                                                    </div>
    </div>
<div id="inline_reply_editor" style="display:none;">
    <div class="BlogCommentForm blog-comment-form">
        <form id="form_inline_comment" action="https://my.oschina.net/action/blog/add_comment?blog=361751" method="POST">
          <input type="hidden" id="inline_reply_id" name="reply_id" value="">
          <textarea name="content" id="ccom_content" "=""></textarea>
          <div class="layout">
              <div class="layout-right">
                <input type="button" value="关闭" class="btn btn-text" id="btn_close_inline_reply">
                <input type="submit" value="回复" id="btn_comment" class="btn btn-green"> 
              </div>
              <div class="layout-column">
                  插入：
                    <a href="javascript:;" class="blog_emotion">
                        <i class="icon-svg icon-emotions-hollow-gray"></i>
                        <div data-emoji="wrapper">
                            <ul data-emoji="nav">
                                <li data-emoji-nav="People" class="active">People</li>
                                <li data-emoji-nav="Nature">Nature</li>
                                <li data-emoji-nav="Objects">Objects</li>
                                <li data-emoji-nav="Places">Places</li>
                                <li data-emoji-nav="Symbols">Symbols</li>
                            </ul>
                            <div data-emoji="panel">
                                <div data-emoji-item="People" class="active"><div data-group="People"><div data-group-title="emoji-group-title" style="display: none;">People</div><div class="emoji-row"><div class="emoji-block" title="bowtie" data-emoji="bowtie"></div><div class="emoji-block" title="smile" data-emoji="smile"></div><div class="emoji-block" title="laughing" data-emoji="laughing"></div><div class="emoji-block" title="blush" data-emoji="blush"></div><div class="emoji-block" title="smiley" data-emoji="smiley"></div><div class="emoji-block" title="relaxed" data-emoji="relaxed"></div><div class="emoji-block" title="smirk" data-emoji="smirk"></div><div class="emoji-block" title="heart_eyes" data-emoji="heart_eyes"></div><div class="emoji-block" title="kissing_heart" data-emoji="kissing_heart"></div><div class="emoji-block" title="kissing_closed_eyes" data-emoji="kissing_closed_eyes"></div><div class="emoji-block" title="flushed" data-emoji="flushed"></div><div class="emoji-block" title="relieved" data-emoji="relieved"></div><div class="emoji-block" title="satisfied" data-emoji="satisfied"></div><div class="emoji-block" title="grin" data-emoji="grin"></div><div class="emoji-block" title="wink" data-emoji="wink"></div><div class="emoji-block" title="stuck_out_tongue_winking_eye" data-emoji="stuck_out_tongue_winking_eye"></div><div class="emoji-block" title="stuck_out_tongue_closed_eyes" data-emoji="stuck_out_tongue_closed_eyes"></div><div class="emoji-block" title="grinning" data-emoji="grinning"></div><div class="emoji-block" title="kissing" data-emoji="kissing"></div><div class="emoji-block" title="kissing_smiling_eyes" data-emoji="kissing_smiling_eyes"></div></div><div class="emoji-row"><div class="emoji-block" title="stuck_out_tongue" data-emoji="stuck_out_tongue"></div><div class="emoji-block" title="sleeping" data-emoji="sleeping"></div><div class="emoji-block" title="worried" data-emoji="worried"></div><div class="emoji-block" title="frowning" data-emoji="frowning"></div><div class="emoji-block" title="anguished" data-emoji="anguished"></div><div class="emoji-block" title="open_mouth" data-emoji="open_mouth"></div><div class="emoji-block" title="grimacing" data-emoji="grimacing"></div><div class="emoji-block" title="confused" data-emoji="confused"></div><div class="emoji-block" title="hushed" data-emoji="hushed"></div><div class="emoji-block" title="expressionless" data-emoji="expressionless"></div><div class="emoji-block" title="unamused" data-emoji="unamused"></div><div class="emoji-block" title="sweat_smile" data-emoji="sweat_smile"></div><div class="emoji-block" title="sweat" data-emoji="sweat"></div><div class="emoji-block" title="disappointed_relieved" data-emoji="disappointed_relieved"></div><div class="emoji-block" title="weary" data-emoji="weary"></div><div class="emoji-block" title="pensive" data-emoji="pensive"></div><div class="emoji-block" title="disappointed" data-emoji="disappointed"></div><div class="emoji-block" title="confounded" data-emoji="confounded"></div><div class="emoji-block" title="fearful" data-emoji="fearful"></div><div class="emoji-block" title="cold_sweat" data-emoji="cold_sweat"></div></div><div class="emoji-row"><div class="emoji-block" title="persevere" data-emoji="persevere"></div><div class="emoji-block" title="cry" data-emoji="cry"></div><div class="emoji-block" title="sob" data-emoji="sob"></div><div class="emoji-block" title="joy" data-emoji="joy"></div><div class="emoji-block" title="astonished" data-emoji="astonished"></div><div class="emoji-block" title="scream" data-emoji="scream"></div><div class="emoji-block" title="neckbeard" data-emoji="neckbeard"></div><div class="emoji-block" title="tired_face" data-emoji="tired_face"></div><div class="emoji-block" title="angry" data-emoji="angry"></div><div class="emoji-block" title="rage" data-emoji="rage"></div><div class="emoji-block" title="triumph" data-emoji="triumph"></div><div class="emoji-block" title="sleepy" data-emoji="sleepy"></div><div class="emoji-block" title="yum" data-emoji="yum"></div><div class="emoji-block" title="mask" data-emoji="mask"></div><div class="emoji-block" title="sunglasses" data-emoji="sunglasses"></div><div class="emoji-block" title="dizzy_face" data-emoji="dizzy_face"></div><div class="emoji-block" title="imp" data-emoji="imp"></div><div class="emoji-block" title="smiling_imp" data-emoji="smiling_imp"></div><div class="emoji-block" title="neutral_face" data-emoji="neutral_face"></div><div class="emoji-block" title="no_mouth" data-emoji="no_mouth"></div></div><div class="emoji-row"><div class="emoji-block" title="innocent" data-emoji="innocent"></div><div class="emoji-block" title="alien" data-emoji="alien"></div><div class="emoji-block" title="yellow_heart" data-emoji="yellow_heart"></div><div class="emoji-block" title="blue_heart" data-emoji="blue_heart"></div><div class="emoji-block" title="purple_heart" data-emoji="purple_heart"></div><div class="emoji-block" title="heart" data-emoji="heart"></div><div class="emoji-block" title="green_heart" data-emoji="green_heart"></div><div class="emoji-block" title="broken_heart" data-emoji="broken_heart"></div><div class="emoji-block" title="heartbeat" data-emoji="heartbeat"></div><div class="emoji-block" title="heartpulse" data-emoji="heartpulse"></div><div class="emoji-block" title="two_hearts" data-emoji="two_hearts"></div><div class="emoji-block" title="revolving_hearts" data-emoji="revolving_hearts"></div><div class="emoji-block" title="cupid" data-emoji="cupid"></div><div class="emoji-block" title="sparkling_heart" data-emoji="sparkling_heart"></div><div class="emoji-block" title="sparkles" data-emoji="sparkles"></div><div class="emoji-block" title="star" data-emoji="star"></div><div class="emoji-block" title="star2" data-emoji="star2"></div><div class="emoji-block" title="dizzy" data-emoji="dizzy"></div><div class="emoji-block" title="boom" data-emoji="boom"></div><div class="emoji-block" title="collision" data-emoji="collision"></div></div><div class="emoji-row"><div class="emoji-block" title="anger" data-emoji="anger"></div><div class="emoji-block" title="exclamation" data-emoji="exclamation"></div><div class="emoji-block" title="question" data-emoji="question"></div><div class="emoji-block" title="grey_exclamation" data-emoji="grey_exclamation"></div><div class="emoji-block" title="grey_question" data-emoji="grey_question"></div><div class="emoji-block" title="zzz" data-emoji="zzz"></div><div class="emoji-block" title="dash" data-emoji="dash"></div><div class="emoji-block" title="sweat_drops" data-emoji="sweat_drops"></div><div class="emoji-block" title="notes" data-emoji="notes"></div><div class="emoji-block" title="musical_note" data-emoji="musical_note"></div><div class="emoji-block" title="fire" data-emoji="fire"></div><div class="emoji-block" title="hankey" data-emoji="hankey"></div><div class="emoji-block" title="poop" data-emoji="poop"></div><div class="emoji-block" title="shit" data-emoji="shit"></div><div class="emoji-block" title="+1" data-emoji="+1"></div><div class="emoji-block" title="thumbsup" data-emoji="thumbsup"></div><div class="emoji-block" title="-1" data-emoji="-1"></div><div class="emoji-block" title="thumbsdown" data-emoji="thumbsdown"></div><div class="emoji-block" title="ok_hand" data-emoji="ok_hand"></div><div class="emoji-block" title="punch" data-emoji="punch"></div></div><div class="emoji-row"><div class="emoji-block" title="facepunch" data-emoji="facepunch"></div><div class="emoji-block" title="fist" data-emoji="fist"></div><div class="emoji-block" title="v" data-emoji="v"></div><div class="emoji-block" title="wave" data-emoji="wave"></div><div class="emoji-block" title="hand" data-emoji="hand"></div><div class="emoji-block" title="raised_hand" data-emoji="raised_hand"></div><div class="emoji-block" title="open_hands" data-emoji="open_hands"></div><div class="emoji-block" title="point_up" data-emoji="point_up"></div><div class="emoji-block" title="point_down" data-emoji="point_down"></div><div class="emoji-block" title="point_left" data-emoji="point_left"></div><div class="emoji-block" title="point_right" data-emoji="point_right"></div><div class="emoji-block" title="raised_hands" data-emoji="raised_hands"></div><div class="emoji-block" title="pray" data-emoji="pray"></div><div class="emoji-block" title="point_up_2" data-emoji="point_up_2"></div><div class="emoji-block" title="clap" data-emoji="clap"></div><div class="emoji-block" title="muscle" data-emoji="muscle"></div><div class="emoji-block" title="metal" data-emoji="metal"></div><div class="emoji-block" title="fu" data-emoji="fu"></div><div class="emoji-block" title="walking" data-emoji="walking"></div><div class="emoji-block" title="runner" data-emoji="runner"></div></div><div class="emoji-row"><div class="emoji-block" title="running" data-emoji="running"></div><div class="emoji-block" title="couple" data-emoji="couple"></div><div class="emoji-block" title="family" data-emoji="family"></div><div class="emoji-block" title="two_men_holding_hands" data-emoji="two_men_holding_hands"></div><div class="emoji-block" title="two_women_holding_hands" data-emoji="two_women_holding_hands"></div><div class="emoji-block" title="dancer" data-emoji="dancer"></div><div class="emoji-block" title="dancers" data-emoji="dancers"></div><div class="emoji-block" title="ok_woman" data-emoji="ok_woman"></div><div class="emoji-block" title="no_good" data-emoji="no_good"></div><div class="emoji-block" title="information_desk_person" data-emoji="information_desk_person"></div><div class="emoji-block" title="raising_hand" data-emoji="raising_hand"></div><div class="emoji-block" title="bride_with_veil" data-emoji="bride_with_veil"></div><div class="emoji-block" title="person_with_pouting_face" data-emoji="person_with_pouting_face"></div><div class="emoji-block" title="person_frowning" data-emoji="person_frowning"></div><div class="emoji-block" title="bow" data-emoji="bow"></div><div class="emoji-block" title="couplekiss" data-emoji="couplekiss"></div><div class="emoji-block" title="couple_with_heart" data-emoji="couple_with_heart"></div><div class="emoji-block" title="massage" data-emoji="massage"></div><div class="emoji-block" title="haircut" data-emoji="haircut"></div><div class="emoji-block" title="nail_care" data-emoji="nail_care"></div></div><div class="emoji-row"><div class="emoji-block" title="boy" data-emoji="boy"></div><div class="emoji-block" title="girl" data-emoji="girl"></div><div class="emoji-block" title="woman" data-emoji="woman"></div><div class="emoji-block" title="man" data-emoji="man"></div><div class="emoji-block" title="baby" data-emoji="baby"></div><div class="emoji-block" title="older_woman" data-emoji="older_woman"></div><div class="emoji-block" title="older_man" data-emoji="older_man"></div><div class="emoji-block" title="person_with_blond_hair" data-emoji="person_with_blond_hair"></div><div class="emoji-block" title="man_with_gua_pi_mao" data-emoji="man_with_gua_pi_mao"></div><div class="emoji-block" title="man_with_turban" data-emoji="man_with_turban"></div><div class="emoji-block" title="construction_worker" data-emoji="construction_worker"></div><div class="emoji-block" title="cop" data-emoji="cop"></div><div class="emoji-block" title="angel" data-emoji="angel"></div><div class="emoji-block" title="princess" data-emoji="princess"></div><div class="emoji-block" title="smiley_cat" data-emoji="smiley_cat"></div><div class="emoji-block" title="smile_cat" data-emoji="smile_cat"></div><div class="emoji-block" title="heart_eyes_cat" data-emoji="heart_eyes_cat"></div><div class="emoji-block" title="kissing_cat" data-emoji="kissing_cat"></div><div class="emoji-block" title="smirk_cat" data-emoji="smirk_cat"></div><div class="emoji-block" title="scream_cat" data-emoji="scream_cat"></div></div><div class="emoji-row"><div class="emoji-block" title="crying_cat_face" data-emoji="crying_cat_face"></div><div class="emoji-block" title="joy_cat" data-emoji="joy_cat"></div><div class="emoji-block" title="pouting_cat" data-emoji="pouting_cat"></div><div class="emoji-block" title="japanese_ogre" data-emoji="japanese_ogre"></div><div class="emoji-block" title="japanese_goblin" data-emoji="japanese_goblin"></div><div class="emoji-block" title="see_no_evil" data-emoji="see_no_evil"></div><div class="emoji-block" title="hear_no_evil" data-emoji="hear_no_evil"></div><div class="emoji-block" title="speak_no_evil" data-emoji="speak_no_evil"></div><div class="emoji-block" title="guardsman" data-emoji="guardsman"></div><div class="emoji-block" title="skull" data-emoji="skull"></div><div class="emoji-block" title="feet" data-emoji="feet"></div><div class="emoji-block" title="lips" data-emoji="lips"></div><div class="emoji-block" title="kiss" data-emoji="kiss"></div><div class="emoji-block" title="droplet" data-emoji="droplet"></div><div class="emoji-block" title="ear" data-emoji="ear"></div><div class="emoji-block" title="eyes" data-emoji="eyes"></div><div class="emoji-block" title="nose" data-emoji="nose"></div><div class="emoji-block" title="tongue" data-emoji="tongue"></div><div class="emoji-block" title="love_letter" data-emoji="love_letter"></div><div class="emoji-block" title="bust_in_silhouette" data-emoji="bust_in_silhouette"></div></div><div class="emoji-row"><div class="emoji-block" title="busts_in_silhouette" data-emoji="busts_in_silhouette"></div><div class="emoji-block" title="speech_balloon" data-emoji="speech_balloon"></div><div class="emoji-block" title="thought_balloon" data-emoji="thought_balloon"></div><div class="emoji-block" title="feelsgood" data-emoji="feelsgood"></div><div class="emoji-block" title="finnadie" data-emoji="finnadie"></div><div class="emoji-block" title="goberserk" data-emoji="goberserk"></div><div class="emoji-block" title="godmode" data-emoji="godmode"></div><div class="emoji-block" title="hurtrealbad" data-emoji="hurtrealbad"></div><div class="emoji-block" title="rage1" data-emoji="rage1"></div><div class="emoji-block" title="rage2" data-emoji="rage2"></div><div class="emoji-block" title="rage3" data-emoji="rage3"></div><div class="emoji-block" title="rage4" data-emoji="rage4"></div><div class="emoji-block" title="suspect" data-emoji="suspect"></div><div class="emoji-block" title="trollface" data-emoji="trollface"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div></div></div></div>
                                <div data-emoji-item="Nature"><div data-group="Nature"><div data-group-title="emoji-group-title" style="display: none;">Nature</div><div class="emoji-row"><div class="emoji-block" title="sunny" data-emoji="sunny"></div><div class="emoji-block" title="umbrella" data-emoji="umbrella"></div><div class="emoji-block" title="cloud" data-emoji="cloud"></div><div class="emoji-block" title="snowflake" data-emoji="snowflake"></div><div class="emoji-block" title="snowman" data-emoji="snowman"></div><div class="emoji-block" title="zap" data-emoji="zap"></div><div class="emoji-block" title="cyclone" data-emoji="cyclone"></div><div class="emoji-block" title="foggy" data-emoji="foggy"></div><div class="emoji-block" title="ocean" data-emoji="ocean"></div><div class="emoji-block" title="cat" data-emoji="cat"></div><div class="emoji-block" title="dog" data-emoji="dog"></div><div class="emoji-block" title="mouse" data-emoji="mouse"></div><div class="emoji-block" title="hamster" data-emoji="hamster"></div><div class="emoji-block" title="rabbit" data-emoji="rabbit"></div><div class="emoji-block" title="wolf" data-emoji="wolf"></div><div class="emoji-block" title="frog" data-emoji="frog"></div><div class="emoji-block" title="tiger" data-emoji="tiger"></div><div class="emoji-block" title="koala" data-emoji="koala"></div><div class="emoji-block" title="bear" data-emoji="bear"></div><div class="emoji-block" title="pig" data-emoji="pig"></div></div><div class="emoji-row"><div class="emoji-block" title="pig_nose" data-emoji="pig_nose"></div><div class="emoji-block" title="cow" data-emoji="cow"></div><div class="emoji-block" title="boar" data-emoji="boar"></div><div class="emoji-block" title="monkey_face" data-emoji="monkey_face"></div><div class="emoji-block" title="monkey" data-emoji="monkey"></div><div class="emoji-block" title="horse" data-emoji="horse"></div><div class="emoji-block" title="racehorse" data-emoji="racehorse"></div><div class="emoji-block" title="camel" data-emoji="camel"></div><div class="emoji-block" title="sheep" data-emoji="sheep"></div><div class="emoji-block" title="elephant" data-emoji="elephant"></div><div class="emoji-block" title="panda_face" data-emoji="panda_face"></div><div class="emoji-block" title="snake" data-emoji="snake"></div><div class="emoji-block" title="bird" data-emoji="bird"></div><div class="emoji-block" title="baby_chick" data-emoji="baby_chick"></div><div class="emoji-block" title="hatched_chick" data-emoji="hatched_chick"></div><div class="emoji-block" title="hatching_chick" data-emoji="hatching_chick"></div><div class="emoji-block" title="chicken" data-emoji="chicken"></div><div class="emoji-block" title="penguin" data-emoji="penguin"></div><div class="emoji-block" title="turtle" data-emoji="turtle"></div><div class="emoji-block" title="bug" data-emoji="bug"></div></div><div class="emoji-row"><div class="emoji-block" title="honeybee" data-emoji="honeybee"></div><div class="emoji-block" title="ant" data-emoji="ant"></div><div class="emoji-block" title="beetle" data-emoji="beetle"></div><div class="emoji-block" title="snail" data-emoji="snail"></div><div class="emoji-block" title="octopus" data-emoji="octopus"></div><div class="emoji-block" title="tropical_fish" data-emoji="tropical_fish"></div><div class="emoji-block" title="fish" data-emoji="fish"></div><div class="emoji-block" title="whale" data-emoji="whale"></div><div class="emoji-block" title="whale2" data-emoji="whale2"></div><div class="emoji-block" title="dolphin" data-emoji="dolphin"></div><div class="emoji-block" title="cow2" data-emoji="cow2"></div><div class="emoji-block" title="ram" data-emoji="ram"></div><div class="emoji-block" title="rat" data-emoji="rat"></div><div class="emoji-block" title="water_buffalo" data-emoji="water_buffalo"></div><div class="emoji-block" title="tiger2" data-emoji="tiger2"></div><div class="emoji-block" title="rabbit2" data-emoji="rabbit2"></div><div class="emoji-block" title="dragon" data-emoji="dragon"></div><div class="emoji-block" title="goat" data-emoji="goat"></div><div class="emoji-block" title="rooster" data-emoji="rooster"></div><div class="emoji-block" title="dog2" data-emoji="dog2"></div></div><div class="emoji-row"><div class="emoji-block" title="pig2" data-emoji="pig2"></div><div class="emoji-block" title="mouse2" data-emoji="mouse2"></div><div class="emoji-block" title="ox" data-emoji="ox"></div><div class="emoji-block" title="dragon_face" data-emoji="dragon_face"></div><div class="emoji-block" title="blowfish" data-emoji="blowfish"></div><div class="emoji-block" title="crocodile" data-emoji="crocodile"></div><div class="emoji-block" title="dromedary_camel" data-emoji="dromedary_camel"></div><div class="emoji-block" title="leopard" data-emoji="leopard"></div><div class="emoji-block" title="cat2" data-emoji="cat2"></div><div class="emoji-block" title="poodle" data-emoji="poodle"></div><div class="emoji-block" title="paw_prints" data-emoji="paw_prints"></div><div class="emoji-block" title="bouquet" data-emoji="bouquet"></div><div class="emoji-block" title="cherry_blossom" data-emoji="cherry_blossom"></div><div class="emoji-block" title="tulip" data-emoji="tulip"></div><div class="emoji-block" title="four_leaf_clover" data-emoji="four_leaf_clover"></div><div class="emoji-block" title="rose" data-emoji="rose"></div><div class="emoji-block" title="sunflower" data-emoji="sunflower"></div><div class="emoji-block" title="hibiscus" data-emoji="hibiscus"></div><div class="emoji-block" title="maple_leaf" data-emoji="maple_leaf"></div><div class="emoji-block" title="leaves" data-emoji="leaves"></div></div><div class="emoji-row"><div class="emoji-block" title="fallen_leaf" data-emoji="fallen_leaf"></div><div class="emoji-block" title="herb" data-emoji="herb"></div><div class="emoji-block" title="mushroom" data-emoji="mushroom"></div><div class="emoji-block" title="cactus" data-emoji="cactus"></div><div class="emoji-block" title="palm_tree" data-emoji="palm_tree"></div><div class="emoji-block" title="evergreen_tree" data-emoji="evergreen_tree"></div><div class="emoji-block" title="deciduous_tree" data-emoji="deciduous_tree"></div><div class="emoji-block" title="chestnut" data-emoji="chestnut"></div><div class="emoji-block" title="seedling" data-emoji="seedling"></div><div class="emoji-block" title="blossom" data-emoji="blossom"></div><div class="emoji-block" title="ear_of_rice" data-emoji="ear_of_rice"></div><div class="emoji-block" title="shell" data-emoji="shell"></div><div class="emoji-block" title="globe_with_meridians" data-emoji="globe_with_meridians"></div><div class="emoji-block" title="sun_with_face" data-emoji="sun_with_face"></div><div class="emoji-block" title="full_moon_with_face" data-emoji="full_moon_with_face"></div><div class="emoji-block" title="new_moon_with_face" data-emoji="new_moon_with_face"></div><div class="emoji-block" title="new_moon" data-emoji="new_moon"></div><div class="emoji-block" title="waxing_crescent_moon" data-emoji="waxing_crescent_moon"></div><div class="emoji-block" title="first_quarter_moon" data-emoji="first_quarter_moon"></div><div class="emoji-block" title="waxing_gibbous_moon" data-emoji="waxing_gibbous_moon"></div></div><div class="emoji-row"><div class="emoji-block" title="full_moon" data-emoji="full_moon"></div><div class="emoji-block" title="waning_gibbous_moon" data-emoji="waning_gibbous_moon"></div><div class="emoji-block" title="last_quarter_moon" data-emoji="last_quarter_moon"></div><div class="emoji-block" title="waning_crescent_moon" data-emoji="waning_crescent_moon"></div><div class="emoji-block" title="last_quarter_moon_with_face" data-emoji="last_quarter_moon_with_face"></div><div class="emoji-block" title="first_quarter_moon_with_face" data-emoji="first_quarter_moon_with_face"></div><div class="emoji-block" title="moon" data-emoji="moon"></div><div class="emoji-block" title="earth_africa" data-emoji="earth_africa"></div><div class="emoji-block" title="earth_americas" data-emoji="earth_americas"></div><div class="emoji-block" title="earth_asia" data-emoji="earth_asia"></div><div class="emoji-block" title="volcano" data-emoji="volcano"></div><div class="emoji-block" title="milky_way" data-emoji="milky_way"></div><div class="emoji-block" title="partly_sunny" data-emoji="partly_sunny"></div><div class="emoji-block" title="octocat" data-emoji="octocat"></div><div class="emoji-block" title="squirrel" data-emoji="squirrel"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div></div></div></div>
                                <div data-emoji-item="Objects"><div data-group="Objects"><div data-group-title="emoji-group-title" style="display: none;">Objects</div><div class="emoji-row"><div class="emoji-block" title="bamboo" data-emoji="bamboo"></div><div class="emoji-block" title="gift_heart" data-emoji="gift_heart"></div><div class="emoji-block" title="dolls" data-emoji="dolls"></div><div class="emoji-block" title="school_satchel" data-emoji="school_satchel"></div><div class="emoji-block" title="mortar_board" data-emoji="mortar_board"></div><div class="emoji-block" title="flags" data-emoji="flags"></div><div class="emoji-block" title="fireworks" data-emoji="fireworks"></div><div class="emoji-block" title="sparkler" data-emoji="sparkler"></div><div class="emoji-block" title="wind_chime" data-emoji="wind_chime"></div><div class="emoji-block" title="rice_scene" data-emoji="rice_scene"></div><div class="emoji-block" title="jack_o_lantern" data-emoji="jack_o_lantern"></div><div class="emoji-block" title="ghost" data-emoji="ghost"></div><div class="emoji-block" title="santa" data-emoji="santa"></div><div class="emoji-block" title="christmas_tree" data-emoji="christmas_tree"></div><div class="emoji-block" title="gift" data-emoji="gift"></div><div class="emoji-block" title="bell" data-emoji="bell"></div><div class="emoji-block" title="no_bell" data-emoji="no_bell"></div><div class="emoji-block" title="tanabata_tree" data-emoji="tanabata_tree"></div><div class="emoji-block" title="tada" data-emoji="tada"></div><div class="emoji-block" title="confetti_ball" data-emoji="confetti_ball"></div></div><div class="emoji-row"><div class="emoji-block" title="balloon" data-emoji="balloon"></div><div class="emoji-block" title="crystal_ball" data-emoji="crystal_ball"></div><div class="emoji-block" title="cd" data-emoji="cd"></div><div class="emoji-block" title="dvd" data-emoji="dvd"></div><div class="emoji-block" title="floppy_disk" data-emoji="floppy_disk"></div><div class="emoji-block" title="camera" data-emoji="camera"></div><div class="emoji-block" title="video_camera" data-emoji="video_camera"></div><div class="emoji-block" title="movie_camera" data-emoji="movie_camera"></div><div class="emoji-block" title="computer" data-emoji="computer"></div><div class="emoji-block" title="tv" data-emoji="tv"></div><div class="emoji-block" title="iphone" data-emoji="iphone"></div><div class="emoji-block" title="phone" data-emoji="phone"></div><div class="emoji-block" title="telephone" data-emoji="telephone"></div><div class="emoji-block" title="telephone_receiver" data-emoji="telephone_receiver"></div><div class="emoji-block" title="pager" data-emoji="pager"></div><div class="emoji-block" title="fax" data-emoji="fax"></div><div class="emoji-block" title="minidisc" data-emoji="minidisc"></div><div class="emoji-block" title="vhs" data-emoji="vhs"></div><div class="emoji-block" title="sound" data-emoji="sound"></div><div class="emoji-block" title="speaker" data-emoji="speaker"></div></div><div class="emoji-row"><div class="emoji-block" title="mute" data-emoji="mute"></div><div class="emoji-block" title="loudspeaker" data-emoji="loudspeaker"></div><div class="emoji-block" title="mega" data-emoji="mega"></div><div class="emoji-block" title="hourglass" data-emoji="hourglass"></div><div class="emoji-block" title="hourglass_flowing_sand" data-emoji="hourglass_flowing_sand"></div><div class="emoji-block" title="alarm_clock" data-emoji="alarm_clock"></div><div class="emoji-block" title="watch" data-emoji="watch"></div><div class="emoji-block" title="radio" data-emoji="radio"></div><div class="emoji-block" title="satellite" data-emoji="satellite"></div><div class="emoji-block" title="loop" data-emoji="loop"></div><div class="emoji-block" title="mag" data-emoji="mag"></div><div class="emoji-block" title="mag_right" data-emoji="mag_right"></div><div class="emoji-block" title="unlock" data-emoji="unlock"></div><div class="emoji-block" title="lock" data-emoji="lock"></div><div class="emoji-block" title="lock_with_ink_pen" data-emoji="lock_with_ink_pen"></div><div class="emoji-block" title="closed_lock_with_key" data-emoji="closed_lock_with_key"></div><div class="emoji-block" title="key" data-emoji="key"></div><div class="emoji-block" title="bulb" data-emoji="bulb"></div><div class="emoji-block" title="flashlight" data-emoji="flashlight"></div><div class="emoji-block" title="high_brightness" data-emoji="high_brightness"></div></div><div class="emoji-row"><div class="emoji-block" title="low_brightness" data-emoji="low_brightness"></div><div class="emoji-block" title="electric_plug" data-emoji="electric_plug"></div><div class="emoji-block" title="battery" data-emoji="battery"></div><div class="emoji-block" title="calling" data-emoji="calling"></div><div class="emoji-block" title="email" data-emoji="email"></div><div class="emoji-block" title="mailbox" data-emoji="mailbox"></div><div class="emoji-block" title="postbox" data-emoji="postbox"></div><div class="emoji-block" title="bath" data-emoji="bath"></div><div class="emoji-block" title="bathtub" data-emoji="bathtub"></div><div class="emoji-block" title="shower" data-emoji="shower"></div><div class="emoji-block" title="toilet" data-emoji="toilet"></div><div class="emoji-block" title="wrench" data-emoji="wrench"></div><div class="emoji-block" title="nut_and_bolt" data-emoji="nut_and_bolt"></div><div class="emoji-block" title="hammer" data-emoji="hammer"></div><div class="emoji-block" title="seat" data-emoji="seat"></div><div class="emoji-block" title="moneybag" data-emoji="moneybag"></div><div class="emoji-block" title="yen" data-emoji="yen"></div><div class="emoji-block" title="dollar" data-emoji="dollar"></div><div class="emoji-block" title="pound" data-emoji="pound"></div><div class="emoji-block" title="euro" data-emoji="euro"></div></div><div class="emoji-row"><div class="emoji-block" title="credit_card" data-emoji="credit_card"></div><div class="emoji-block" title="money_with_wings" data-emoji="money_with_wings"></div><div class="emoji-block" title="e-mail" data-emoji="e-mail"></div><div class="emoji-block" title="inbox_tray" data-emoji="inbox_tray"></div><div class="emoji-block" title="outbox_tray" data-emoji="outbox_tray"></div><div class="emoji-block" title="envelope" data-emoji="envelope"></div><div class="emoji-block" title="incoming_envelope" data-emoji="incoming_envelope"></div><div class="emoji-block" title="postal_horn" data-emoji="postal_horn"></div><div class="emoji-block" title="mailbox_closed" data-emoji="mailbox_closed"></div><div class="emoji-block" title="mailbox_with_mail" data-emoji="mailbox_with_mail"></div><div class="emoji-block" title="mailbox_with_no_mail" data-emoji="mailbox_with_no_mail"></div><div class="emoji-block" title="package" data-emoji="package"></div><div class="emoji-block" title="door" data-emoji="door"></div><div class="emoji-block" title="smoking" data-emoji="smoking"></div><div class="emoji-block" title="bomb" data-emoji="bomb"></div><div class="emoji-block" title="gun" data-emoji="gun"></div><div class="emoji-block" title="hocho" data-emoji="hocho"></div><div class="emoji-block" title="pill" data-emoji="pill"></div><div class="emoji-block" title="syringe" data-emoji="syringe"></div><div class="emoji-block" title="page_facing_up" data-emoji="page_facing_up"></div></div><div class="emoji-row"><div class="emoji-block" title="page_with_curl" data-emoji="page_with_curl"></div><div class="emoji-block" title="bookmark_tabs" data-emoji="bookmark_tabs"></div><div class="emoji-block" title="bar_chart" data-emoji="bar_chart"></div><div class="emoji-block" title="chart_with_upwards_trend" data-emoji="chart_with_upwards_trend"></div><div class="emoji-block" title="chart_with_downwards_trend" data-emoji="chart_with_downwards_trend"></div><div class="emoji-block" title="scroll" data-emoji="scroll"></div><div class="emoji-block" title="clipboard" data-emoji="clipboard"></div><div class="emoji-block" title="calendar" data-emoji="calendar"></div><div class="emoji-block" title="date" data-emoji="date"></div><div class="emoji-block" title="card_index" data-emoji="card_index"></div><div class="emoji-block" title="file_folder" data-emoji="file_folder"></div><div class="emoji-block" title="open_file_folder" data-emoji="open_file_folder"></div><div class="emoji-block" title="scissors" data-emoji="scissors"></div><div class="emoji-block" title="pushpin" data-emoji="pushpin"></div><div class="emoji-block" title="paperclip" data-emoji="paperclip"></div><div class="emoji-block" title="black_nib" data-emoji="black_nib"></div><div class="emoji-block" title="pencil2" data-emoji="pencil2"></div><div class="emoji-block" title="straight_ruler" data-emoji="straight_ruler"></div><div class="emoji-block" title="triangular_ruler" data-emoji="triangular_ruler"></div><div class="emoji-block" title="closed_book" data-emoji="closed_book"></div></div><div class="emoji-row"><div class="emoji-block" title="green_book" data-emoji="green_book"></div><div class="emoji-block" title="blue_book" data-emoji="blue_book"></div><div class="emoji-block" title="orange_book" data-emoji="orange_book"></div><div class="emoji-block" title="notebook" data-emoji="notebook"></div><div class="emoji-block" title="notebook_with_decorative_cover" data-emoji="notebook_with_decorative_cover"></div><div class="emoji-block" title="ledger" data-emoji="ledger"></div><div class="emoji-block" title="books" data-emoji="books"></div><div class="emoji-block" title="bookmark" data-emoji="bookmark"></div><div class="emoji-block" title="name_badge" data-emoji="name_badge"></div><div class="emoji-block" title="microscope" data-emoji="microscope"></div><div class="emoji-block" title="telescope" data-emoji="telescope"></div><div class="emoji-block" title="newspaper" data-emoji="newspaper"></div><div class="emoji-block" title="football" data-emoji="football"></div><div class="emoji-block" title="basketball" data-emoji="basketball"></div><div class="emoji-block" title="soccer" data-emoji="soccer"></div><div class="emoji-block" title="baseball" data-emoji="baseball"></div><div class="emoji-block" title="tennis" data-emoji="tennis"></div><div class="emoji-block" title="8ball" data-emoji="8ball"></div><div class="emoji-block" title="rugby_football" data-emoji="rugby_football"></div><div class="emoji-block" title="bowling" data-emoji="bowling"></div></div><div class="emoji-row"><div class="emoji-block" title="golf" data-emoji="golf"></div><div class="emoji-block" title="mountain_bicyclist" data-emoji="mountain_bicyclist"></div><div class="emoji-block" title="bicyclist" data-emoji="bicyclist"></div><div class="emoji-block" title="horse_racing" data-emoji="horse_racing"></div><div class="emoji-block" title="snowboarder" data-emoji="snowboarder"></div><div class="emoji-block" title="swimmer" data-emoji="swimmer"></div><div class="emoji-block" title="surfer" data-emoji="surfer"></div><div class="emoji-block" title="ski" data-emoji="ski"></div><div class="emoji-block" title="spades" data-emoji="spades"></div><div class="emoji-block" title="hearts" data-emoji="hearts"></div><div class="emoji-block" title="clubs" data-emoji="clubs"></div><div class="emoji-block" title="diamonds" data-emoji="diamonds"></div><div class="emoji-block" title="gem" data-emoji="gem"></div><div class="emoji-block" title="ring" data-emoji="ring"></div><div class="emoji-block" title="trophy" data-emoji="trophy"></div><div class="emoji-block" title="musical_score" data-emoji="musical_score"></div><div class="emoji-block" title="musical_keyboard" data-emoji="musical_keyboard"></div><div class="emoji-block" title="violin" data-emoji="violin"></div><div class="emoji-block" title="space_invader" data-emoji="space_invader"></div><div class="emoji-block" title="video_game" data-emoji="video_game"></div></div><div class="emoji-row"><div class="emoji-block" title="black_joker" data-emoji="black_joker"></div><div class="emoji-block" title="flower_playing_cards" data-emoji="flower_playing_cards"></div><div class="emoji-block" title="game_die" data-emoji="game_die"></div><div class="emoji-block" title="dart" data-emoji="dart"></div><div class="emoji-block" title="mahjong" data-emoji="mahjong"></div><div class="emoji-block" title="clapper" data-emoji="clapper"></div><div class="emoji-block" title="memo" data-emoji="memo"></div><div class="emoji-block" title="pencil" data-emoji="pencil"></div><div class="emoji-block" title="book" data-emoji="book"></div><div class="emoji-block" title="art" data-emoji="art"></div><div class="emoji-block" title="microphone" data-emoji="microphone"></div><div class="emoji-block" title="headphones" data-emoji="headphones"></div><div class="emoji-block" title="trumpet" data-emoji="trumpet"></div><div class="emoji-block" title="saxophone" data-emoji="saxophone"></div><div class="emoji-block" title="guitar" data-emoji="guitar"></div><div class="emoji-block" title="shoe" data-emoji="shoe"></div><div class="emoji-block" title="sandal" data-emoji="sandal"></div><div class="emoji-block" title="high_heel" data-emoji="high_heel"></div><div class="emoji-block" title="lipstick" data-emoji="lipstick"></div><div class="emoji-block" title="boot" data-emoji="boot"></div></div><div class="emoji-row"><div class="emoji-block" title="shirt" data-emoji="shirt"></div><div class="emoji-block" title="tshirt" data-emoji="tshirt"></div><div class="emoji-block" title="necktie" data-emoji="necktie"></div><div class="emoji-block" title="womans_clothes" data-emoji="womans_clothes"></div><div class="emoji-block" title="dress" data-emoji="dress"></div><div class="emoji-block" title="running_shirt_with_sash" data-emoji="running_shirt_with_sash"></div><div class="emoji-block" title="jeans" data-emoji="jeans"></div><div class="emoji-block" title="kimono" data-emoji="kimono"></div><div class="emoji-block" title="bikini" data-emoji="bikini"></div><div class="emoji-block" title="ribbon" data-emoji="ribbon"></div><div class="emoji-block" title="tophat" data-emoji="tophat"></div><div class="emoji-block" title="crown" data-emoji="crown"></div><div class="emoji-block" title="womans_hat" data-emoji="womans_hat"></div><div class="emoji-block" title="mans_shoe" data-emoji="mans_shoe"></div><div class="emoji-block" title="closed_umbrella" data-emoji="closed_umbrella"></div><div class="emoji-block" title="briefcase" data-emoji="briefcase"></div><div class="emoji-block" title="handbag" data-emoji="handbag"></div><div class="emoji-block" title="pouch" data-emoji="pouch"></div><div class="emoji-block" title="purse" data-emoji="purse"></div><div class="emoji-block" title="eyeglasses" data-emoji="eyeglasses"></div></div><div class="emoji-row"><div class="emoji-block" title="fishing_pole_and_fish" data-emoji="fishing_pole_and_fish"></div><div class="emoji-block" title="coffee" data-emoji="coffee"></div><div class="emoji-block" title="tea" data-emoji="tea"></div><div class="emoji-block" title="sake" data-emoji="sake"></div><div class="emoji-block" title="baby_bottle" data-emoji="baby_bottle"></div><div class="emoji-block" title="beer" data-emoji="beer"></div><div class="emoji-block" title="beers" data-emoji="beers"></div><div class="emoji-block" title="cocktail" data-emoji="cocktail"></div><div class="emoji-block" title="tropical_drink" data-emoji="tropical_drink"></div><div class="emoji-block" title="wine_glass" data-emoji="wine_glass"></div><div class="emoji-block" title="fork_and_knife" data-emoji="fork_and_knife"></div><div class="emoji-block" title="pizza" data-emoji="pizza"></div><div class="emoji-block" title="hamburger" data-emoji="hamburger"></div><div class="emoji-block" title="fries" data-emoji="fries"></div><div class="emoji-block" title="poultry_leg" data-emoji="poultry_leg"></div><div class="emoji-block" title="meat_on_bone" data-emoji="meat_on_bone"></div><div class="emoji-block" title="spaghetti" data-emoji="spaghetti"></div><div class="emoji-block" title="curry" data-emoji="curry"></div><div class="emoji-block" title="fried_shrimp" data-emoji="fried_shrimp"></div><div class="emoji-block" title="bento" data-emoji="bento"></div></div><div class="emoji-row"><div class="emoji-block" title="sushi" data-emoji="sushi"></div><div class="emoji-block" title="fish_cake" data-emoji="fish_cake"></div><div class="emoji-block" title="rice_ball" data-emoji="rice_ball"></div><div class="emoji-block" title="rice_cracker" data-emoji="rice_cracker"></div><div class="emoji-block" title="rice" data-emoji="rice"></div><div class="emoji-block" title="ramen" data-emoji="ramen"></div><div class="emoji-block" title="stew" data-emoji="stew"></div><div class="emoji-block" title="oden" data-emoji="oden"></div><div class="emoji-block" title="dango" data-emoji="dango"></div><div class="emoji-block" title="egg" data-emoji="egg"></div><div class="emoji-block" title="bread" data-emoji="bread"></div><div class="emoji-block" title="doughnut" data-emoji="doughnut"></div><div class="emoji-block" title="custard" data-emoji="custard"></div><div class="emoji-block" title="icecream" data-emoji="icecream"></div><div class="emoji-block" title="ice_cream" data-emoji="ice_cream"></div><div class="emoji-block" title="shaved_ice" data-emoji="shaved_ice"></div><div class="emoji-block" title="birthday" data-emoji="birthday"></div><div class="emoji-block" title="cake" data-emoji="cake"></div><div class="emoji-block" title="cookie" data-emoji="cookie"></div><div class="emoji-block" title="chocolate_bar" data-emoji="chocolate_bar"></div></div><div class="emoji-row"><div class="emoji-block" title="candy" data-emoji="candy"></div><div class="emoji-block" title="lollipop" data-emoji="lollipop"></div><div class="emoji-block" title="honey_pot" data-emoji="honey_pot"></div><div class="emoji-block" title="apple" data-emoji="apple"></div><div class="emoji-block" title="green_apple" data-emoji="green_apple"></div><div class="emoji-block" title="tangerine" data-emoji="tangerine"></div><div class="emoji-block" title="lemon" data-emoji="lemon"></div><div class="emoji-block" title="cherries" data-emoji="cherries"></div><div class="emoji-block" title="grapes" data-emoji="grapes"></div><div class="emoji-block" title="watermelon" data-emoji="watermelon"></div><div class="emoji-block" title="strawberry" data-emoji="strawberry"></div><div class="emoji-block" title="peach" data-emoji="peach"></div><div class="emoji-block" title="melon" data-emoji="melon"></div><div class="emoji-block" title="banana" data-emoji="banana"></div><div class="emoji-block" title="pear" data-emoji="pear"></div><div class="emoji-block" title="pineapple" data-emoji="pineapple"></div><div class="emoji-block" title="sweet_potato" data-emoji="sweet_potato"></div><div class="emoji-block" title="eggplant" data-emoji="eggplant"></div><div class="emoji-block" title="tomato" data-emoji="tomato"></div><div class="emoji-block" title="corn" data-emoji="corn"></div></div></div></div>
                                <div data-emoji-item="Places"><div data-group="Places"><div data-group-title="emoji-group-title" style="display: none;">Places</div><div class="emoji-row"><div class="emoji-block" title="house" data-emoji="house"></div><div class="emoji-block" title="house_with_garden" data-emoji="house_with_garden"></div><div class="emoji-block" title="school" data-emoji="school"></div><div class="emoji-block" title="office" data-emoji="office"></div><div class="emoji-block" title="post_office" data-emoji="post_office"></div><div class="emoji-block" title="hospital" data-emoji="hospital"></div><div class="emoji-block" title="bank" data-emoji="bank"></div><div class="emoji-block" title="convenience_store" data-emoji="convenience_store"></div><div class="emoji-block" title="love_hotel" data-emoji="love_hotel"></div><div class="emoji-block" title="hotel" data-emoji="hotel"></div><div class="emoji-block" title="wedding" data-emoji="wedding"></div><div class="emoji-block" title="church" data-emoji="church"></div><div class="emoji-block" title="department_store" data-emoji="department_store"></div><div class="emoji-block" title="european_post_office" data-emoji="european_post_office"></div><div class="emoji-block" title="city_sunrise" data-emoji="city_sunrise"></div><div class="emoji-block" title="city_sunset" data-emoji="city_sunset"></div><div class="emoji-block" title="japanese_castle" data-emoji="japanese_castle"></div><div class="emoji-block" title="european_castle" data-emoji="european_castle"></div><div class="emoji-block" title="tent" data-emoji="tent"></div><div class="emoji-block" title="factory" data-emoji="factory"></div></div><div class="emoji-row"><div class="emoji-block" title="tokyo_tower" data-emoji="tokyo_tower"></div><div class="emoji-block" title="japan" data-emoji="japan"></div><div class="emoji-block" title="mount_fuji" data-emoji="mount_fuji"></div><div class="emoji-block" title="sunrise_over_mountains" data-emoji="sunrise_over_mountains"></div><div class="emoji-block" title="sunrise" data-emoji="sunrise"></div><div class="emoji-block" title="stars" data-emoji="stars"></div><div class="emoji-block" title="statue_of_liberty" data-emoji="statue_of_liberty"></div><div class="emoji-block" title="bridge_at_night" data-emoji="bridge_at_night"></div><div class="emoji-block" title="carousel_horse" data-emoji="carousel_horse"></div><div class="emoji-block" title="rainbow" data-emoji="rainbow"></div><div class="emoji-block" title="ferris_wheel" data-emoji="ferris_wheel"></div><div class="emoji-block" title="fountain" data-emoji="fountain"></div><div class="emoji-block" title="roller_coaster" data-emoji="roller_coaster"></div><div class="emoji-block" title="ship" data-emoji="ship"></div><div class="emoji-block" title="speedboat" data-emoji="speedboat"></div><div class="emoji-block" title="boat" data-emoji="boat"></div><div class="emoji-block" title="sailboat" data-emoji="sailboat"></div><div class="emoji-block" title="rowboat" data-emoji="rowboat"></div><div class="emoji-block" title="anchor" data-emoji="anchor"></div><div class="emoji-block" title="rocket" data-emoji="rocket"></div></div><div class="emoji-row"><div class="emoji-block" title="airplane" data-emoji="airplane"></div><div class="emoji-block" title="helicopter" data-emoji="helicopter"></div><div class="emoji-block" title="steam_locomotive" data-emoji="steam_locomotive"></div><div class="emoji-block" title="tram" data-emoji="tram"></div><div class="emoji-block" title="mountain_railway" data-emoji="mountain_railway"></div><div class="emoji-block" title="bike" data-emoji="bike"></div><div class="emoji-block" title="aerial_tramway" data-emoji="aerial_tramway"></div><div class="emoji-block" title="suspension_railway" data-emoji="suspension_railway"></div><div class="emoji-block" title="mountain_cableway" data-emoji="mountain_cableway"></div><div class="emoji-block" title="tractor" data-emoji="tractor"></div><div class="emoji-block" title="blue_car" data-emoji="blue_car"></div><div class="emoji-block" title="oncoming_automobile" data-emoji="oncoming_automobile"></div><div class="emoji-block" title="car" data-emoji="car"></div><div class="emoji-block" title="red_car" data-emoji="red_car"></div><div class="emoji-block" title="taxi" data-emoji="taxi"></div><div class="emoji-block" title="oncoming_taxi" data-emoji="oncoming_taxi"></div><div class="emoji-block" title="articulated_lorry" data-emoji="articulated_lorry"></div><div class="emoji-block" title="bus" data-emoji="bus"></div><div class="emoji-block" title="oncoming_bus" data-emoji="oncoming_bus"></div><div class="emoji-block" title="rotating_light" data-emoji="rotating_light"></div></div><div class="emoji-row"><div class="emoji-block" title="police_car" data-emoji="police_car"></div><div class="emoji-block" title="oncoming_police_car" data-emoji="oncoming_police_car"></div><div class="emoji-block" title="fire_engine" data-emoji="fire_engine"></div><div class="emoji-block" title="ambulance" data-emoji="ambulance"></div><div class="emoji-block" title="minibus" data-emoji="minibus"></div><div class="emoji-block" title="truck" data-emoji="truck"></div><div class="emoji-block" title="train" data-emoji="train"></div><div class="emoji-block" title="station" data-emoji="station"></div><div class="emoji-block" title="train2" data-emoji="train2"></div><div class="emoji-block" title="bullettrain_front" data-emoji="bullettrain_front"></div><div class="emoji-block" title="bullettrain_side" data-emoji="bullettrain_side"></div><div class="emoji-block" title="light_rail" data-emoji="light_rail"></div><div class="emoji-block" title="monorail" data-emoji="monorail"></div><div class="emoji-block" title="railway_car" data-emoji="railway_car"></div><div class="emoji-block" title="trolleybus" data-emoji="trolleybus"></div><div class="emoji-block" title="ticket" data-emoji="ticket"></div><div class="emoji-block" title="fuelpump" data-emoji="fuelpump"></div><div class="emoji-block" title="vertical_traffic_light" data-emoji="vertical_traffic_light"></div><div class="emoji-block" title="traffic_light" data-emoji="traffic_light"></div><div class="emoji-block" title="warning" data-emoji="warning"></div></div><div class="emoji-row"><div class="emoji-block" title="construction" data-emoji="construction"></div><div class="emoji-block" title="beginner" data-emoji="beginner"></div><div class="emoji-block" title="atm" data-emoji="atm"></div><div class="emoji-block" title="slot_machine" data-emoji="slot_machine"></div><div class="emoji-block" title="busstop" data-emoji="busstop"></div><div class="emoji-block" title="barber" data-emoji="barber"></div><div class="emoji-block" title="hotsprings" data-emoji="hotsprings"></div><div class="emoji-block" title="checkered_flag" data-emoji="checkered_flag"></div><div class="emoji-block" title="crossed_flags" data-emoji="crossed_flags"></div><div class="emoji-block" title="izakaya_lantern" data-emoji="izakaya_lantern"></div><div class="emoji-block" title="moyai" data-emoji="moyai"></div><div class="emoji-block" title="circus_tent" data-emoji="circus_tent"></div><div class="emoji-block" title="performing_arts" data-emoji="performing_arts"></div><div class="emoji-block" title="round_pushpin" data-emoji="round_pushpin"></div><div class="emoji-block" title="triangular_flag_on_post" data-emoji="triangular_flag_on_post"></div><div class="emoji-block" title="jp" data-emoji="jp"></div><div class="emoji-block" title="kr" data-emoji="kr"></div><div class="emoji-block" title="cn" data-emoji="cn"></div><div class="emoji-block" title="us" data-emoji="us"></div><div class="emoji-block" title="fr" data-emoji="fr"></div></div><div class="emoji-row"><div class="emoji-block" title="es" data-emoji="es"></div><div class="emoji-block" title="it" data-emoji="it"></div><div class="emoji-block" title="ru" data-emoji="ru"></div><div class="emoji-block" title="gb" data-emoji="gb"></div><div class="emoji-block" title="uk" data-emoji="uk"></div><div class="emoji-block" title="de" data-emoji="de"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div></div></div></div>
                                <div data-emoji-item="Symbols"><div data-group="Symbols"><div data-group-title="emoji-group-title" style="display: none;">Symbols</div><div class="emoji-row"><div class="emoji-block" title="one" data-emoji="one"></div><div class="emoji-block" title="two" data-emoji="two"></div><div class="emoji-block" title="three" data-emoji="three"></div><div class="emoji-block" title="four" data-emoji="four"></div><div class="emoji-block" title="five" data-emoji="five"></div><div class="emoji-block" title="six" data-emoji="six"></div><div class="emoji-block" title="seven" data-emoji="seven"></div><div class="emoji-block" title="eight" data-emoji="eight"></div><div class="emoji-block" title="nine" data-emoji="nine"></div><div class="emoji-block" title="keycap_ten" data-emoji="keycap_ten"></div><div class="emoji-block" title="1234" data-emoji="1234"></div><div class="emoji-block" title="zero" data-emoji="zero"></div><div class="emoji-block" title="hash" data-emoji="hash"></div><div class="emoji-block" title="symbols" data-emoji="symbols"></div><div class="emoji-block" title="arrow_backward" data-emoji="arrow_backward"></div><div class="emoji-block" title="arrow_down" data-emoji="arrow_down"></div><div class="emoji-block" title="arrow_forward" data-emoji="arrow_forward"></div><div class="emoji-block" title="arrow_left" data-emoji="arrow_left"></div><div class="emoji-block" title="capital_abcd" data-emoji="capital_abcd"></div><div class="emoji-block" title="abcd" data-emoji="abcd"></div></div><div class="emoji-row"><div class="emoji-block" title="abc" data-emoji="abc"></div><div class="emoji-block" title="arrow_lower_left" data-emoji="arrow_lower_left"></div><div class="emoji-block" title="arrow_lower_right" data-emoji="arrow_lower_right"></div><div class="emoji-block" title="arrow_right" data-emoji="arrow_right"></div><div class="emoji-block" title="arrow_up" data-emoji="arrow_up"></div><div class="emoji-block" title="arrow_upper_left" data-emoji="arrow_upper_left"></div><div class="emoji-block" title="arrow_upper_right" data-emoji="arrow_upper_right"></div><div class="emoji-block" title="arrow_double_down" data-emoji="arrow_double_down"></div><div class="emoji-block" title="arrow_double_up" data-emoji="arrow_double_up"></div><div class="emoji-block" title="arrow_down_small" data-emoji="arrow_down_small"></div><div class="emoji-block" title="arrow_heading_down" data-emoji="arrow_heading_down"></div><div class="emoji-block" title="arrow_heading_up" data-emoji="arrow_heading_up"></div><div class="emoji-block" title="leftwards_arrow_with_hook" data-emoji="leftwards_arrow_with_hook"></div><div class="emoji-block" title="arrow_right_hook" data-emoji="arrow_right_hook"></div><div class="emoji-block" title="left_right_arrow" data-emoji="left_right_arrow"></div><div class="emoji-block" title="arrow_up_down" data-emoji="arrow_up_down"></div><div class="emoji-block" title="arrow_up_small" data-emoji="arrow_up_small"></div><div class="emoji-block" title="arrows_clockwise" data-emoji="arrows_clockwise"></div><div class="emoji-block" title="arrows_counterclockwise" data-emoji="arrows_counterclockwise"></div><div class="emoji-block" title="rewind" data-emoji="rewind"></div></div><div class="emoji-row"><div class="emoji-block" title="fast_forward" data-emoji="fast_forward"></div><div class="emoji-block" title="information_source" data-emoji="information_source"></div><div class="emoji-block" title="ok" data-emoji="ok"></div><div class="emoji-block" title="twisted_rightwards_arrows" data-emoji="twisted_rightwards_arrows"></div><div class="emoji-block" title="repeat" data-emoji="repeat"></div><div class="emoji-block" title="repeat_one" data-emoji="repeat_one"></div><div class="emoji-block" title="new" data-emoji="new"></div><div class="emoji-block" title="top" data-emoji="top"></div><div class="emoji-block" title="up" data-emoji="up"></div><div class="emoji-block" title="cool" data-emoji="cool"></div><div class="emoji-block" title="free" data-emoji="free"></div><div class="emoji-block" title="ng" data-emoji="ng"></div><div class="emoji-block" title="cinema" data-emoji="cinema"></div><div class="emoji-block" title="koko" data-emoji="koko"></div><div class="emoji-block" title="signal_strength" data-emoji="signal_strength"></div><div class="emoji-block" title="u5272" data-emoji="u5272"></div><div class="emoji-block" title="u5408" data-emoji="u5408"></div><div class="emoji-block" title="u55b6" data-emoji="u55b6"></div><div class="emoji-block" title="u6307" data-emoji="u6307"></div><div class="emoji-block" title="u6708" data-emoji="u6708"></div></div><div class="emoji-row"><div class="emoji-block" title="u6709" data-emoji="u6709"></div><div class="emoji-block" title="u6e80" data-emoji="u6e80"></div><div class="emoji-block" title="u7121" data-emoji="u7121"></div><div class="emoji-block" title="u7533" data-emoji="u7533"></div><div class="emoji-block" title="u7a7a" data-emoji="u7a7a"></div><div class="emoji-block" title="u7981" data-emoji="u7981"></div><div class="emoji-block" title="sa" data-emoji="sa"></div><div class="emoji-block" title="restroom" data-emoji="restroom"></div><div class="emoji-block" title="mens" data-emoji="mens"></div><div class="emoji-block" title="womens" data-emoji="womens"></div><div class="emoji-block" title="baby_symbol" data-emoji="baby_symbol"></div><div class="emoji-block" title="no_smoking" data-emoji="no_smoking"></div><div class="emoji-block" title="parking" data-emoji="parking"></div><div class="emoji-block" title="wheelchair" data-emoji="wheelchair"></div><div class="emoji-block" title="metro" data-emoji="metro"></div><div class="emoji-block" title="baggage_claim" data-emoji="baggage_claim"></div><div class="emoji-block" title="accept" data-emoji="accept"></div><div class="emoji-block" title="wc" data-emoji="wc"></div><div class="emoji-block" title="potable_water" data-emoji="potable_water"></div><div class="emoji-block" title="put_litter_in_its_place" data-emoji="put_litter_in_its_place"></div></div><div class="emoji-row"><div class="emoji-block" title="secret" data-emoji="secret"></div><div class="emoji-block" title="congratulations" data-emoji="congratulations"></div><div class="emoji-block" title="m" data-emoji="m"></div><div class="emoji-block" title="passport_control" data-emoji="passport_control"></div><div class="emoji-block" title="left_luggage" data-emoji="left_luggage"></div><div class="emoji-block" title="customs" data-emoji="customs"></div><div class="emoji-block" title="ideograph_advantage" data-emoji="ideograph_advantage"></div><div class="emoji-block" title="cl" data-emoji="cl"></div><div class="emoji-block" title="sos" data-emoji="sos"></div><div class="emoji-block" title="id" data-emoji="id"></div><div class="emoji-block" title="no_entry_sign" data-emoji="no_entry_sign"></div><div class="emoji-block" title="underage" data-emoji="underage"></div><div class="emoji-block" title="no_mobile_phones" data-emoji="no_mobile_phones"></div><div class="emoji-block" title="do_not_litter" data-emoji="do_not_litter"></div><div class="emoji-block" title="non-potable_water" data-emoji="non-potable_water"></div><div class="emoji-block" title="no_bicycles" data-emoji="no_bicycles"></div><div class="emoji-block" title="no_pedestrians" data-emoji="no_pedestrians"></div><div class="emoji-block" title="children_crossing" data-emoji="children_crossing"></div><div class="emoji-block" title="no_entry" data-emoji="no_entry"></div><div class="emoji-block" title="eight_spoked_asterisk" data-emoji="eight_spoked_asterisk"></div></div><div class="emoji-row"><div class="emoji-block" title="sparkle" data-emoji="sparkle"></div><div class="emoji-block" title="eight_pointed_black_star" data-emoji="eight_pointed_black_star"></div><div class="emoji-block" title="heart_decoration" data-emoji="heart_decoration"></div><div class="emoji-block" title="vs" data-emoji="vs"></div><div class="emoji-block" title="vibration_mode" data-emoji="vibration_mode"></div><div class="emoji-block" title="mobile_phone_off" data-emoji="mobile_phone_off"></div><div class="emoji-block" title="chart" data-emoji="chart"></div><div class="emoji-block" title="currency_exchange" data-emoji="currency_exchange"></div><div class="emoji-block" title="aries" data-emoji="aries"></div><div class="emoji-block" title="taurus" data-emoji="taurus"></div><div class="emoji-block" title="gemini" data-emoji="gemini"></div><div class="emoji-block" title="cancer" data-emoji="cancer"></div><div class="emoji-block" title="leo" data-emoji="leo"></div><div class="emoji-block" title="virgo" data-emoji="virgo"></div><div class="emoji-block" title="libra" data-emoji="libra"></div><div class="emoji-block" title="scorpius" data-emoji="scorpius"></div><div class="emoji-block" title="sagittarius" data-emoji="sagittarius"></div><div class="emoji-block" title="capricorn" data-emoji="capricorn"></div><div class="emoji-block" title="aquarius" data-emoji="aquarius"></div><div class="emoji-block" title="pisces" data-emoji="pisces"></div></div><div class="emoji-row"><div class="emoji-block" title="ophiuchus" data-emoji="ophiuchus"></div><div class="emoji-block" title="six_pointed_star" data-emoji="six_pointed_star"></div><div class="emoji-block" title="negative_squared_cross_mark" data-emoji="negative_squared_cross_mark"></div><div class="emoji-block" title="a" data-emoji="a"></div><div class="emoji-block" title="b" data-emoji="b"></div><div class="emoji-block" title="ab" data-emoji="ab"></div><div class="emoji-block" title="o2" data-emoji="o2"></div><div class="emoji-block" title="diamond_shape_with_a_dot_inside" data-emoji="diamond_shape_with_a_dot_inside"></div><div class="emoji-block" title="recycle" data-emoji="recycle"></div><div class="emoji-block" title="end" data-emoji="end"></div><div class="emoji-block" title="back" data-emoji="back"></div><div class="emoji-block" title="on" data-emoji="on"></div><div class="emoji-block" title="soon" data-emoji="soon"></div><div class="emoji-block" title="clock1" data-emoji="clock1"></div><div class="emoji-block" title="clock130" data-emoji="clock130"></div><div class="emoji-block" title="clock10" data-emoji="clock10"></div><div class="emoji-block" title="clock1030" data-emoji="clock1030"></div><div class="emoji-block" title="clock11" data-emoji="clock11"></div><div class="emoji-block" title="clock1130" data-emoji="clock1130"></div><div class="emoji-block" title="clock12" data-emoji="clock12"></div></div><div class="emoji-row"><div class="emoji-block" title="clock1230" data-emoji="clock1230"></div><div class="emoji-block" title="clock2" data-emoji="clock2"></div><div class="emoji-block" title="clock230" data-emoji="clock230"></div><div class="emoji-block" title="clock3" data-emoji="clock3"></div><div class="emoji-block" title="clock330" data-emoji="clock330"></div><div class="emoji-block" title="clock4" data-emoji="clock4"></div><div class="emoji-block" title="clock430" data-emoji="clock430"></div><div class="emoji-block" title="clock5" data-emoji="clock5"></div><div class="emoji-block" title="clock530" data-emoji="clock530"></div><div class="emoji-block" title="clock6" data-emoji="clock6"></div><div class="emoji-block" title="clock630" data-emoji="clock630"></div><div class="emoji-block" title="clock7" data-emoji="clock7"></div><div class="emoji-block" title="clock730" data-emoji="clock730"></div><div class="emoji-block" title="clock8" data-emoji="clock8"></div><div class="emoji-block" title="clock830" data-emoji="clock830"></div><div class="emoji-block" title="clock9" data-emoji="clock9"></div><div class="emoji-block" title="clock930" data-emoji="clock930"></div><div class="emoji-block" title="heavy_dollar_sign" data-emoji="heavy_dollar_sign"></div><div class="emoji-block" title="copyright" data-emoji="copyright"></div><div class="emoji-block" title="registered" data-emoji="registered"></div></div><div class="emoji-row"><div class="emoji-block" title="tm" data-emoji="tm"></div><div class="emoji-block" title="x" data-emoji="x"></div><div class="emoji-block" title="heavy_exclamation_mark" data-emoji="heavy_exclamation_mark"></div><div class="emoji-block" title="bangbang" data-emoji="bangbang"></div><div class="emoji-block" title="interrobang" data-emoji="interrobang"></div><div class="emoji-block" title="o" data-emoji="o"></div><div class="emoji-block" title="heavy_multiplication_x" data-emoji="heavy_multiplication_x"></div><div class="emoji-block" title="heavy_plus_sign" data-emoji="heavy_plus_sign"></div><div class="emoji-block" title="heavy_minus_sign" data-emoji="heavy_minus_sign"></div><div class="emoji-block" title="heavy_division_sign" data-emoji="heavy_division_sign"></div><div class="emoji-block" title="white_flower" data-emoji="white_flower"></div><div class="emoji-block" title="100" data-emoji="100"></div><div class="emoji-block" title="heavy_check_mark" data-emoji="heavy_check_mark"></div><div class="emoji-block" title="ballot_box_with_check" data-emoji="ballot_box_with_check"></div><div class="emoji-block" title="radio_button" data-emoji="radio_button"></div><div class="emoji-block" title="link" data-emoji="link"></div><div class="emoji-block" title="curly_loop" data-emoji="curly_loop"></div><div class="emoji-block" title="wavy_dash" data-emoji="wavy_dash"></div><div class="emoji-block" title="part_alternation_mark" data-emoji="part_alternation_mark"></div><div class="emoji-block" title="trident" data-emoji="trident"></div></div><div class="emoji-row"><div class="emoji-block" title="black_small_square" data-emoji="black_small_square"></div><div class="emoji-block" title="white_small_square" data-emoji="white_small_square"></div><div class="emoji-block" title="black_medium_small_square" data-emoji="black_medium_small_square"></div><div class="emoji-block" title="white_medium_small_square" data-emoji="white_medium_small_square"></div><div class="emoji-block" title="black_medium_square" data-emoji="black_medium_square"></div><div class="emoji-block" title="white_medium_square" data-emoji="white_medium_square"></div><div class="emoji-block" title="black_large_square" data-emoji="black_large_square"></div><div class="emoji-block" title="white_large_square" data-emoji="white_large_square"></div><div class="emoji-block" title="white_check_mark" data-emoji="white_check_mark"></div><div class="emoji-block" title="black_square_button" data-emoji="black_square_button"></div><div class="emoji-block" title="white_square_button" data-emoji="white_square_button"></div><div class="emoji-block" title="black_circle" data-emoji="black_circle"></div><div class="emoji-block" title="white_circle" data-emoji="white_circle"></div><div class="emoji-block" title="red_circle" data-emoji="red_circle"></div><div class="emoji-block" title="large_blue_circle" data-emoji="large_blue_circle"></div><div class="emoji-block" title="large_blue_diamond" data-emoji="large_blue_diamond"></div><div class="emoji-block" title="large_orange_diamond" data-emoji="large_orange_diamond"></div><div class="emoji-block" title="small_blue_diamond" data-emoji="small_blue_diamond"></div><div class="emoji-block" title="small_orange_diamond" data-emoji="small_orange_diamond"></div><div class="emoji-block" title="small_red_triangle" data-emoji="small_red_triangle"></div></div><div class="emoji-row"><div class="emoji-block" title="small_red_triangle_down" data-emoji="small_red_triangle_down"></div><div class="emoji-block" title="shipit" data-emoji="shipit"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div><div class="emoji-block" style="display: none;"></div></div></div></div>
                            </div>
                        </div>
                    </a>
                    <a href="javascript:page.insert_projects_c();" class="blog_soft">
                        <i class="icon-svg icon-project-hollow-gray"></i>
                    </a>
                    <span class="NoData" id="ficmp_msg" style="color:#F00"></span>
              </div>
          </div>
        </form>
    </div>
</div>                                                    </div>
                        <div class="panel-list" id="BlogComments">
                                                            
                    <div class="comment-item comment-emoji" id="cmt_361751_129590_283963790">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/chenleijava" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/129590_50.jpg" align="absmiddle" alt="石头哥哥" title="石头哥哥" class="SmallPortrait" user="129590"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/chenleijava" target="_blank" name="rpl_283963790" class="user">石头哥哥</a></div>
                            <div class="user-info"><span>1</span>楼 2014/12/29 10:09</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        漂亮  顶一个<img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/13.gif" alt="13">
                    </div>
                    <div id="inline_reply_of_361751_129590_283963790" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_269836_283963831">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/997155658" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/269836_50.png" align="absmiddle" alt="chapin" title="chapin" class="SmallPortrait" user="269836"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/997155658" target="_blank" name="rpl_283963831" class="user">chapin</a></div>
                            <div class="user-info"><span>2</span>楼 2014/12/29 10:12</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        +1，很有帮助 
                    </div>
                    <div id="inline_reply_of_361751_269836_283963831" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_2007826_283964025">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/crazyharry" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/2007826_50.JPG" align="absmiddle" alt="CrazyHarry" title="CrazyHarry" class="SmallPortrait" user="2007826"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/crazyharry" target="_blank" name="rpl_283964025" class="user">CrazyHarry</a></div>
                            <div class="user-info"><span>3</span>楼 2014/12/29 10:28</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        大赞
                    </div>
                    <div id="inline_reply_of_361751_2007826_283964025" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_251904_283966312">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/liubingsmile" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/251904_50.jpg" align="absmiddle" alt="liubingsmile" title="liubingsmile" class="SmallPortrait" user="251904"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/liubingsmile" target="_blank" name="rpl_283966312" class="user">liubingsmile</a></div>
                            <div class="user-info"><span>4</span>楼 2014/12/29 13:39</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        漂亮，赞一个！简单经典！
                    </div>
                    <div id="inline_reply_of_361751_251904_283966312" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_1456257_283966895">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/u/1456257" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/1456257_50.jpg" align="absmiddle" alt="jkguowen" title="jkguowen" class="SmallPortrait" user="1456257"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/u/1456257" target="_blank" name="rpl_283966895" class="user">jkguowen</a></div>
                            <div class="user-info"><span>5</span>楼 2014/12/29 14:27</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        很好很强大，进来学习、膜拜一下！！<img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/13.gif" alt="13"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/13.gif" alt="13">
                    </div>
                    <div id="inline_reply_of_361751_1456257_283966895" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_781569_283966903">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/lylvgg" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/781569_50.png" align="absmiddle" alt="lylvgg" title="lylvgg" class="SmallPortrait" user="781569"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/lylvgg" target="_blank" name="rpl_283966903" class="user">lylvgg</a></div>
                            <div class="user-info"><span>6</span>楼 2014/12/29 14:28</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        mark!
                    </div>
                    <div id="inline_reply_of_361751_781569_283966903" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_347227_283969687">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/u/347227" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/347227_50.jpg" align="absmiddle" alt="wangyunzhong" title="wangyunzhong" class="SmallPortrait" user="347227"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/u/347227" target="_blank" name="rpl_283969687" class="user">wangyunzhong</a></div>
                            <div class="user-info"><span>7</span>楼 2014/12/29 18:20</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        dubbo
                    </div>
                    <div id="inline_reply_of_361751_347227_283969687" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_134984_283970706">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/dargoner" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/134984_50.jpg" align="absmiddle" alt="dargoner" title="dargoner" class="SmallPortrait" user="134984"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/dargoner" target="_blank" name="rpl_283970706" class="user">dargoner</a></div>
                            <div class="user-info"><span>8</span>楼 2014/12/29 19:45</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        太强了，dubbo细节版
                    </div>
                    <div id="inline_reply_of_361751_134984_283970706" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_1011594_283970923">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/orac" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/1011594_50.jpg" align="absmiddle" alt="anduo" title="anduo" class="SmallPortrait" user="1011594"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/orac" target="_blank" name="rpl_283970923" class="user">anduo</a></div>
                            <div class="user-info"><span>9</span>楼 2014/12/29 20:03</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        漂亮 
                    </div>
                    <div id="inline_reply_of_361751_1011594_283970923" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_1866528_283971069">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/testarossa" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/1866528_50.jpg" align="absmiddle" alt="fate-testarossa" title="fate-testarossa" class="SmallPortrait" user="1866528"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/testarossa" target="_blank" name="rpl_283971069" class="user">fate-testarossa</a></div>
                            <div class="user-info"><span>10</span>楼 2014/12/29 20:15</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        mark
                    </div>
                    <div id="inline_reply_of_361751_1866528_283971069" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_1032811_283972776">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/u/1032811" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/1032811_50.jpg" align="absmiddle" alt="hg_tyf2013" title="hg_tyf2013" class="SmallPortrait" user="1032811"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/u/1032811" target="_blank" name="rpl_283972776" class="user">hg_tyf2013</a></div>
                            <div class="user-info"><span>11</span>楼 2014/12/29 22:38</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        涨姿势了。膜拜。
                    </div>
                    <div id="inline_reply_of_361751_1032811_283972776" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_150771_283979322">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/lgscofield" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/150771_50.jpg" align="absmiddle" alt="lgscofield" title="lgscofield" class="SmallPortrait" user="150771"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/lgscofield" target="_blank" name="rpl_283979322" class="user">lgscofield</a></div>
                            <div class="user-info"><span>12</span>楼 2014/12/30 07:43</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        服务化和RPC有啥区别啊 
                    </div>
                    <div id="inline_reply_of_361751_150771_283979322" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_1578926_283981276">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/u/1578926" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/1578926_50.gif" align="absmiddle" alt="ad5248" title="ad5248" class="SmallPortrait" user="1578926"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/u/1578926" target="_blank" name="rpl_283981276" class="user">ad5248</a></div>
                            <div class="user-info"><span>13</span>楼 2014/12/30 10:26</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        没有看懂zookeeper在当中起什么作用 ，求解答
                    </div>
                    <div id="inline_reply_of_361751_1578926_283981276" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_1469576_283985763">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/xinxingegeya" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/1469576_50.jpg" align="absmiddle" alt="xxggy" title="xxggy" class="SmallPortrait" user="1469576"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/xinxingegeya" target="_blank" name="rpl_283985763" class="user">xxggy</a></div>
                            <div class="user-info"><span>14</span>楼 2014/12/30 16:40</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        netty的异步 如何体现呢？
                    </div>
                    <div id="inline_reply_of_361751_1469576_283985763" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_223750_283986634">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/huangyong" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/223750_50.jpg" align="absmiddle" alt="黄勇" title="黄勇" class="SmallPortrait" user="223750"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/huangyong" target="_blank" name="rpl_283986634" class="user">黄勇</a></div>
                            <div class="user-info"><span>15</span>楼 2014/12/30 17:52</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        <div class="ref"><h4>引用来自“lgscofield”的评论</h4>服务化和RPC有啥区别啊 </div>服务化是将业务封装成服务组件对外提供服务接口或称为 API，而 RPC 用于解决分布式环境下服务组件之间的通信问题。
                    </div>
                    <div id="inline_reply_of_361751_223750_283986634" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_223750_283986648">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/huangyong" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/223750_50.jpg" align="absmiddle" alt="黄勇" title="黄勇" class="SmallPortrait" user="223750"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/huangyong" target="_blank" name="rpl_283986648" class="user">黄勇</a></div>
                            <div class="user-info"><span>16</span>楼 2014/12/30 17:54</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        <div class="ref"><h4>引用来自“ad5248”的评论</h4>没有看懂zookeeper在当中起什么作用 ，求解答</div>ZK 在该架构中扮演了“服务注册表”的角色，用于注册所有服务器的地址与端口，并对客户端提供服务发现的功能。
                    </div>
                    <div id="inline_reply_of_361751_223750_283986648" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_223750_283986692">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/huangyong" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/223750_50.jpg" align="absmiddle" alt="黄勇" title="黄勇" class="SmallPortrait" user="223750"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/huangyong" target="_blank" name="rpl_283986692" class="user">黄勇</a></div>
                            <div class="user-info"><span>17</span>楼 2014/12/30 17:57</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        <div class="ref"><h4>引用来自“鑫鑫哥哥呀”的评论</h4>netty的异步 如何体现呢？</div>Netty 对 NIO 提供了一个良好的封装，让开发者更加方便地编写 NIO 程序，而无需接触底层的 NIO API。所以异步是指确保读取或写入进程不会造成 IO 阻塞，说白了就是可以让后面的进程继续工作，这样一来也就提高了整个系统的吞吐率。
                    </div>
                    <div id="inline_reply_of_361751_223750_283986692" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_1469576_283988083">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/xinxingegeya" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/1469576_50.jpg" align="absmiddle" alt="xxggy" title="xxggy" class="SmallPortrait" user="1469576"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/xinxingegeya" target="_blank" name="rpl_283988083" class="user">xxggy</a></div>
                            <div class="user-info"><span>18</span>楼 2014/12/30 19:53</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        Opening socket connection to server 127.0.0.1/127.0.0.1:8989. Will not attempt to authenticate using SASL (unknown error)<br>Session 0x0 for server null, unexpected error, closing socket connection and attempting reconnect<br>java.net.ConnectException: Connection refused: no further information<br>&nbsp;&nbsp;at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)<br>&nbsp;&nbsp;at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)<br>&nbsp;&nbsp;at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:361)<br>&nbsp;&nbsp;at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1081)<br>Ignoring exception during shutdown input<br>java.nio.channels.ClosedChannelException<br>&nbsp;&nbsp;at sun.nio.ch.SocketChannelImpl.shutdownInput(SocketChannelImpl.java:779)<br>&nbsp;&nbsp;at sun.nio.ch.SocketAdaptor.shutdownInput(SocketAdaptor.java:402)<br>&nbsp;&nbsp;at org.apache.zookeeper.ClientCnxnSocketNIO.cleanup(ClientCnxnSocketNIO.java:200)<br>&nbsp;&nbsp;at org.apache.zookeeper.ClientCnxn$SendThread.cleanup(ClientCnxn.java:1185)<br>&nbsp;&nbsp;at org.apache.zookeeper.Clien
                    </div>
                    <div id="inline_reply_of_361751_1469576_283988083" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_1469576_283988092">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/xinxingegeya" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/1469576_50.jpg" align="absmiddle" alt="xxggy" title="xxggy" class="SmallPortrait" user="1469576"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/xinxingegeya" target="_blank" name="rpl_283988092" class="user">xxggy</a></div>
                            <div class="user-info"><span>19</span>楼 2014/12/30 19:54</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        测试了一下，一直重复上边这个错误，不知道什么原因，还是哪里我没有配置正确？
                    </div>
                    <div id="inline_reply_of_361751_1469576_283988092" class="inline_reply"></div>
                </div>
            </div>
        </div>
                            <div class="comment-item comment-emoji" id="cmt_361751_223750_283991872">
            <div class="layout">
                <div class="layout-left">
                    <!-- 头像 -->
                    <div class="icon">
                        <a href="https://my.oschina.net/huangyong" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/223750_50.jpg" align="absmiddle" alt="黄勇" title="黄勇" class="SmallPortrait" user="223750"></a>
                    </div>
                </div>
                <div class="layout-column right">
                    <div class="layout">
                                                <div class="layout-column">
                            <div class="user-name"><a href="https://my.oschina.net/huangyong" target="_blank" name="rpl_283991872" class="user">黄勇</a></div>
                            <div class="user-info"><span>20</span>楼 2014/12/31 01:09</div>
                        </div>
                    </div>

                    <!-- 评论内容 -->
                    <div class="comment-content" data-emoji-render="true" style="opacity: 1;">
                        <div class="ref"><h4>引用来自“鑫鑫哥哥呀”的评论</h4>测试了一下，一直重复上边这个错误，不知道什么原因，还是哪里我没有配置正确？</div>请问 8989 是哪个的端口？运行过程是：先开启 ZooKeeper，然后运行 RpcBootstrap，最后运行 HelloServiceTest，一定是可以的，祝你好运！
                    </div>
                    <div id="inline_reply_of_361751_223750_283991872" class="inline_reply"></div>
                </div>
            </div>
        </div>
            <div class="pages sm-hide">
                                                                                    <ul>
                        <li class="active"><a href="https://my.oschina.net/huangyong/blog/361751?p=1">1</a></li>            <li><a href="https://my.oschina.net/huangyong/blog/361751?p=2">2</a></li>            <li><a href="https://my.oschina.net/huangyong/blog/361751?p=3">3</a></li>            <li><a href="https://my.oschina.net/huangyong/blog/361751?p=4">4</a></li>            <li><a href="https://my.oschina.net/huangyong/blog/361751?p=5">5</a></li>            <li><a href="https://my.oschina.net/huangyong/blog/361751?p=6">6</a></li>            <li><a href="https://my.oschina.net/huangyong/blog/361751?p=7">7</a></li>            <li><a href="https://my.oschina.net/huangyong/blog/361751?p=2">下一页</a></li>        </ul>
            </div>                                                    </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 微信分享二维码 -->
       <!--  <div class="float-share md-hide">
            <div class="weixin-share" id="weixin-share">
            </div>
            <span>微信分享</span>
        </div> -->

        <!-- 右侧工具条 -->
        <div class="tool-bar blog-tool-bar md-hide">
            <div class="item tool-top" style="display: block;">
                <a href="javascript:void(0)" class="over">
                    <div class="icon">
                        <i class="icon-svg icon-go-top"></i>
                    </div>
                    <div class="txt">顶部</div>
                </a>
            </div>
        </div>
    </div>
</div>
<div class="reward-popups" data-popups-for="reward">
    <span data-popups-close="true">×</span>
    <div data-popups="body">
        <form action="https://my.oschina.net/huangyong/blog/361751" method="post" id="blog_donate_form">
            <div class="form-wapper">
                <div class="blogger-info text-center">
                    <span class="icon">
                        <a href="https://my.oschina.net/huangyong/home" class="article_editor_head_img" target="_blank"><img src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/223750_100.jpg" align="absmiddle" alt="黄勇" title="黄勇" class="LargePortrait"></a>
                    </span>
                    <div class="text">
                        如果觉得我的文章对您有用，请随意打赏。您的支持将鼓励我继续创作！
                    </div>
                </div>
                <div class="form-item">
                    <div class="form-label">
                        <span class="font-red">*</span>
                        金额(元)
                    </div>
                    <div class="form-ctrl">
                        <div>
                            <input name="payMoney" value="2" type="text" placeholder="请输入金额￥">
                            <input name="money" value="2" type="hidden" placeholder="请输入金额￥">
                        </div>
                        <div class="reward-money-box">
                            <span data-value="1" class="reward-money">￥1</span>
                            <span data-value="5" class="reward-money">￥5</span>
                            <span data-value="10" class="reward-money">￥10</span>
                            <span data-value="20" class="reward-money">￥20</span>
                            <span data-value="" class="reward-money other-money active">其他金额</span>
                        </div>
                    </div>
                </div>
                <div class="form-item">
                    <div class="form-label">
                        打赏人
                    </div>
                    <div class="form-ctrl">
                        <input type="text" name="donaterName" maxlength="100" value="" placeholder="请输入姓名/昵称/邮箱">
                    </div>
                </div>
                <div class="form-item items-center">
                    <div class="form-label">
                        留言
                    </div>
                    <div class="form-ctrl">
                        <textarea maxlength="100" name="message" id="" cols="30" rows="3" placeholder="你想对TA说"></textarea>
                    </div>
                </div>

                <div class="form-item items-center">
                    <div class="form-label">
                        <span class="font-red">*</span>
                        支付类型
                    </div>
                    <div class="form-ctrl">
                        <div class="reward-way form-radios reward-alipay">
                            <input type="radio" value="alipay" id="rewardAliPay" checked="checked" name="reward-way">
                            <label for="rewardAliPay">
                                <span class="hide">支付宝支付</span>
                            </label>
                        </div>
                        <div class="reward-way form-radios reward-wechat">
                            <input type="radio" value="wepay" id="rewardWechat" name="reward-way">
                            <label for="rewardWechat">
                                <i class="icon-svg icon-wechat"></i>
                                <span class="">微信支付</span>
                            </label>
                        </div>
                    </div>
                </div>
                                <div class="hide">
                    <input name="objType" type="hidden" value="16344358">
                    <input name="objId" type="hidden" value="361751">
                    <input name="donater" type="hidden" value="0">
                    <input name="subject" maxlength="50" type="hidden" value="轻量级分布式 RPC 框架">
                    <input name="author" type="hidden" value="223750">
                    <input name="returnUrl" maxlength="900" type="hidden" value="https://my.oschina.net/huangyong/blog/361751">
                    <input name="notifyUrl" maxlength="900" type="hidden" value="https://my.oschina.net/action/blog/paySuccess">
                    <input name="sign" type="hidden" value="">
                </div>
                <div class="form-button text-right">
                    <input type="button" class="btn btn-orange" value="打赏" id="blog_donate_button">
                </div>
            </div>

            <div class="reward-status reward-wechat-box text-center">
                <span class="wechat-qr">
                    <i class="icon-svg icon-scan-green"></i>
                    微信扫码支付
                </span>
                <div class="wepay-amount">
                    打赏金额: <span class="h1 font-green">￥<em id="wepayAmount"></em></span>
                </div>
                <span class="wechat-qr-img" id="result_area">
                </span>
            </div>

            <div class="reward-status reward-success text-center">
                <span class="wechat-qr">
                    <i class="icon-svg icon-wechat"></i>
                    已支付成功
                </span>
                <div>
                    打赏金额: <span class="h1 font-green">￥<em id="wepayAmount"></em></span>
                </div>
            </div>
        </form>
    </div>
</div>
<div data-popups="mask">

</div>
    <script type="text/javascript" src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/blog" defer="defer"></script>
    <script type="text/javascript" src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/space"></script>

<val data-name="radar_chart_js_url" data-value="/dist/www/vendor/radarChart/radarChart.js?t=1475077647000"></val>
<script>
    window.addEventListener("load", function() {
        var radarChartJsUrl = $("val[data-name=radar_chart_js_url]").data("value");
        if(radarChartJsUrl) {
            require.requireJS(radarChartJsUrl, function() {
                // 雷达图配置选项
                function getRadarOption(skills, values, maxLevel) {
                    var radarChartOptions = {},
                        skillArr = skills ? skills : [],
                        valuesArr = values ? values : [],
                        maxLevelArr = [];
                        valuesArr.forEach(function(element, index) {
                            maxLevelArr.push(maxLevel);
                        });

                    radarChartOptions.data = {
                        maxValue: maxLevelArr,
                        value: valuesArr,
                        description: skillArr
                    };
                    radarChartOptions.config = {
                        scale: 0.9,
                        dataFill: {
                            fillStyle: "rgba(24, 236, 111, .4)"
                        },
                        bg: {
                            layer: 4,
                            evenFillStyle: "#828282",
                            oddFillStyle: "#828282",
                            evenStrokeStyle: "#ccc",
                            oddStrokeStyle: "#ccc"
                        },
                        dataCircle: {
                            r: 1,
                            strokeStyle: "#18ec6f",
                            fillStyle: "#18ec6f",
                            lineWidth: 0.5
                        },
                        dataLine: {
                            strokeStyle: "#18ec6f",
                            lineWidth: 2
                        },
                        font: {
                            fontColor: "#eee"
                        }
                    };
                    return radarChartOptions;
                }
                var sendRequest = function () {
                    var user_id = $("val[data-name='owner_id']").attr("data-value");
                    $.ajax({
                        type: "POST",
                        url: "/action/radar/searchUserRadarMap",
                        data: {user_id: user_id},
                        dataType: "json",
                        success: function (msg) {
                            if (msg.result) {
                                // 显示雷达面板
                                $(".user-radar").show();
                                radarChart.init(document.querySelector("#radar-skill"), getRadarOption(msg.data.skills, msg.data.skillsLevel, msg.data.maxSkillLevel));
                                // 打开雷达详情页
                                var radarDetailLink = $('#radar-skill').data("detail");
                                if (radarDetailLink) {
                                    $('#radar-skill').on('click', function (params) {
                                        window.open(radarDetailLink);
                                    });
                                }
                            }
                        }
                    });
                }
                sendRequest();
            });
        }
    }, false);
</script>

            <script>
        window.addEventListener("load", function() {
            (function(){
                var bp = document.createElement('script');
                var curProtocol = window.location.protocol.split(':')[0];
                if (curProtocol === 'https') {
                    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                }
                else {
                    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                }
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(bp, s);
            })();
        });
    </script>
    <script type="text/javascript">
     (function (ww, dt) {
         ww.__gac = {
             domain: 'www.oschina.net'
         };
         if(!(/\/marketing\/ad-slice/.test(location.href))){
             var script = dt.createElement('script');
             script.setAttribute('type', 'text/javascript');
             script.setAttribute('src', '//www.oschina.net/public/javascripts/cjl/ga.js?t=20160926');
             dt.body.appendChild(script);
         }
     } (window, window.document));
 </script>
            </div><script type="text/javascript" src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/ga.js.下载"></script>
                        <script type="text/javascript" src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/common.min.js.下载"></script>
            <script type="text/javascript" src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/blog.min.js.下载"></script>
                <div class="footer">
    <div class="container">
        <div class="layout">
            <div class="layout-right">
                <div class="oscapp">
                    <span>开源中国手机客户端：</span>
                    <a href="https://www.oschina.net/app" class="android" title="Android客户端">Android</a>
                    <a href="https://www.oschina.net/app" class="iphone" title="iPhone 客户端">iPhone</a>
                    <a href="https://www.oschina.net/app" class="wp7" title="Windows Phone 客户端">WP7</a>
                </div>
            </div>
            <div class="layout-column">
                <div>
                    © 开源中国(OSChina.NET) | <a href="https://www.oschina.net/home/aboutosc">关于我们</a> | <a href="mailto:market@oschina.cn">广告联系</a> | <a href="http://weibo.com/oschina2010" target="_blank">@新浪微博</a> | <a href="https://m.oschina.net/">开源中国手机版</a> | <a href="http://www.miitbeian.gov.cn/" target="_blank" style="color:#737573;text-decoration:none;">粤ICP备12009483号-3</a></div>
                 <div>开源中国社区(OSChina.net)是工信部 <a href="http://www.copu.org.cn/" target="_blank">开源软件推进联盟</a> 指定的官方社区</div>
            </div>
        </div>
    </div>
</div>



    
<!-- Generated by OsChina.NET (init:1[ms],page:102[ms],ip:219.133.170.172) --><script type="text/javascript" src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/radarChart.js.下载"></script><script type="text/javascript" src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/highlight.js.下载"></script><script type="text/javascript" src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/highlight.js.下载"></script><script type="text/javascript" src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/jquery.atwho.js.下载"></script><script type="text/javascript" src="./轻量级分布式 RPC 框架 - 黄勇 - 开源中国社区_files/emoji_github.js.下载"></script><div id="at-view" class="at-view"><ul id="at-view-ul"></ul></div></body></html>